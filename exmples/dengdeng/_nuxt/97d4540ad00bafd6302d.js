/*! For license information please see LICENSES */
(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{651:function(e,t,n){var r;window,r=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(object,e){return Object.prototype.hasOwnProperty.call(object,e)},n.p="",n(n.s="./src/wavesurfer.js")}({"./node_modules/debounce/index.js":function(e,t){function n(e,t,n){var r,o,l,c,f;function _(){var h=Date.now()-c;h<t&&h>=0?r=setTimeout(_,t-h):(r=null,n||(f=e.apply(l,o),l=o=null))}null==t&&(t=100);var h=function(){l=this,o=arguments,c=Date.now();var h=n&&!r;return r||(r=setTimeout(_,t)),h&&(f=e.apply(l,o),l=o=null),f};return h.clear=function(){r&&(clearTimeout(r),r=null)},h.flush=function(){r&&(f=e.apply(l,o),l=o=null,clearTimeout(r),r=null)},h}n.debounce=n,e.exports=n},"./src/drawer.canvasentry.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(n("./src/util/style.js")),o=l(n("./src/util/get-id.js"));function l(e){return e&&e.__esModule?e:{default:e}}function c(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var f=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wave=null,this.waveCtx=null,this.progress=null,this.progressCtx=null,this.start=0,this.end=1,this.id=(0,o.default)(this.constructor.name.toLowerCase()+"_")}var t,n,l;return t=e,(n=[{key:"initWave",value:function(element){this.wave=element,this.waveCtx=this.wave.getContext("2d")}},{key:"initProgress",value:function(element){this.progress=element,this.progressCtx=this.progress.getContext("2d")}},{key:"updateDimensions",value:function(e,t,n,o){this.start=this.wave.offsetLeft/t||0,this.end=this.start+e/t,this.wave.width=n,this.wave.height=o;var l={width:e+"px"};(0,r.default)(this.wave,l),this.hasProgressCanvas&&(this.progress.width=n,this.progress.height=o,(0,r.default)(this.progress,l))}},{key:"clearWave",value:function(){this.waveCtx.clearRect(0,0,this.waveCtx.canvas.width,this.waveCtx.canvas.height),this.hasProgressCanvas&&this.progressCtx.clearRect(0,0,this.progressCtx.canvas.width,this.progressCtx.canvas.height)}},{key:"setFillStyles",value:function(e,t){this.waveCtx.fillStyle=e,this.hasProgressCanvas&&(this.progressCtx.fillStyle=t)}},{key:"fillRects",value:function(e,t,n,r,o){this.fillRectToContext(this.waveCtx,e,t,n,r,o),this.hasProgressCanvas&&this.fillRectToContext(this.progressCtx,e,t,n,r,o)}},{key:"fillRectToContext",value:function(e,t,n,r,o,l){e&&(l?this.drawRoundedRect(e,t,n,r,o,l):e.fillRect(t,n,r,o))}},{key:"drawRoundedRect",value:function(e,t,n,r,o,l){0!==o&&(o<0&&(n-=o*=-1),e.beginPath(),e.moveTo(t+l,n),e.lineTo(t+r-l,n),e.quadraticCurveTo(t+r,n,t+r,n+l),e.lineTo(t+r,n+o-l),e.quadraticCurveTo(t+r,n+o,t+r-l,n+o),e.lineTo(t+l,n+o),e.quadraticCurveTo(t,n+o,t,n+o-l),e.lineTo(t,n+l),e.quadraticCurveTo(t,n,t+l,n),e.closePath(),e.fill())}},{key:"drawLines",value:function(e,t,n,r,o,l){this.drawLineToContext(this.waveCtx,e,t,n,r,o,l),this.hasProgressCanvas&&this.drawLineToContext(this.progressCtx,e,t,n,r,o,l)}},{key:"drawLineToContext",value:function(e,t,n,r,o,l,c){if(e){var i,f,_,h=t.length/2,d=Math.round(h*this.start),m=d,v=Math.round(h*this.end)+1,y=this.wave.width/(v-m-1),w=r+o,k=n/r;for(e.beginPath(),e.moveTo((m-d)*y,w),e.lineTo((m-d)*y,w-Math.round((t[2*m]||0)/k)),i=m;i<v;i++)f=t[2*i]||0,_=Math.round(f/k),e.lineTo((i-d)*y+this.halfPixel,w-_);for(var S=v-1;S>=m;S--)f=t[2*S+1]||0,_=Math.round(f/k),e.lineTo((S-d)*y+this.halfPixel,w-_);e.lineTo((m-d)*y,w-Math.round((t[2*m+1]||0)/k)),e.closePath(),e.fill()}}},{key:"destroy",value:function(){this.waveCtx=null,this.wave=null,this.progressCtx=null,this.progress=null}},{key:"getImage",value:function(e,t,n){var r=this;return"blob"===n?new Promise((function(n){r.wave.toBlob(n,e,t)})):"dataURL"===n?this.wave.toDataURL(e,t):void 0}}])&&c(t.prototype,n),l&&c(t,l),e}();t.default=f,e.exports=t.default},"./src/drawer.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if(e&&e.__esModule)return e;var t=o();if(t&&t.has(e))return t.get(e);var n={};if(null!=e){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if(Object.prototype.hasOwnProperty.call(e,l)){var desc=r?Object.getOwnPropertyDescriptor(e,l):null;desc&&(desc.get||desc.set)?Object.defineProperty(n,l,desc):n[l]=e[l]}}return n.default=e,t&&t.set(e,n),n}(n("./src/util/index.js"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,p){return(h=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}var d=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=f(this,_(t).call(this))).container=e,r.params=n,r.width=0,r.height=n.height*r.params.pixelRatio,r.lastPos=0,r.wrapper=null,r}var n,o,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,e),n=t,(o=[{key:"style",value:function(e,t){return r.style(e,t)}},{key:"createWrapper",value:function(){this.wrapper=this.container.appendChild(document.createElement("wave")),this.style(this.wrapper,{display:"block",position:"relative",userSelect:"none",webkitUserSelect:"none",height:this.params.height+"px"}),(this.params.fillParent||this.params.scrollParent)&&this.style(this.wrapper,{width:"100%",overflowX:this.params.hideScrollbar?"hidden":"auto",overflowY:"hidden"}),this.setupWrapperEvents()}},{key:"handleEvent",value:function(e,t){!t&&e.preventDefault();var progress,n=e.targetTouches?e.targetTouches[0].clientX:e.clientX,r=this.wrapper.getBoundingClientRect(),o=this.width,l=this.getWidth();return!this.params.fillParent&&o<l?(progress=(this.params.rtl?r.right-n:n-r.left)*(this.params.pixelRatio/o)||0)>1&&(progress=1):progress=((this.params.rtl?r.right-n:n-r.left)+this.wrapper.scrollLeft)/this.wrapper.scrollWidth||0,progress}},{key:"setupWrapperEvents",value:function(){var e=this;this.wrapper.addEventListener("click",(function(t){var n=e.wrapper.offsetHeight-e.wrapper.clientHeight;if(0!==n){var r=e.wrapper.getBoundingClientRect();if(t.clientY>=r.bottom-n)return}e.params.interact&&e.fireEvent("click",t,e.handleEvent(t))})),this.wrapper.addEventListener("dblclick",(function(t){e.params.interact&&e.fireEvent("dblclick",t)})),this.wrapper.addEventListener("scroll",(function(t){return e.fireEvent("scroll",t)}))}},{key:"drawPeaks",value:function(e,t,n,r){this.setWidth(t)||this.clearWave(),this.params.barWidth?this.drawBars(e,0,n,r):this.drawWave(e,0,n,r)}},{key:"resetScroll",value:function(){null!==this.wrapper&&(this.wrapper.scrollLeft=0)}},{key:"recenter",value:function(e){var t=this.wrapper.scrollWidth*e;this.recenterOnPosition(t,!0)}},{key:"recenterOnPosition",value:function(e,t){var n=this.wrapper.scrollLeft,r=~~(this.wrapper.clientWidth/2),o=this.wrapper.scrollWidth-this.wrapper.clientWidth,l=e-r,c=l-n;if(0!=o){if(!t&&-r<=c&&c<r){var f=this.params.autoCenterRate;f/=r,f*=o,l=n+(c=Math.max(-f,Math.min(f,c)))}(l=Math.max(0,Math.min(o,l)))!=n&&(this.wrapper.scrollLeft=l)}}},{key:"getScrollX",value:function(){var e=0;if(this.wrapper){var t=this.params.pixelRatio;if(e=Math.round(this.wrapper.scrollLeft*t),this.params.scrollParent){var n=~~(this.wrapper.scrollWidth*t-this.getWidth());e=Math.min(n,Math.max(0,e))}}return e}},{key:"getWidth",value:function(){return Math.round(this.container.clientWidth*this.params.pixelRatio)}},{key:"setWidth",value:function(e){return this.width!=e&&(this.width=e,this.params.fillParent||this.params.scrollParent?this.style(this.wrapper,{width:""}):this.style(this.wrapper,{width:~~(this.width/this.params.pixelRatio)+"px"}),this.updateSize(),!0)}},{key:"setHeight",value:function(e){return e!=this.height&&(this.height=e,this.style(this.wrapper,{height:~~(this.height/this.params.pixelRatio)+"px"}),this.updateSize(),!0)}},{key:"progress",value:function(e){var t=1/this.params.pixelRatio,n=Math.round(e*this.width)*t;if(n<this.lastPos||n-this.lastPos>=t){if(this.lastPos=n,this.params.scrollParent&&this.params.autoCenter){var r=~~(this.wrapper.scrollWidth*e);this.recenterOnPosition(r,this.params.autoCenterImmediately)}this.updateProgress(n)}}},{key:"destroy",value:function(){this.unAll(),this.wrapper&&(this.wrapper.parentNode==this.container&&this.container.removeChild(this.wrapper),this.wrapper=null)}},{key:"updateCursor",value:function(){}},{key:"updateSize",value:function(){}},{key:"drawBars",value:function(e,t,n,r){}},{key:"drawWave",value:function(e,t,n,r){}},{key:"clearWave",value:function(){}},{key:"updateProgress",value:function(e){}}])&&c(n.prototype,o),l&&c(n,l),t}(r.Observer);t.default=d,e.exports=t.default},"./src/drawer.multicanvas.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=f(n("./src/drawer.js")),o=function(e){if(e&&e.__esModule)return e;var t=c();if(t&&t.has(e))return t.get(e);var n={};if(null!=e){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var desc=r?Object.getOwnPropertyDescriptor(e,o):null;desc&&(desc.get||desc.set)?Object.defineProperty(n,o,desc):n[o]=e[o]}}return n.default=e,t&&t.set(e,n),n}(n("./src/util/index.js")),l=f(n("./src/drawer.canvasentry.js"));function c(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}function f(e){return e&&e.__esModule?e:{default:e}}function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(e,t){return!t||"object"!==_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,p){return(v=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}var y=function(e){function t(e,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=d(this,m(t).call(this,e,n))).maxCanvasWidth=n.maxCanvasWidth,r.maxCanvasElementWidth=Math.round(n.maxCanvasWidth/n.pixelRatio),r.hasProgressCanvas=n.waveColor!=n.progressColor,r.halfPixel=.5/n.pixelRatio,r.canvases=[],r.progressWave=null,r.EntryClass=l.default,r.overlap=2*Math.ceil(n.pixelRatio/2),r.barRadius=n.barRadius||0,r}var n,r,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(t,e),n=t,(r=[{key:"init",value:function(){this.createWrapper(),this.createElements()}},{key:"createElements",value:function(){this.progressWave=this.wrapper.appendChild(this.style(document.createElement("wave"),{position:"absolute",zIndex:3,left:0,top:0,bottom:0,overflow:"hidden",width:"0",display:"none",boxSizing:"border-box",borderRightStyle:"solid",pointerEvents:"none"})),this.addCanvas(),this.updateCursor()}},{key:"updateCursor",value:function(){this.style(this.progressWave,{borderRightWidth:this.params.cursorWidth+"px",borderRightColor:this.params.cursorColor})}},{key:"updateSize",value:function(){for(var e=this,t=Math.round(this.width/this.params.pixelRatio),n=Math.ceil(t/(this.maxCanvasElementWidth+this.overlap));this.canvases.length<n;)this.addCanvas();for(;this.canvases.length>n;)this.removeCanvas();var r=this.maxCanvasWidth+this.overlap,o=this.canvases.length-1;this.canvases.forEach((function(t,i){i==o&&(r=e.width-e.maxCanvasWidth*o),e.updateDimensions(t,r,e.height),t.clearWave()}))}},{key:"addCanvas",value:function(){var e=new this.EntryClass;e.hasProgressCanvas=this.hasProgressCanvas,e.halfPixel=this.halfPixel;var t=this.maxCanvasElementWidth*this.canvases.length;e.initWave(this.wrapper.appendChild(this.style(document.createElement("canvas"),{position:"absolute",zIndex:2,left:t+"px",top:0,bottom:0,height:"100%",pointerEvents:"none"}))),this.hasProgressCanvas&&e.initProgress(this.progressWave.appendChild(this.style(document.createElement("canvas"),{position:"absolute",left:t+"px",top:0,bottom:0,height:"100%"}))),this.canvases.push(e)}},{key:"removeCanvas",value:function(){var e=this.canvases[this.canvases.length-1];e.wave.parentElement.removeChild(e.wave),this.hasProgressCanvas&&e.progress.parentElement.removeChild(e.progress),e&&(e.destroy(),e=null),this.canvases.pop()}},{key:"updateDimensions",value:function(e,t,n){var r=Math.round(t/this.params.pixelRatio),o=Math.round(this.width/this.params.pixelRatio);e.updateDimensions(r,o,t,n),this.style(this.progressWave,{display:"block"})}},{key:"clearWave",value:function(){this.canvases.forEach((function(e){return e.clearWave()}))}},{key:"drawBars",value:function(e,t,n,r){var o=this;return this.prepareDraw(e,t,n,r,(function(e){var t=e.absmax,l=e.hasMinVals,c=(e.height,e.offsetY),f=e.halfH,_=e.peaks;if(void 0!==n)for(var h=l?2:1,d=_.length/h,m=o.params.barWidth*o.params.pixelRatio,v=m+(null===o.params.barGap?Math.max(o.params.pixelRatio,~~(m/2)):Math.max(o.params.pixelRatio,o.params.barGap*o.params.pixelRatio)),y=d/o.width,w=r,i=n;i<w;i+=v){var k=_[Math.floor(i*y*h)]||0,S=Math.round(k/t*f);o.fillRect(i+o.halfPixel,f-S+c,m+o.halfPixel,2*S,o.barRadius)}}))}},{key:"drawWave",value:function(e,t,n,r){var o=this;return this.prepareDraw(e,t,n,r,(function(e){var t=e.absmax,l=e.hasMinVals,c=(e.height,e.offsetY),f=e.halfH,_=e.peaks;if(!l){for(var h=[],d=_.length,i=0;i<d;i++)h[2*i]=_[i],h[2*i+1]=-_[i];_=h}void 0!==n&&o.drawLine(_,t,f,c,n,r),o.fillRect(0,f+c-o.halfPixel,o.width,o.halfPixel,o.barRadius)}))}},{key:"drawLine",value:function(e,t,n,r,o,l){var c=this;this.canvases.forEach((function(f){c.setFillStyles(f),f.drawLines(e,t,n,r,o,l)}))}},{key:"fillRect",value:function(e,t,n,r,o){for(var l=Math.floor(e/this.maxCanvasWidth),c=Math.min(Math.ceil((e+n)/this.maxCanvasWidth)+1,this.canvases.length),i=l;i<c;i++){var f=this.canvases[i],_=i*this.maxCanvasWidth,h={x1:Math.max(e,i*this.maxCanvasWidth),y1:t,x2:Math.min(e+n,i*this.maxCanvasWidth+f.wave.width),y2:t+r};h.x1<h.x2&&(this.setFillStyles(f),f.fillRects(h.x1-_,h.y1,h.x2-h.x1,h.y2-h.y1,o))}}},{key:"prepareDraw",value:function(e,t,n,r,l){var c=this;return o.frame((function(){if(e[0]instanceof Array){var f=e;if(c.params.splitChannels)return c.setHeight(f.length*c.params.height*c.params.pixelRatio),f.forEach((function(e,i){return c.prepareDraw(e,i,n,r,l)}));e=f[0]}var _=1/c.params.barHeight;if(c.params.normalize){var h=o.max(e),d=o.min(e);_=-d>h?-d:h}var m=[].some.call(e,(function(e){return e<0})),v=c.params.height*c.params.pixelRatio;return l({absmax:_,hasMinVals:m,height:v,offsetY:v*t||0,halfH:v/2,peaks:e})}))()}},{key:"setFillStyles",value:function(e){e.setFillStyles(this.params.waveColor,this.params.progressColor)}},{key:"getImage",value:function(e,t,n){if("blob"===n)return Promise.all(this.canvases.map((function(r){return r.getImage(e,t,n)})));if("dataURL"===n){var r=this.canvases.map((function(r){return r.getImage(e,t,n)}));return r.length>1?r:r[0]}}},{key:"updateProgress",value:function(e){this.style(this.progressWave,{width:e+"px"})}}])&&h(n.prototype,r),c&&h(n,c),t}(r.default);t.default=y,e.exports=t.default},"./src/mediaelement-webaudio.js":function(e,t,n){"use strict";var r;function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e,t,n){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=_(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,p){return(h=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var d=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=c(this,_(t).call(this,e))).params=e,n.sourceMediaElement=null,n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,e),n=t,(r=[{key:"init",value:function(){this.setPlaybackRate(this.params.audioRate),this.createTimer(),this.createVolumeNode(),this.createScriptNode(),this.createAnalyserNode()}},{key:"_load",value:function(e,n){f(_(t.prototype),"_load",this).call(this,e,n),this.createMediaElementSource(e)}},{key:"createMediaElementSource",value:function(e){this.sourceMediaElement=this.ac.createMediaElementSource(e),this.sourceMediaElement.connect(this.analyser)}}])&&l(n.prototype,r),o&&l(n,o),t}(((r=n("./src/mediaelement.js"))&&r.__esModule?r:{default:r}).default);t.default=d,e.exports=t.default},"./src/mediaelement.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,o=(r=n("./src/webaudio.js"))&&r.__esModule?r:{default:r},l=function(e){if(e&&e.__esModule)return e;var t=c();if(t&&t.has(e))return t.get(e);var n={};if(null!=e){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var desc=r?Object.getOwnPropertyDescriptor(e,o):null;desc&&(desc.get||desc.set)?Object.defineProperty(n,o,desc):n[o]=e[o]}}return n.default=e,t&&t.set(e,n),n}(n("./src/util/index.js"));function c(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(e,t){return!t||"object"!==f(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e,t,n){return(d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var base=function(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=m(object)););return object}(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(n):desc.value}})(e,t,n||e)}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,p){return(v=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}var y=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=h(this,m(t).call(this,e))).params=e,n.media={currentTime:0,duration:0,paused:!0,playbackRate:1,play:function(){},pause:function(){},volume:0},n.mediaType=e.mediaType.toLowerCase(),n.elementPosition=e.elementPosition,n.peaks=null,n.playbackRate=1,n.volume=1,n.isMuted=!1,n.buffer=null,n.onPlayEnd=null,n.mediaListeners={},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(t,e),n=t,(r=[{key:"init",value:function(){this.setPlaybackRate(this.params.audioRate),this.createTimer()}},{key:"_setupMediaListeners",value:function(){var e=this;this.mediaListeners.error=function(){e.fireEvent("error","Error loading media element")},this.mediaListeners.canplay=function(){e.fireEvent("canplay")},this.mediaListeners.ended=function(){e.fireEvent("finish")},this.mediaListeners.play=function(){e.fireEvent("play")},this.mediaListeners.pause=function(){e.fireEvent("pause")},this.mediaListeners.seeked=function(t){e.fireEvent("seek")},this.mediaListeners.volumechange=function(t){e.isMuted=e.media.muted,e.isMuted?e.volume=0:e.volume=e.media.volume,e.fireEvent("volume")},Object.keys(this.mediaListeners).forEach((function(t){e.media.removeEventListener(t,e.mediaListeners[t]),e.media.addEventListener(t,e.mediaListeners[t])}))}},{key:"createTimer",value:function(){var e=this;this.on("play",(function t(){e.isPaused()||(e.fireEvent("audioprocess",e.getCurrentTime()),l.frame(t)())})),this.on("pause",(function(){e.fireEvent("audioprocess",e.getCurrentTime())}))}},{key:"load",value:function(e,t,n,r){var o=document.createElement(this.mediaType);o.controls=this.params.mediaControls,o.autoplay=this.params.autoplay||!1,o.preload=null==r?"auto":r,o.src=e,o.style.width="100%";var l=t.querySelector(this.mediaType);l&&t.removeChild(l),t.appendChild(o),this._load(o,n)}},{key:"loadElt",value:function(e,t){e.controls=this.params.mediaControls,e.autoplay=this.params.autoplay||!1,this._load(e,t)}},{key:"_load",value:function(e,t){if(!(e instanceof HTMLMediaElement)||void 0===e.addEventListener)throw new Error("media parameter is not a valid media element");"function"==typeof e.load&&e.load(),this.media=e,this._setupMediaListeners(),this.peaks=t,this.onPlayEnd=null,this.buffer=null,this.isMuted=e.muted,this.setPlaybackRate(this.playbackRate),this.setVolume(this.volume)}},{key:"isPaused",value:function(){return!this.media||this.media.paused}},{key:"getDuration",value:function(){if(this.explicitDuration)return this.explicitDuration;var e=(this.buffer||this.media).duration;return e>=1/0&&(e=this.media.seekable.end(0)),e}},{key:"getCurrentTime",value:function(){return this.media&&this.media.currentTime}},{key:"getPlayedPercents",value:function(){return this.getCurrentTime()/this.getDuration()||0}},{key:"getPlaybackRate",value:function(){return this.playbackRate||this.media.playbackRate}},{key:"setPlaybackRate",value:function(e){this.playbackRate=e||1,this.media.playbackRate=this.playbackRate}},{key:"seekTo",value:function(e){null!=e&&(this.media.currentTime=e),this.clearPlayEnd()}},{key:"play",value:function(e,t){this.seekTo(e);var n=this.media.play();return t&&this.setPlayEnd(t),n}},{key:"pause",value:function(){var e;return this.media&&(e=this.media.pause()),this.clearPlayEnd(),e}},{key:"setPlayEnd",value:function(e){var t=this;this._onPlayEnd=function(time){time>=e&&(t.pause(),t.seekTo(e))},this.on("audioprocess",this._onPlayEnd)}},{key:"clearPlayEnd",value:function(){this._onPlayEnd&&(this.un("audioprocess",this._onPlayEnd),this._onPlayEnd=null)}},{key:"getPeaks",value:function(e,n,r){return this.buffer?d(m(t.prototype),"getPeaks",this).call(this,e,n,r):this.peaks||[]}},{key:"setSinkId",value:function(e){return e?this.media.setSinkId?this.media.setSinkId(e):Promise.reject(new Error("setSinkId is not supported in your browser")):Promise.reject(new Error("Invalid deviceId: "+e))}},{key:"getVolume",value:function(){return this.volume}},{key:"setVolume",value:function(e){this.volume=e,this.media.volume!==this.volume&&(this.media.volume=this.volume)}},{key:"destroy",value:function(){var e=this;this.pause(),this.unAll(),this.destroyed=!0,Object.keys(this.mediaListeners).forEach((function(t){e.media&&e.media.removeEventListener(t,e.mediaListeners[t])})),this.params.removeMediaElementOnDestroy&&this.media&&this.media.parentNode&&this.media.parentNode.removeChild(this.media),this.media=null}}])&&_(n.prototype,r),o&&_(n,o),t}(o.default);t.default=y,e.exports=t.default},"./src/peakcache.js":function(e,t,n){"use strict";function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clearPeakCache()}var t,n,o;return t=e,(n=[{key:"clearPeakCache",value:function(){this.peakCacheRanges=[],this.peakCacheLength=-1}},{key:"addRangeToPeakCache",value:function(e,t,n){e!=this.peakCacheLength&&(this.clearPeakCache(),this.peakCacheLength=e);for(var r=[],i=0;i<this.peakCacheRanges.length&&this.peakCacheRanges[i]<t;)i++;for(i%2==0&&r.push(t);i<this.peakCacheRanges.length&&this.peakCacheRanges[i]<=n;)r.push(this.peakCacheRanges[i]),i++;i%2==0&&r.push(n),r=r.filter((function(e,t,n){return 0==t?e!=n[t+1]:t==n.length-1?e!=n[t-1]:e!=n[t-1]&&e!=n[t+1]})),this.peakCacheRanges=this.peakCacheRanges.concat(r),this.peakCacheRanges=this.peakCacheRanges.sort((function(a,b){return a-b})).filter((function(e,t,n){return 0==t?e!=n[t+1]:t==n.length-1?e!=n[t-1]:e!=n[t-1]&&e!=n[t+1]}));var o=[];for(i=0;i<r.length;i+=2)o.push([r[i],r[i+1]]);return o}},{key:"getCacheRanges",value:function(){var i,e=[];for(i=0;i<this.peakCacheRanges.length;i+=2)e.push([this.peakCacheRanges[i],this.peakCacheRanges[i+1]]);return e}}])&&r(t.prototype,n),o&&r(t,o),e}();t.default=o,e.exports=t.default},"./src/util/ajax.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=new o.default,n=new XMLHttpRequest,r=!1;return n.open(e.method||"GET",e.url,!0),n.responseType=e.responseType||"json",e.xhr&&(e.xhr.requestHeaders&&e.xhr.requestHeaders.forEach((function(header){n.setRequestHeader(header.key,header.value)})),e.xhr.withCredentials&&(n.withCredentials=!0)),n.addEventListener("progress",(function(e){t.fireEvent("progress",e),e.lengthComputable&&e.loaded==e.total&&(r=!0)})),n.addEventListener("load",(function(e){r||t.fireEvent("progress",e),t.fireEvent("load",e),200==n.status||206==n.status?t.fireEvent("success",n.response,e):t.fireEvent("error",e)})),n.addEventListener("error",(function(e){return t.fireEvent("error",e)})),n.send(),t.xhr=n,t};var r,o=(r=n("./src/util/observer.js"))&&r.__esModule?r:{default:r};e.exports=t.default},"./src/util/extend.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.forEach((function(source){Object.keys(source).forEach((function(t){e[t]=source[t]}))})),e},e.exports=t.default},"./src/util/fetch.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!e)throw new Error("fetch options missing");if(!e.url)throw new Error("fetch url missing");var t=new o.default,n=new Headers,r=new Request(e.url);t.controller=new AbortController,e&&e.requestHeaders&&e.requestHeaders.forEach((function(header){n.append(header.key,header.value)}));var l=e.responseType||"json",f={method:e.method||"GET",headers:n,mode:e.mode||"cors",credentials:e.credentials||"same-origin",cache:e.cache||"default",redirect:e.redirect||"follow",referrer:e.referrer||"client",signal:t.controller.signal};return fetch(r,f).then((function(e){t.response=e;var n=!0;e.body||(n=!1);var r=e.headers.get("content-length");return null===r&&(n=!1),n?(t.onProgress=function(e){t.fireEvent("progress",e)},new Response(new ReadableStream(new c(t,r,e)),f)):e})).then((function(e){var t;if(e.ok)switch(l){case"arraybuffer":return e.arrayBuffer();case"json":return e.json();case"blob":return e.blob();case"text":return e.text();default:t="Unknown responseType: "+l}throw t||(t="HTTP error status: "+e.status),new Error(t)})).then((function(e){t.fireEvent("success",e)})).catch((function(e){t.fireEvent("error",e)})),t.fetchRequest=r,t};var r,o=(r=n("./src/util/observer.js"))&&r.__esModule?r:{default:r};function l(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.instance=t,this.instance._reader=r.body.getReader(),this.total=parseInt(n,10),this.loaded=0}var t,n,r;return t=e,(n=[{key:"start",value:function(e){var t=this;!function n(){t.instance._reader.read().then((function(r){var o=r.done,l=r.value;if(o)return 0===t.total&&t.instance.onProgress.call(t.instance,{loaded:t.loaded,total:t.total,lengthComputable:!1}),void e.close();t.loaded+=l.byteLength,t.instance.onProgress.call(t.instance,{loaded:t.loaded,total:t.total,lengthComputable:!(0===t.total)}),e.enqueue(l),n()})).catch((function(t){e.error(t)}))}()}}])&&l(t.prototype,n),r&&l(t,r),e}();e.exports=t.default},"./src/util/frame.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(0,o.default)((function(){return e.apply(void 0,n)}))}};var r,o=(r=n("./src/util/request-animation-frame.js"))&&r.__esModule?r:{default:r};e.exports=t.default},"./src/util/get-id.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return void 0===e&&(e="wavesurfer_"),e+Math.random().toString(32).substring(2)},e.exports=t.default},"./src/util/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ajax",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"getId",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"max",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"min",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(t,"Observer",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(t,"extend",{enumerable:!0,get:function(){return _.default}}),Object.defineProperty(t,"style",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(t,"requestAnimationFrame",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"frame",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(t,"debounce",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(t,"preventClick",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(t,"fetchFile",{enumerable:!0,get:function(){return w.default}});var r=k(n("./src/util/ajax.js")),o=k(n("./src/util/get-id.js")),l=k(n("./src/util/max.js")),c=k(n("./src/util/min.js")),f=k(n("./src/util/observer.js")),_=k(n("./src/util/extend.js")),h=k(n("./src/util/style.js")),d=k(n("./src/util/request-animation-frame.js")),m=k(n("./src/util/frame.js")),v=k(n("./node_modules/debounce/index.js")),y=k(n("./src/util/prevent-click.js")),w=k(n("./src/util/fetch.js"));function k(e){return e&&e.__esModule?e:{default:e}}},"./src/util/max.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=-1/0;return Object.keys(e).forEach((function(i){e[i]>t&&(t=e[i])})),t},e.exports=t.default},"./src/util/min.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=Number(1/0);return Object.keys(e).forEach((function(i){e[i]<t&&(t=e[i])})),t},e.exports=t.default},"./src/util/observer.js":function(e,t,n){"use strict";function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.handlers=null}var t,n,o;return t=e,(n=[{key:"on",value:function(e,t){var n=this;this.handlers||(this.handlers={});var r=this.handlers[e];return r||(r=this.handlers[e]=[]),r.push(t),{name:e,callback:t,un:function(e,t){return n.un(e,t)}}}},{key:"un",value:function(e,t){if(this.handlers){var i,n=this.handlers[e];if(n)if(t)for(i=n.length-1;i>=0;i--)n[i]==t&&n.splice(i,1);else n.length=0}}},{key:"unAll",value:function(){this.handlers=null}},{key:"once",value:function(e,t){var n=this;return this.on(e,(function r(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];t.apply(n,l),setTimeout((function(){n.un(e,r)}),0)}))}},{key:"fireEvent",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(this.handlers){var o=this.handlers[e];o&&o.forEach((function(e){e.apply(void 0,n)}))}}}])&&r(t.prototype,n),o&&r(t,o),e}();t.default=o,e.exports=t.default},"./src/util/prevent-click.js":function(e,t,n){"use strict";function r(e){e.stopPropagation(),document.body.removeEventListener("click",r,!0)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){document.body.addEventListener("click",r,!0)},e.exports=t.default},"./src/util/request-animation-frame.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,element){return setTimeout(e,1e3/60)}).bind(window);t.default=r,e.exports=t.default},"./src/util/style.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return Object.keys(t).forEach((function(n){e.style[n]!==t[n]&&(e.style[n]=t[n])})),e},e.exports=t.default},"./src/wavesurfer.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if(e&&e.__esModule)return e;var t=d();if(t&&t.has(e))return t.get(e);var n={};if(null!=e){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var desc=r?Object.getOwnPropertyDescriptor(e,o):null;desc&&(desc.get||desc.set)?Object.defineProperty(n,o,desc):n[o]=e[o]}}return n.default=e,t&&t.set(e,n),n}(n("./src/util/index.js")),o=h(n("./src/drawer.multicanvas.js")),l=h(n("./src/webaudio.js")),c=h(n("./src/mediaelement.js")),f=h(n("./src/peakcache.js")),_=h(n("./src/mediaelement-webaudio.js"));function h(e){return e&&e.__esModule?e:{default:e}}function d(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return d=function(){return e},e}function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){return!t||"object"!==m(t)&&"function"!=typeof t?w(e):t}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function k(e,p){return(k=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function R(e,t,n){return t&&M(e.prototype,t),n&&M(e,n),e}var x=function(e){function t(e){var n;if(S(this,t),(n=v(this,y(t).call(this))).defaultParams={audioContext:null,audioScriptProcessor:null,audioRate:1,autoCenter:!0,autoCenterRate:5,autoCenterImmediately:!1,backend:"WebAudio",backgroundColor:null,barHeight:1,barRadius:0,barGap:null,container:null,cursorColor:"#333",cursorWidth:1,dragSelection:!0,duration:null,fillParent:!0,forceDecode:!1,height:128,hideScrollbar:!1,interact:!0,loopSelection:!0,maxCanvasWidth:4e3,mediaContainer:null,mediaControls:!1,mediaType:"audio",minPxPerSec:20,normalize:!1,partialRender:!1,pixelRatio:window.devicePixelRatio||screen.deviceXDPI/screen.logicalXDPI,plugins:[],progressColor:"#555",removeMediaElementOnDestroy:!0,renderer:o.default,responsive:!1,rtl:!1,scrollParent:!1,skipLength:2,splitChannels:!1,waveColor:"#999",xhr:{}},n.backends={MediaElement:c.default,WebAudio:l.default,MediaElementWebAudio:_.default},n.util=r,n.params=r.extend({},n.defaultParams,e),n.container="string"==typeof e.container?document.querySelector(n.params.container):n.params.container,!n.container)throw new Error("Container element not found");if(null==n.params.mediaContainer?n.mediaContainer=n.container:"string"==typeof n.params.mediaContainer?n.mediaContainer=document.querySelector(n.params.mediaContainer):n.mediaContainer=n.params.mediaContainer,!n.mediaContainer)throw new Error("Media Container element not found");if(n.params.maxCanvasWidth<=1)throw new Error("maxCanvasWidth must be greater than 1");if(n.params.maxCanvasWidth%2==1)throw new Error("maxCanvasWidth must be an even number");if(!0===n.params.rtl&&r.style(n.container,{transform:"rotateY(180deg)"}),n.params.backgroundColor&&n.setBackgroundColor(n.params.backgroundColor),n.savedVolume=0,n.isMuted=!1,n.tmpEvents=[],n.currentRequest=null,n.arraybuffer=null,n.drawer=null,n.backend=null,n.peakCache=null,"function"!=typeof n.params.renderer)throw new Error("Renderer parameter is invalid");n.Drawer=n.params.renderer,"AudioElement"==n.params.backend&&(n.params.backend="MediaElement"),"WebAudio"!=n.params.backend&&"MediaElementWebAudio"!==n.params.backend||l.default.prototype.supportsWebAudio.call(null)||(n.params.backend="MediaElement"),n.Backend=n.backends[n.params.backend],n.initialisedPluginList={},n.isDestroyed=!1,n.isReady=!1;var f=0;return n._onResize=r.debounce((function(){f==n.drawer.wrapper.clientWidth||n.params.scrollParent||(f=n.drawer.wrapper.clientWidth,n.drawer.fireEvent("redraw"))}),"number"==typeof n.params.responsive?n.params.responsive:100),v(n,w(n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&k(e,t)}(t,e),R(t,null,[{key:"create",value:function(e){return new t(e).init()}}]),R(t,[{key:"init",value:function(){return this.registerPlugins(this.params.plugins),this.createDrawer(),this.createBackend(),this.createPeakCache(),this}},{key:"registerPlugins",value:function(e){var t=this;return e.forEach((function(e){return t.addPlugin(e)})),e.forEach((function(e){e.deferInit||t.initPlugin(e.name)})),this.fireEvent("plugins-registered",e),this}},{key:"getActivePlugins",value:function(){return this.initialisedPluginList}},{key:"addPlugin",value:function(e){var t=this;if(!e.name)throw new Error("Plugin does not have a name!");if(!e.instance)throw new Error("Plugin ".concat(e.name," does not have an instance property!"));e.staticProps&&Object.keys(e.staticProps).forEach((function(n){t[n]=e.staticProps[n]}));var n=e.instance;return Object.getOwnPropertyNames(r.Observer.prototype).forEach((function(e){n.prototype[e]=r.Observer.prototype[e]})),this[e.name]=new n(e.params||{},this),this.fireEvent("plugin-added",e.name),this}},{key:"initPlugin",value:function(e){if(!this[e])throw new Error("Plugin ".concat(e," has not been added yet!"));return this.initialisedPluginList[e]&&this.destroyPlugin(e),this[e].init(),this.initialisedPluginList[e]=!0,this.fireEvent("plugin-initialised",e),this}},{key:"destroyPlugin",value:function(e){if(!this[e])throw new Error("Plugin ".concat(e," has not been added yet and cannot be destroyed!"));if(!this.initialisedPluginList[e])throw new Error("Plugin ".concat(e," is not active and cannot be destroyed!"));if("function"!=typeof this[e].destroy)throw new Error("Plugin ".concat(e," does not have a destroy function!"));return this[e].destroy(),delete this.initialisedPluginList[e],this.fireEvent("plugin-destroyed",e),this}},{key:"destroyAllPlugins",value:function(){var e=this;Object.keys(this.initialisedPluginList).forEach((function(t){return e.destroyPlugin(t)}))}},{key:"createDrawer",value:function(){var e=this;this.drawer=new this.Drawer(this.container,this.params),this.drawer.init(),this.fireEvent("drawer-created",this.drawer),!1!==this.params.responsive&&(window.addEventListener("resize",this._onResize,!0),window.addEventListener("orientationchange",this._onResize,!0)),this.drawer.on("redraw",(function(){e.drawBuffer(),e.drawer.progress(e.backend.getPlayedPercents())})),this.drawer.on("click",(function(t,progress){setTimeout((function(){return e.seekTo(progress)}),0)})),this.drawer.on("scroll",(function(t){e.params.partialRender&&e.drawBuffer(),e.fireEvent("scroll",t)}))}},{key:"createBackend",value:function(){var e=this;this.backend&&this.backend.destroy(),this.backend=new this.Backend(this.params),this.backend.init(),this.fireEvent("backend-created",this.backend),this.backend.on("finish",(function(){e.drawer.progress(e.backend.getPlayedPercents()),e.fireEvent("finish")})),this.backend.on("play",(function(){return e.fireEvent("play")})),this.backend.on("pause",(function(){return e.fireEvent("pause")})),this.backend.on("audioprocess",(function(time){e.drawer.progress(e.backend.getPlayedPercents()),e.fireEvent("audioprocess",time)})),"MediaElement"!==this.params.backend&&"MediaElementWebAudio"!==this.params.backend||(this.backend.on("seek",(function(){e.drawer.progress(e.backend.getPlayedPercents())})),this.backend.on("volume",(function(){var t=e.getVolume();e.fireEvent("volume",t),e.backend.isMuted!==e.isMuted&&(e.isMuted=e.backend.isMuted,e.fireEvent("mute",e.isMuted))})))}},{key:"createPeakCache",value:function(){this.params.partialRender&&(this.peakCache=new f.default)}},{key:"getDuration",value:function(){return this.backend.getDuration()}},{key:"getCurrentTime",value:function(){return this.backend.getCurrentTime()}},{key:"setCurrentTime",value:function(e){e>=this.getDuration()?this.seekTo(1):this.seekTo(e/this.getDuration())}},{key:"play",value:function(e,t){var n=this;return this.fireEvent("interaction",(function(){return n.play(e,t)})),this.backend.play(e,t)}},{key:"pause",value:function(){if(!this.backend.isPaused())return this.backend.pause()}},{key:"playPause",value:function(){return this.backend.isPaused()?this.play():this.pause()}},{key:"isPlaying",value:function(){return!this.backend.isPaused()}},{key:"skipBackward",value:function(e){this.skip(-e||-this.params.skipLength)}},{key:"skipForward",value:function(e){this.skip(e||this.params.skipLength)}},{key:"skip",value:function(e){var t=this.getDuration()||1,n=this.getCurrentTime()||0;n=Math.max(0,Math.min(t,n+(e||0))),this.seekAndCenter(n/t)}},{key:"seekAndCenter",value:function(progress){this.seekTo(progress),this.drawer.recenter(progress)}},{key:"seekTo",value:function(progress){var e=this;if("number"!=typeof progress||!isFinite(progress)||progress<0||progress>1)throw new Error("Error calling wavesurfer.seekTo, parameter must be a number between 0 and 1!");this.fireEvent("interaction",(function(){return e.seekTo(progress)}));var t=this.backend.isPaused();t||this.backend.pause();var n=this.params.scrollParent;this.params.scrollParent=!1,this.backend.seekTo(progress*this.getDuration()),this.drawer.progress(progress),t||this.backend.play(),this.params.scrollParent=n,this.fireEvent("seek",progress)}},{key:"stop",value:function(){this.pause(),this.seekTo(0),this.drawer.progress(0)}},{key:"setSinkId",value:function(e){return this.backend.setSinkId(e)}},{key:"setVolume",value:function(e){this.backend.setVolume(e),this.fireEvent("volume",e)}},{key:"getVolume",value:function(){return this.backend.getVolume()}},{key:"setPlaybackRate",value:function(e){this.backend.setPlaybackRate(e)}},{key:"getPlaybackRate",value:function(){return this.backend.getPlaybackRate()}},{key:"toggleMute",value:function(){this.setMute(!this.isMuted)}},{key:"setMute",value:function(e){e!==this.isMuted?(e?(this.savedVolume=this.backend.getVolume(),this.backend.setVolume(0),this.isMuted=!0,this.fireEvent("volume",0)):(this.backend.setVolume(this.savedVolume),this.isMuted=!1,this.fireEvent("volume",this.savedVolume)),this.fireEvent("mute",this.isMuted)):this.fireEvent("mute",this.isMuted)}},{key:"getMute",value:function(){return this.isMuted}},{key:"getFilters",value:function(){return this.backend.filters||[]}},{key:"toggleScroll",value:function(){this.params.scrollParent=!this.params.scrollParent,this.drawBuffer()}},{key:"toggleInteraction",value:function(){this.params.interact=!this.params.interact}},{key:"getWaveColor",value:function(){return this.params.waveColor}},{key:"setWaveColor",value:function(e){this.params.waveColor=e,this.drawBuffer()}},{key:"getProgressColor",value:function(){return this.params.progressColor}},{key:"setProgressColor",value:function(e){this.params.progressColor=e,this.drawBuffer()}},{key:"getBackgroundColor",value:function(){return this.params.backgroundColor}},{key:"setBackgroundColor",value:function(e){this.params.backgroundColor=e,r.style(this.container,{background:this.params.backgroundColor})}},{key:"getCursorColor",value:function(){return this.params.cursorColor}},{key:"setCursorColor",value:function(e){this.params.cursorColor=e,this.drawer.updateCursor()}},{key:"getHeight",value:function(){return this.params.height}},{key:"setHeight",value:function(e){this.params.height=e,this.drawer.setHeight(e*this.params.pixelRatio),this.drawBuffer()}},{key:"drawBuffer",value:function(){var e,t=Math.round(this.getDuration()*this.params.minPxPerSec*this.params.pixelRatio),n=this.drawer.getWidth(),r=t,o=0,l=Math.max(o+n,r);if(this.params.fillParent&&(!this.params.scrollParent||t<n)&&(o=0,l=r=n),this.params.partialRender){var i,c=this.peakCache.addRangeToPeakCache(r,o,l);for(i=0;i<c.length;i++)e=this.backend.getPeaks(r,c[i][0],c[i][1]),this.drawer.drawPeaks(e,r,c[i][0],c[i][1])}else e=this.backend.getPeaks(r,o,l),this.drawer.drawPeaks(e,r,o,l);this.fireEvent("redraw",e,r)}},{key:"zoom",value:function(e){e?(this.params.minPxPerSec=e,this.params.scrollParent=!0):(this.params.minPxPerSec=this.defaultParams.minPxPerSec,this.params.scrollParent=!1),this.drawBuffer(),this.drawer.progress(this.backend.getPlayedPercents()),this.drawer.recenter(this.getCurrentTime()/this.getDuration()),this.fireEvent("zoom",e)}},{key:"loadArrayBuffer",value:function(e){var t=this;this.decodeArrayBuffer(e,(function(data){t.isDestroyed||t.loadDecodedBuffer(data)}))}},{key:"loadDecodedBuffer",value:function(e){this.backend.load(e),this.drawBuffer(),this.isReady=!0,this.fireEvent("ready")}},{key:"loadBlob",value:function(e){var t=this,n=new FileReader;n.addEventListener("progress",(function(e){return t.onProgress(e)})),n.addEventListener("load",(function(e){return t.loadArrayBuffer(e.target.result)})),n.addEventListener("error",(function(){return t.fireEvent("error","Error reading file")})),n.readAsArrayBuffer(e),this.empty()}},{key:"load",value:function(e,t,n,r){if(!e)throw new Error("url parameter cannot be empty");if(this.empty(),n){var o={"Preload is not 'auto', 'none' or 'metadata'":-1===["auto","metadata","none"].indexOf(n),"Peaks are not provided":!t,"Backend is not of type 'MediaElement' or 'MediaElementWebAudio'":-1===["MediaElement","MediaElementWebAudio"].indexOf(this.params.backend),"Url is not of type string":"string"!=typeof e},l=Object.keys(o).filter((function(e){return o[e]}));l.length&&(console.warn("Preload parameter of wavesurfer.load will be ignored because:\n\t- "+l.join("\n\t- ")),n=null)}switch(this.params.backend){case"WebAudio":return this.loadBuffer(e,t,r);case"MediaElement":case"MediaElementWebAudio":return this.loadMediaElement(e,t,n,r)}}},{key:"loadBuffer",value:function(e,t,n){var r=this,o=function(t){return t&&r.tmpEvents.push(r.once("ready",t)),r.getArrayBuffer(e,(function(data){return r.loadArrayBuffer(data)}))};if(!t)return o();this.backend.setPeaks(t,n),this.drawBuffer(),this.tmpEvents.push(this.once("interaction",o))}},{key:"loadMediaElement",value:function(e,t,n,r){var o=this,l=e;if("string"==typeof e)this.backend.load(l,this.mediaContainer,t,n);else{var c=e;this.backend.loadElt(c,t),l=c.src}this.tmpEvents.push(this.backend.once("canplay",(function(){o.backend.destroyed||(o.drawBuffer(),o.isReady=!0,o.fireEvent("ready"))})),this.backend.once("error",(function(e){return o.fireEvent("error",e)}))),t&&this.backend.setPeaks(t,r),t&&!this.params.forceDecode||!this.backend.supportsWebAudio()||this.getArrayBuffer(l,(function(e){o.decodeArrayBuffer(e,(function(e){o.backend.buffer=e,o.backend.setPeaks(null),o.drawBuffer(),o.fireEvent("waveform-ready")}))}))}},{key:"decodeArrayBuffer",value:function(e,t){var n=this;this.arraybuffer=e,this.backend.decodeArrayBuffer(e,(function(data){n.isDestroyed||n.arraybuffer!=e||(t(data),n.arraybuffer=null)}),(function(){return n.fireEvent("error","Error decoding audiobuffer")}))}},{key:"getArrayBuffer",value:function(e,t){var n=this,o=r.extend({url:e,responseType:"arraybuffer"},this.params.xhr),l=r.fetchFile(o);return this.currentRequest=l,this.tmpEvents.push(l.on("progress",(function(e){n.onProgress(e)})),l.on("success",(function(data){t(data),n.currentRequest=null})),l.on("error",(function(e){n.fireEvent("error",e),n.currentRequest=null}))),l}},{key:"onProgress",value:function(e){var t;t=e.lengthComputable?e.loaded/e.total:e.loaded/(e.loaded+1e6),this.fireEvent("loading",Math.round(100*t),e.target)}},{key:"exportPCM",value:function(e,t,n,r){e=e||1024,r=r||0,t=t||1e4,n=n||!1;var o=this.backend.getPeaks(e,r),l=[].map.call(o,(function(e){return Math.round(e*t)/t})),c=JSON.stringify(l);return n||window.open("data:application/json;charset=utf-8,"+encodeURIComponent(c)),c}},{key:"exportImage",value:function(e,t,n){return e||(e="image/png"),t||(t=1),n||(n="dataURL"),this.drawer.getImage(e,t,n)}},{key:"cancelAjax",value:function(){this.currentRequest&&this.currentRequest.controller&&(this.currentRequest.controller.abort(),this.currentRequest=null)}},{key:"clearTmpEvents",value:function(){this.tmpEvents.forEach((function(e){return e.un()}))}},{key:"empty",value:function(){this.backend.isPaused()||(this.stop(),this.backend.disconnectSource()),this.isReady=!1,this.cancelAjax(),this.clearTmpEvents(),this.drawer.progress(0),this.drawer.setWidth(0),this.drawer.drawPeaks({length:this.drawer.getWidth()},0)}},{key:"destroy",value:function(){this.destroyAllPlugins(),this.fireEvent("destroy"),this.cancelAjax(),this.clearTmpEvents(),this.unAll(),!1!==this.params.responsive&&(window.removeEventListener("resize",this._onResize,!0),window.removeEventListener("orientationchange",this._onResize,!0)),this.backend&&this.backend.destroy(),this.drawer&&this.drawer.destroy(),this.isDestroyed=!0,this.isReady=!1,this.arraybuffer=null}}]),t}(r.Observer);t.default=x,x.VERSION="3.2.0",x.util=r,e.exports=t.default},"./src/webaudio.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){if(e&&e.__esModule)return e;var t=o();if(t&&t.has(e))return t.get(e);var n={};if(null!=e){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if(Object.prototype.hasOwnProperty.call(e,l)){var desc=r?Object.getOwnPropertyDescriptor(e,l):null;desc&&(desc.get||desc.set)?Object.defineProperty(n,l,desc):n[l]=e[l]}}return n.default=e,t&&t.set(e,n),n}(n("./src/util/index.js"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(e,t,n){return t&&h(e.prototype,t),n&&h(e,n),e}function m(e,p){return(m=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}var v="playing",y="paused",w="finished",k=function(e){function t(e){var n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=f(this,_(t).call(this))).audioContext=null,o.offlineAudioContext=null,o.stateBehaviors=(c(n={},v,{init:function(){this.addOnAudioProcess()},getPlayedPercents:function(){var e=this.getDuration();return this.getCurrentTime()/e||0},getCurrentTime:function(){return this.startPosition+this.getPlayedTime()}}),c(n,y,{init:function(){this.removeOnAudioProcess()},getPlayedPercents:function(){var e=this.getDuration();return this.getCurrentTime()/e||0},getCurrentTime:function(){return this.startPosition}}),c(n,w,{init:function(){this.removeOnAudioProcess(),this.fireEvent("finish")},getPlayedPercents:function(){return 1},getCurrentTime:function(){return this.getDuration()}}),n),o.params=e,o.ac=e.audioContext||(o.supportsWebAudio()?o.getAudioContext():{}),o.lastPlay=o.ac.currentTime,o.startPosition=0,o.scheduledPause=null,o.states=(c(r={},v,Object.create(o.stateBehaviors[v])),c(r,y,Object.create(o.stateBehaviors[y])),c(r,w,Object.create(o.stateBehaviors[w])),r),o.buffer=null,o.filters=[],o.gainNode=null,o.mergedPeaks=null,o.offlineAc=null,o.peaks=null,o.playbackRate=1,o.analyser=null,o.scriptNode=null,o.source=null,o.splitPeaks=[],o.state=null,o.explicitDuration=e.duration,o.destroyed=!1,o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(t,e),d(t,[{key:"supportsWebAudio",value:function(){return!(!window.AudioContext&&!window.webkitAudioContext)}},{key:"getAudioContext",value:function(){return window.WaveSurferAudioContext||(window.WaveSurferAudioContext=new(window.AudioContext||window.webkitAudioContext)),window.WaveSurferAudioContext}},{key:"getOfflineAudioContext",value:function(e){return window.WaveSurferOfflineAudioContext||(window.WaveSurferOfflineAudioContext=new(window.OfflineAudioContext||window.webkitOfflineAudioContext)(1,2,e)),window.WaveSurferOfflineAudioContext}}]),d(t,[{key:"init",value:function(){this.createVolumeNode(),this.createScriptNode(),this.createAnalyserNode(),this.setState(y),this.setPlaybackRate(this.params.audioRate),this.setLength(0)}},{key:"disconnectFilters",value:function(){this.filters&&(this.filters.forEach((function(filter){filter&&filter.disconnect()})),this.filters=null,this.analyser.connect(this.gainNode))}},{key:"setState",value:function(e){this.state!==this.states[e]&&(this.state=this.states[e],this.state.init.call(this))}},{key:"setFilter",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.setFilters(t)}},{key:"setFilters",value:function(e){this.disconnectFilters(),e&&e.length&&(this.filters=e,this.analyser.disconnect(),e.reduce((function(e,t){return e.connect(t),t}),this.analyser).connect(this.gainNode))}},{key:"createScriptNode",value:function(){this.params.audioScriptProcessor?this.scriptNode=this.params.audioScriptProcessor:this.ac.createScriptProcessor?this.scriptNode=this.ac.createScriptProcessor(t.scriptBufferSize):this.scriptNode=this.ac.createJavaScriptNode(t.scriptBufferSize),this.scriptNode.connect(this.ac.destination)}},{key:"addOnAudioProcess",value:function(){var e=this;this.scriptNode.onaudioprocess=function(){var time=e.getCurrentTime();time>=e.getDuration()?(e.setState(w),e.fireEvent("pause")):time>=e.scheduledPause?e.pause():e.state===e.states[v]&&e.fireEvent("audioprocess",time)}}},{key:"removeOnAudioProcess",value:function(){this.scriptNode.onaudioprocess=function(){}}},{key:"createAnalyserNode",value:function(){this.analyser=this.ac.createAnalyser(),this.analyser.connect(this.gainNode)}},{key:"createVolumeNode",value:function(){this.ac.createGain?this.gainNode=this.ac.createGain():this.gainNode=this.ac.createGainNode(),this.gainNode.connect(this.ac.destination)}},{key:"setSinkId",value:function(e){if(e){var audio=new window.Audio;if(!audio.setSinkId)return Promise.reject(new Error("setSinkId is not supported in your browser"));audio.autoplay=!0;var t=this.ac.createMediaStreamDestination();return this.gainNode.disconnect(),this.gainNode.connect(t),audio.srcObject=t.stream,audio.setSinkId(e)}return Promise.reject(new Error("Invalid deviceId: "+e))}},{key:"setVolume",value:function(e){this.gainNode.gain.setValueAtTime(e,this.ac.currentTime)}},{key:"getVolume",value:function(){return this.gainNode.gain.value}},{key:"decodeArrayBuffer",value:function(e,t,n){this.offlineAc||(this.offlineAc=this.getOfflineAudioContext(this.ac&&this.ac.sampleRate?this.ac.sampleRate:44100)),this.offlineAc.decodeAudioData(e,(function(data){return t(data)}),n)}},{key:"setPeaks",value:function(e,t){null!=t&&(this.explicitDuration=t),this.peaks=e}},{key:"setLength",value:function(e){if(!this.mergedPeaks||e!=2*this.mergedPeaks.length-1+2){this.splitPeaks=[],this.mergedPeaks=[];var t,n=this.buffer?this.buffer.numberOfChannels:1;for(t=0;t<n;t++)this.splitPeaks[t]=[],this.splitPeaks[t][2*(e-1)]=0,this.splitPeaks[t][2*(e-1)+1]=0;this.mergedPeaks[2*(e-1)]=0,this.mergedPeaks[2*(e-1)+1]=0}}},{key:"getPeaks",value:function(e,t,n){if(this.peaks)return this.peaks;if(!this.buffer)return[];if(t=t||0,n=n||e-1,this.setLength(e),!this.buffer)return this.params.splitChannels?this.splitPeaks:this.mergedPeaks;if(!this.buffer.length){var r=this.createBuffer(1,4096,this.sampleRate);this.buffer=r.buffer}var o,l=this.buffer.length/e,c=~~(l/10)||1,f=this.buffer.numberOfChannels;for(o=0;o<f;o++){var _=this.splitPeaks[o],h=this.buffer.getChannelData(o),i=void 0;for(i=t;i<=n;i++){var d=~~(i*l),m=~~(d+l),v=0,y=0,w=void 0;for(w=d;w<m;w+=c){var k=h[w];k>y&&(y=k),k<v&&(v=k)}_[2*i]=y,_[2*i+1]=v,(0==o||y>this.mergedPeaks[2*i])&&(this.mergedPeaks[2*i]=y),(0==o||v<this.mergedPeaks[2*i+1])&&(this.mergedPeaks[2*i+1]=v)}}return this.params.splitChannels?this.splitPeaks:this.mergedPeaks}},{key:"getPlayedPercents",value:function(){return this.state.getPlayedPercents.call(this)}},{key:"disconnectSource",value:function(){this.source&&this.source.disconnect()}},{key:"destroy",value:function(){this.isPaused()||this.pause(),this.unAll(),this.buffer=null,this.destroyed=!0,this.disconnectFilters(),this.disconnectSource(),this.gainNode.disconnect(),this.scriptNode.disconnect(),this.analyser.disconnect(),this.params.closeAudioContext&&("function"==typeof this.ac.close&&"closed"!=this.ac.state&&this.ac.close(),this.ac=null,this.params.audioContext?this.params.audioContext=null:window.WaveSurferAudioContext=null,window.WaveSurferOfflineAudioContext=null)}},{key:"load",value:function(e){this.startPosition=0,this.lastPlay=this.ac.currentTime,this.buffer=e,this.createSource()}},{key:"createSource",value:function(){this.disconnectSource(),this.source=this.ac.createBufferSource(),this.source.start=this.source.start||this.source.noteGrainOn,this.source.stop=this.source.stop||this.source.noteOff,this.source.playbackRate.setValueAtTime(this.playbackRate,this.ac.currentTime),this.source.buffer=this.buffer,this.source.connect(this.analyser)}},{key:"isPaused",value:function(){return this.state!==this.states[v]}},{key:"getDuration",value:function(){return this.explicitDuration?this.explicitDuration:this.buffer?this.buffer.duration:0}},{key:"seekTo",value:function(e,t){if(this.buffer)return this.scheduledPause=null,null==e&&(e=this.getCurrentTime())>=this.getDuration()&&(e=0),null==t&&(t=this.getDuration()),this.startPosition=e,this.lastPlay=this.ac.currentTime,this.state===this.states[w]&&this.setState(y),{start:e,end:t}}},{key:"getPlayedTime",value:function(){return(this.ac.currentTime-this.lastPlay)*this.playbackRate}},{key:"play",value:function(e,t){if(this.buffer){this.createSource();var n=this.seekTo(e,t);e=n.start,t=n.end,this.scheduledPause=t,this.source.start(0,e,t-e),"suspended"==this.ac.state&&this.ac.resume&&this.ac.resume(),this.setState(v),this.fireEvent("play")}}},{key:"pause",value:function(){this.scheduledPause=null,this.startPosition+=this.getPlayedTime(),this.source&&this.source.stop(0),this.setState(y),this.fireEvent("pause")}},{key:"getCurrentTime",value:function(){return this.state.getCurrentTime.call(this)}},{key:"getPlaybackRate",value:function(){return this.playbackRate}},{key:"setPlaybackRate",value:function(e){e=e||1,this.isPaused()?this.playbackRate=e:(this.pause(),this.playbackRate=e,this.play())}}]),t}(r.Observer);t.default=k,k.scriptBufferSize=256,e.exports=t.default}})},e.exports=r()},654:function(e,t,n){var r;!function(e){"use strict";var t=function(){},n=function(e){return new l(e)};n.IsOpen=function(){var e=n.Stream;if(e){var track=(e.getTracks&&e.getTracks()||e.audioTracks||[])[0];if(track){var t=track.readyState;return"live"==t||t==track.LIVE}}return!1},n.BufferSize=4096,n.Destroy=function(){for(var e in console.log("Recorder Destroy"),r)r[e]()};var r={};n.BindDestroy=function(e,t){r[e]=t},n.Support=function(){var t=e.AudioContext;if(t||(t=e.webkitAudioContext),!t)return!1;var r=navigator.mediaDevices||{};return r.getUserMedia||(r=navigator).getUserMedia||(r.getUserMedia=r.webkitGetUserMedia||r.mozGetUserMedia||r.msGetUserMedia),!!r.getUserMedia&&(n.Scope=r,n.Ctx&&"closed"!=n.Ctx.state||(n.Ctx=new t,n.BindDestroy("Ctx",(function(){var e=n.Ctx;e&&e.close&&e.close()}))),!0)},n.SampleData=function(e,t,n,r,option){r||(r={});var o=r.index||0,l=r.offset||0,c=r.frameNext||[];option||(option={});var f=option.frameSize||1;option.frameType&&(f="mp3"==option.frameType?1152:1);for(var _=0,i=o;i<e.length;i++)_+=e[i].length;_=Math.max(0,_-Math.floor(l));var h=t/n;h>1?_=Math.floor(_/h):(h=1,n=t),_+=c.length;var d=new Int16Array(_),m=0;for(i=0;i<c.length;i++)d[m]=c[i],m++;for(var v=e.length;o<v;o++){for(var y=e[o],w=(i=l,y.length);i<w;){var k=Math.floor(i),S=Math.ceil(i),M=i-k;d[m]=y[k]+(y[S]-y[k])*M,m++,i+=h}l=i-w}c=null;var R=d.length%f;if(R>0){var x=2*(d.length-R);c=new Int16Array(d.buffer.slice(x)),d=new Int16Array(d.buffer.slice(0,x))}return{index:o,offset:l,frameNext:c,sampleRate:n,data:d}};var o=0;function l(e){this.id=++o,n.Traffic&&n.Traffic();var r={type:"mp3",bitRate:16,sampleRate:16e3,onProcess:t};for(var l in e)r[l]=e[l];this.set=r,this._S=9}n.Sync={O:9,C:9},n.prototype=l.prototype={open:function(r,o){var l=this;r=r||t,o=o||t;var c=function(){r(),l._SO=0},f=function(code,t){/Permission|Allow/i.test(code)?o("",!0):!1===e.isSecureContext?o("(https)"):/Found/i.test(code)?o(t+""):o(t)},_=n.Sync,h=++_.O,d=_.C;l._O=l._O_=h,l._SO=l._S;var m=function(){if(d!=_.C||!l._O){var e="open";return h==_.O?l.close():e="open",o(e),!0}};if(n.IsOpen())c();else if(n.Support()){var v=function(e){n.Stream=e,m()||setTimeout((function(){m()||(n.IsOpen()?(function(){var e=n.Ctx,t=n.Stream,r=t._m=e.createMediaStreamSource(t),o=t._p=(e.createScriptProcessor||e.createJavaScriptNode).call(e,n.BufferSize,1,1);r.connect(o),o.connect(e.destination);var l=t._call={};o.onaudioprocess=function(e){for(var t in l){for(var n=e.inputBuffer.getChannelData(0),r=n.length,o=new Int16Array(r),c=0,f=0;f<r;f++){var s=Math.max(-1,Math.min(1,n[f]));s=s<0?32768*s:32767*s,o[f]=s,c+=Math.abs(s)}for(var _ in l)l[_](o,c);return}}}(),c()):o(""))}),100)},y=function(e){var code=e.name||e.message||e.code+":"+e;console.error(e),f(code,""+code)},w=n.Scope.getUserMedia({audio:!0},v,y);w&&w.then&&w.then(v)[r&&"catch"](y)}else f("","")},close:function(e){e=e||t,this._stop();var r=n.Sync;if(this._O=0,this._O_!=r.O)return console.warn("close"),void e();r.C++;var o=n.Stream;if(o){!function(){var e=n.Stream;e._m&&(e._m.disconnect(),e._p.disconnect(),e._p.onaudioprocess=e._p=e._m=null)}();for(var l=o.getTracks&&o.getTracks()||o.audioTracks||[],i=0;i<l.length;i++){var track=l[i];track.stop&&track.stop()}o.stop&&o.stop()}n.Stream=0,e()},mock:function(e,t){return this._stop(),this.isMock=1,this.buffers=[e],this.recSize=e.length,this.srcSampleRate=t,this},envStart:function(e,t){var n=this.set;if(this.isMock=e?1:0,this.buffers=[],this.recSize=0,this.envInLast=0,this.envInFirst=0,this.envInFix=0,this.envInFixTs=[],n.sampleRate=Math.min(t,n.sampleRate),this.srcSampleRate=t,this.engineCtx=0,this[n.type+"_start"]){var r=this.engineCtx=this[n.type+"_start"](n);r&&(r.pcmDatas=[],r.pcmSize=0)}},envResume:function(){this.envInFixTs=[]},envIn:function(e,t){var r=this.set,o=this.engineCtx,l=e.length;this.recSize+=l;var c=this.buffers;c.push(e);var f,_=t/l;f=_<1251?Math.round(_/1250*10):Math.round(Math.min(100,Math.max(0,100*(1+Math.log(_/1e4)/Math.log(10)))));var h=this.srcSampleRate,d=this.recSize,m=Date.now(),v=Math.round(l/h*1e3);this.envInLast=m,1==this.buffers.length&&(this.envInFirst=m-v);var y=this.envInFixTs;y.splice(0,0,{t:m,d:v});for(var w=m,k=0,i=0;i<y.length;i++){var S=y[i];if(m-S.t>3e3){y.length=i;break}w=S.t,k+=S.d}var M=y[1],R=m-w;if(R-k>R/3&&(M&&R>1e3||y.length>=6)){var x=m-M.t-v;if(x>v/5){var P=!r.disableEnvInFix;if(console.warn("["+m+"]"+(P?"":"")+""+x+"ms"),this.envInFix+=x,P){var E=new Int16Array(x*h/1e3);this.recSize+=E.length,c.push(E)}}}if(o){var A=n.SampleData(c,h,r.sampleRate,o.chunkInfo);o.chunkInfo=A,o.pcmSize+=A.data.length,d=o.pcmSize,(c=o.pcmDatas).push(A.data),h=A.sampleRate,this[r.type+"_encode"](o,A.data)}var T=Math.round(d/h*1e3);r.onProcess(c,f,T,h)},start:function(){if(n.IsOpen()){console.log("["+Date.now()+"]Start");var e=this,t=(e.set,n.Ctx);if(e._stop(),e.state=0,e.envStart(0,t.sampleRate),e._SO&&e._SO+1!=e._S)console.warn("start");else{e._SO=0;var r=function(){e.state=1,e.resume()};"suspended"==t.state?t.resume().then((function(){console.log("ctx resume"),r()})):r()}}else console.error("open")},pause:function(){this.state&&(this.state=2,delete n.Stream._call[this.id])},resume:function(){var e=this;e.state&&(e.state=1,e.envResume(),n.Stream._call[e.id]=function(t,n){1==e.state&&e.envIn(t,n)})},_stop:function(e){var t=this.set;this.isMock||this._S++,this.state&&(this.pause(),this.state=0),!e&&this[t.type+"_stop"]&&(this[t.type+"_stop"](this.engineCtx),this.engineCtx=0)},stop:function(e,t,r){var o,l=this,c=l.set;console.log("["+Date.now()+"]Stop "+(l.envInLast?l.envInLast-l.envInFirst+"ms "+l.envInFix+"ms":"-"));var f=function(){l._stop(),r&&l.close()},_=function(e){t&&t(e),f()},h=function(t,n){console.log("["+Date.now()+"] "+(Date.now()-o)+"ms "+n+"ms/"+t.size+"b"),t.size<Math.max(100,n/2)?_(""+c.type+""):(e&&e(t,n),f())};if(!l.isMock){if(!l.state)return void _("");l._stop(!0)}var d=l.recSize;if(d)if(l.buffers[0])if(l[c.type]){var m=l.engineCtx;if(l[c.type+"_complete"]&&m){m.pcmDatas;var v=Math.round(m.pcmSize/c.sampleRate*1e3);return o=Date.now(),void l[c.type+"_complete"](m,(function(e){h(e,v)}),_)}o=Date.now();var y=n.SampleData(l.buffers,l.srcSampleRate,c.sampleRate);c.sampleRate=y.sampleRate;var w=y.data;v=Math.round(w.length/c.sampleRate*1e3),console.log(""+d+"->"+w.length+" :"+(Date.now()-o)+"ms"),setTimeout((function(){o=Date.now(),l[c.type](w,(function(e){h(e,v)}),(function(e){_(e)}))}))}else _(""+c.type+"");else _("");else _("")}},e.Recorder&&e.Recorder.Destroy(),e.Recorder=n,n.LM="2019-11-7 21:47:48",n.TrafficImgUrl="//ia.51.la/go1?id=20469973&pvFlag=1",n.Traffic=function(){var e=n.TrafficImgUrl;if(e){var data=n.Traffic,t=location.href.replace(/#.*/,"");data[t]||(data[t]=1,(new Image).src=e,console.log("Traffic Analysis Image: Recorder.TrafficImgUrl="+e))}}}(window),void 0===(r=function(){return Recorder}.call(t,n,t,e))||(e.exports=r),e.exports&&(e.exports=Recorder)},655:function(e,t){!function(){"use strict";var e;Recorder.prototype.enc_mp3={stable:!0,testmsg:"48000, 44100, 32000, 24000, 22050, 16000, 12000, 11025, 8000"},Recorder.prototype.mp3=function(e,t,o){var l=this.set,c=e.length,f=this.mp3_start(l);if(f)return this.mp3_encode(f,e),void this.mp3_complete(f,t,o,1);var _=new Recorder.lamejs.Mp3Encoder(1,l.sampleRate,l.bitRate),data=[],h=0,d=0,m=function(){if(h<c){(o=_.encodeBuffer(e.subarray(h,h+57600))).length>0&&(d+=o.buffer.byteLength,data.push(o.buffer)),h+=57600,setTimeout(m)}else{var o;(o=_.flush()).length>0&&(d+=o.buffer.byteLength,data.push(o.buffer));var meta=n.fn(data,d,c,l.sampleRate);r(meta,l),t(new Blob(data,{type:"audio/mp3"}))}};m()},Recorder.BindDestroy("mp3Worker",(function(){console.log("mp3Worker Destroy"),e&&e.terminate(),e=null}));var t={id:0};Recorder.prototype.mp3_start=function(r){var o=e;try{if(!o){var l=");wk_lame();var wk_ctxs={};self.onmessage="+function(e){var t=e.data,n=wk_ctxs[t.id];if("init"==t.action)wk_ctxs[t.id]={sampleRate:t.sampleRate,bitRate:t.bitRate,mp3Size:0,pcmSize:0,encArr:[],encObj:new wk_lame.Mp3Encoder(1,t.sampleRate,t.bitRate)};else if(!n)return;switch(t.action){case"stop":n.encObj=null,delete wk_ctxs[t.id];break;case"encode":n.pcmSize+=t.pcm.length,(r=n.encObj.encodeBuffer(t.pcm)).length>0&&(n.mp3Size+=r.buffer.byteLength,n.encArr.push(r.buffer));break;case"complete":var r;(r=n.encObj.flush()).length>0&&(n.mp3Size+=r.buffer.byteLength,n.encArr.push(r.buffer));var meta=wk_mp3TrimFix.fn(n.encArr,n.mp3Size,n.pcmSize,n.sampleRate);self.postMessage({action:t.action,id:t.id,blob:new Blob(n.encArr,{type:"audio/mp3"}),meta:meta})}};l+=";var wk_mp3TrimFix={rm:"+n.rm+",fn:"+n.fn+"}";var c=Recorder.lamejs.toString(),f=(window.URL||webkitURL).createObjectURL(new Blob(["var wk_lame=(",c,l],{type:"text/javascript"}));o=new Worker(f),(window.URL||webkitURL).revokeObjectURL(f),o.onmessage=function(e){var n=t[e.data.id];n&&(n.call&&n.call(e.data),n.call=null)}}var _={worker:o,set:r};return _.id=++t.id,t[_.id]=_,o.postMessage({action:"init",id:_.id,sampleRate:r.sampleRate,bitRate:r.bitRate,x:new Int16Array(5)}),e=o,_}catch(e){return o&&o.terminate(),console.error(e),null}},Recorder.prototype.mp3_stop=function(e){if(e&&e.worker){e.worker.postMessage({action:"stop",id:e.id}),e.worker=null,delete t[e.id];var n=-1;for(var r in t)n++;n&&console.warn("mp3 worker"+n+"")}},Recorder.prototype.mp3_encode=function(e,t){e&&e.worker&&e.worker.postMessage({action:"encode",id:e.id,pcm:t})},Recorder.prototype.mp3_complete=function(e,t,n,o){var l=this;e&&e.worker?(e.call=function(data){r(data.meta,e.set),t(data.blob),o&&l.mp3_stop(e)},e.worker.postMessage({action:"complete",id:e.id})):n("mp3")},Recorder.mp3ReadMeta=function(e,t){var n=new Uint8Array(e[0]||[]);if(n.length<4)return null;var r=function(e,t){return("0000000"+((t||n)[e]||0).toString(2)).substr(-8)},o=r(0)+r(1),l=r(2)+r(3);if(!/^1{11}/.test(o))return null;var c={"00":2.5,10:2,11:1}[o.substr(11,2)],f={"01":3}[o.substr(13,2)],_={1:[44100,48e3,32e3],2:[22050,24e3,16e3],2.5:[11025,12e3,8e3]}[c];_&&(_=_[parseInt(l.substr(4,2),2)]);var h=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320]][1==c?1:0][parseInt(l.substr(0,4),2)];if(!(c&&f&&h&&_))return null;for(var d=Math.round(8*t/h),m=1==f?384:2==f?1152:1==c?1152:576,v=m/_*1e3,y=Math.floor(m*h/8/_*1e3),w=0,k=0,i=0;i<e.length;i++){var S=e[i];if((k+=S.byteLength)>=y+3){var M=new Uint8Array(S);w="1"==r(S.byteLength-(k-(y+3)+1),M).charAt(6);break}}return w&&y++,{version:c,layer:f,sampleRate:_,bitRate:h,duration:d,size:t,hasPadding:w,frameSize:y,frameDurationFloat:v}};var n={rm:Recorder.mp3ReadMeta,fn:function(e,t,n,r){var meta=this.rm(e,t);if(!meta)return{err:"mp3"};var o=Math.round(n/r*1e3),l=Math.floor((meta.duration-o)/meta.frameDurationFloat);if(l>0){var c=l*meta.frameSize-(meta.hasPadding?1:0);t-=c;for(var f=0,_=[],i=0;i<e.length;i++){var h=e[i];if(c<=0)break;c>=h.byteLength?(c-=h.byteLength,_.push(h),e.splice(i,1),i--):(e[i]=h.slice(c),f=h,c=0)}if(!this.rm(e,t)){f&&(e[0]=f);for(i=0;i<_.length;i++)e.splice(i,0,_[i]);meta.err="fix"}var d=meta.trimFix={};d.remove=l,d.removeDuration=Math.round(l*meta.frameDurationFloat),d.duration=Math.round(8*t/meta.bitRate)}return meta}},r=function(meta,e){var t="MP3 ";(meta.sampleRate&&meta.sampleRate!=e.sampleRate||meta.bitRate&&meta.bitRate!=e.bitRate)&&(console.warn(t+"set:"+e.bitRate+"kbps "+e.sampleRate+"hzset:"+meta.bitRate+"kbps "+meta.sampleRate+"hz",e),e.sampleRate=meta.sampleRate,e.bitRate=meta.bitRate);var n=meta.trimFix;n?(t+="Fix"+n.remove+""+n.removeDuration+"ms -> "+n.duration+"ms",n.remove>2&&(meta.err=(meta.err?meta.err+", ":"")+"")):t+=(meta.duration||"-")+"ms",meta.err?console.error(t,meta.err,meta):console.log(t,meta)}}()},656:function(e,t){!function(){"use strict";function e(){var t=function(s){return Math.log(s)/Math.log(10)};function n(e){return new Int8Array(e)}function r(e){return new Int16Array(e)}function o(e){return new Int32Array(e)}function l(e){return new Float32Array(e)}function c(e){return new Float64Array(e)}function f(e){if(1==e.length)return l(e[0]);var t=e[0];e=e.slice(1);for(var n=[],i=0;i<t;i++)n.push(f(e));return n}function _(e){if(1==e.length)return o(e[0]);var t=e[0];e=e.slice(1);for(var n=[],i=0;i<t;i++)n.push(_(e));return n}function h(e){if(1==e.length)return r(e[0]);var t=e[0];e=e.slice(1);for(var n=[],i=0;i<t;i++)n.push(h(e));return n}function d(e){if(1==e.length)return new Array(e[0]);var t=e[0];e=e.slice(1);for(var n=[],i=0;i<t;i++)n.push(d(e));return n}var m={fill:function(a,e,t,n){if(2==arguments.length)for(var i=0;i<a.length;i++)a[i]=arguments[1];else for(i=e;i<t;i++)a[i]=n}},v={arraycopy:function(e,t,n,r,o){for(var l=t+o;t<l;)n[r++]=e[t++]}},y={};function w(e){this.ordinal=e}y.SQRT2=1.4142135623730951,y.FAST_LOG10=function(e){return t(e)},y.FAST_LOG10_X=function(e,n){return t(e)*n},w.short_block_allowed=new w(0),w.short_block_coupled=new w(1),w.short_block_dispensed=new w(2),w.short_block_forced=new w(3);var k={};function S(e){this.ordinal=e}k.MAX_VALUE=34028235e31,S.vbr_off=new S(0),S.vbr_mt=new S(1),S.vbr_rh=new S(2),S.vbr_abr=new S(3),S.vbr_mtrh=new S(4),S.vbr_default=S.vbr_mtrh;function M(e){var t=e;this.ordinal=function(){return t}}function R(){this.getLameVersion=function(){return"3.98.4"},this.getLameShortVersion=function(){return"3.98.4"},this.getLameVeryShortVersion=function(){return"LAME3.98r"},this.getPsyVersion=function(){return"0.93"},this.getLameUrl=function(){return"http://www.mp3dev.org/"},this.getLameOsBitness=function(){return"32bits"}}function x(){var e=null;function t(b){this.bits=0|b}this.qupvt=null,this.setModules=function(t){this.qupvt=t,e=t};var n=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]];function r(e,t,n,r,o,l){var c=.5946/t;for(e>>=1;0!=e--;)o[l++]=c>n[r++]?0:1,o[l++]=c>n[r++]?0:1}function l(t,n,r,o,l,c){var f=(t>>=1)%2;for(t>>=1;0!=t--;){var _,h,d,m,v,y,w,k;_=r[o++]*n,h=r[o++]*n,v=0|_,d=r[o++]*n,y=0|h,m=r[o++]*n,w=0|d,_+=e.adj43[v],k=0|m,h+=e.adj43[y],l[c++]=0|_,d+=e.adj43[w],l[c++]=0|h,m+=e.adj43[k],l[c++]=0|d,l[c++]=0|m}0!=f&&(v=0|(_=r[o++]*n),y=0|(h=r[o++]*n),_+=e.adj43[v],h+=e.adj43[y],l[c++]=0|_,l[c++]=0|h)}var c=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];function f(e,t,n,s){var r=function(e,t,n){var r=0,o=0;do{var l=e[t++],c=e[t++];r<l&&(r=l),o<c&&(o=c)}while(t<n);return r<o&&(r=o),r}(e,t,n);switch(r){case 0:return r;case 1:return function(e,t,n,s){var r=0,o=C.ht[1].hlen;do{var l=2*e[t+0]+e[t+1];t+=2,r+=o[l]}while(t<n);return s.bits+=r,1}(e,t,n,s);case 2:case 3:return function(e,t,n,r,s){var o,l,c=0,f=C.ht[r].xlen;l=2==r?C.table23:C.table56;do{var _=e[t+0]*f+e[t+1];t+=2,c+=l[_]}while(t<n);return o=65535&c,(c>>=16)>o&&(c=o,r++),s.bits+=c,r}(e,t,n,c[r-1],s);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return function(e,t,n,r,s){var o=0,l=0,c=0,f=C.ht[r].xlen,_=C.ht[r].hlen,h=C.ht[r+1].hlen,d=C.ht[r+2].hlen;do{var m=e[t+0]*f+e[t+1];t+=2,o+=_[m],l+=h[m],c+=d[m]}while(t<n);var v=r;return o>l&&(o=l,v++),o>c&&(o=c,v=r+2),s.bits+=o,v}(e,t,n,c[r-1],s);default:if(r>X.IXMAX_VAL)return s.bits=X.LARGE_BITS,-1;var o,l;for(r-=15,o=24;o<32&&!(C.ht[o].linmax>=r);o++);for(l=o-8;l<24&&!(C.ht[l].linmax>=r);l++);return function(e,t,n,r,o,s){var l,c=65536*C.ht[r].xlen+C.ht[o].xlen,f=0;do{var _=e[t++],h=e[t++];0!=_&&(_>14&&(_=15,f+=c),_*=16),0!=h&&(h>14&&(h=15,f+=c),_+=h),f+=C.largetbl[_]}while(t<n);return l=65535&f,(f>>=16)>l&&(f=l,r=o),s.bits+=f,r}(e,t,n,l,o,s)}}function _(e,n,r,o,l,c,_,h){for(var d=n.big_values,m=2;m<U.SBMAX_l+1;m++){var v=e.scalefac_band.l[m];if(v>=d)break;var y=l[m-2]+n.count1bits;if(r.part2_3_length<=y)break;var w=new t(y),k=f(o,v,d,w);y=w.bits,r.part2_3_length<=y||(r.assign(n),r.part2_3_length=y,r.region0_count=c[m-2],r.region1_count=m-2-c[m-2],r.table_select[0]=_[m-2],r.table_select[1]=h[m-2],r.table_select[2]=k)}}this.noquant_count_bits=function(e,n,r){var o=n.l3_enc,i=Math.min(576,n.max_nonzero_coeff+2>>1<<1);for(null!=r&&(r.sfb_count1=0);i>1&&0==(o[i-1]|o[i-2]);i-=2);n.count1=i;for(var l=0,c=0;i>3;i-=4){var p;if((2147483647&(o[i-1]|o[i-2]|o[i-3]|o[i-4]))>1)break;p=2*(2*(2*o[i-4]+o[i-3])+o[i-2])+o[i-1],l+=C.t32l[p],c+=C.t33l[p]}var _=l;if(n.count1table_select=0,l>c&&(_=c,n.count1table_select=1),n.count1bits=_,n.big_values=i,0==i)return _;if(n.block_type==U.SHORT_TYPE)(l=3*e.scalefac_band.s[3])>n.big_values&&(l=n.big_values),c=n.big_values;else if(n.block_type==U.NORM_TYPE){if(l=n.region0_count=e.bv_scf[i-2],c=n.region1_count=e.bv_scf[i-1],c=e.scalefac_band.l[l+c+2],l=e.scalefac_band.l[l+1],c<i){var h=new t(_);n.table_select[2]=f(o,c,i,h),_=h.bits}}else n.region0_count=7,n.region1_count=U.SBMAX_l-1-7-1,(l=e.scalefac_band.l[8])>(c=i)&&(l=c);if(l=Math.min(l,i),c=Math.min(c,i),0<l){h=new t(_);n.table_select[0]=f(o,0,l,h),_=h.bits}if(l<c){h=new t(_);n.table_select[1]=f(o,l,c,h),_=h.bits}if(2==e.use_best_huffman&&(n.part2_3_length=_,best_huffman_divide(e,n),_=n.part2_3_length),null!=r&&n.block_type==U.NORM_TYPE){for(var d=0;e.scalefac_band.l[d]<n.big_values;)d++;r.sfb_count1=d}return _},this.count_bits=function(t,n,o,c){var f=o.l3_enc,_=X.IXMAX_VAL/e.IPOW20(o.global_gain);if(o.xrpow_max>_)return X.LARGE_BITS;if(function(t,n,o,c,f){var _,h,d,v=0,y=0,w=0,k=0,S=n,M=0,R=S,x=0,P=t,E=0;for(d=null!=f&&c.global_gain==f.global_gain,h=c.block_type==U.SHORT_TYPE?38:21,_=0;_<=h;_++){var A=-1;if((d||c.block_type==U.NORM_TYPE)&&(A=c.global_gain-(c.scalefac[_]+(0!=c.preflag?e.pretab[_]:0)<<c.scalefac_scale+1)-8*c.subblock_gain[c.window[_]]),d&&f.step[_]==A)0!=y&&(l(y,o,P,E,R,x),y=0),0!=w&&(r(w,o,P,E,R,x),w=0);else{var T,B=c.width[_];if(v+c.width[_]>c.max_nonzero_coeff)T=c.max_nonzero_coeff-v+1,m.fill(n,c.max_nonzero_coeff,576,0),(B=T)<0&&(B=0),_=h+1;if(0==y&&0==w&&(R=S,x=M,P=t,E=k),null!=f&&f.sfb_count1>0&&_>=f.sfb_count1&&f.step[_]>0&&A>=f.step[_]?(0!=y&&(l(y,o,P,E,R,x),y=0,R=S,x=M,P=t,E=k),w+=B):(0!=w&&(r(w,o,P,E,R,x),w=0,R=S,x=M,P=t,E=k),y+=B),B<=0){0!=w&&(r(w,o,P,E,R,x),w=0),0!=y&&(l(y,o,P,E,R,x),y=0);break}}_<=h&&(M+=c.width[_],k+=c.width[_],v+=c.width[_])}0!=y&&(l(y,o,P,E,R,x),y=0),0!=w&&(r(w,o,P,E,R,x),w=0)}(n,f,e.IPOW20(o.global_gain),o,c),0!=(2&t.substep_shaping))for(var h=0,d=o.global_gain+o.scalefac_scale,v=.634521682242439/e.IPOW20(d),y=0;y<o.sfbmax;y++){var w,k=o.width[y];if(0==t.pseudohalf[y])h+=k;else for(w=h,h+=k;w<h;++w)f[w]=n[w]>=v?f[w]:0}return this.noquant_count_bits(t,o,c)},this.best_huffman_divide=function(e,n){var r=new W,l=n.l3_enc,c=o(23),h=o(23),d=o(23),m=o(23);if(n.block_type!=U.SHORT_TYPE||1!=e.mode_gr){r.assign(n),n.block_type==U.NORM_TYPE&&(!function(e,n,r,o,l,c,_){for(var h=n.big_values,d=0;d<=22;d++)o[d]=X.LARGE_BITS;for(d=0;d<16;d++){var m=e.scalefac_band.l[d+1];if(m>=h)break;var v=0,y=new t(v),w=f(r,0,m,y);v=y.bits;for(var k=0;k<8;k++){var S=e.scalefac_band.l[d+k+2];if(S>=h)break;var M=v,R=f(r,m,S,y=new t(M));M=y.bits,o[d+k]>M&&(o[d+k]=M,l[d+k]=d,c[d+k]=w,_[d+k]=R)}}}(e,n,l,c,h,d,m),_(e,r,n,l,c,h,d,m));var i=r.big_values;if(!(0==i||(l[i-2]|l[i-1])>1||(i=n.count1+2)>576)){r.assign(n),r.count1=i;for(var v=0,y=0;i>r.big_values;i-=4){var p=2*(2*(2*l[i-4]+l[i-3])+l[i-2])+l[i-1];v+=C.t32l[p],y+=C.t33l[p]}if(r.big_values=i,r.count1table_select=0,v>y&&(v=y,r.count1table_select=1),r.count1bits=v,r.block_type==U.NORM_TYPE)_(e,r,n,l,c,h,d,m);else{if(r.part2_3_length=v,(v=e.scalefac_band.l[8])>i&&(v=i),v>0){var w=new t(r.part2_3_length);r.table_select[0]=f(l,0,v,w),r.part2_3_length=w.bits}if(i>v){w=new t(r.part2_3_length);r.table_select[1]=f(l,v,i,w),r.part2_3_length=w.bits}n.part2_3_length>r.part2_3_length&&n.assign(r)}}}};var h=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],d=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],y=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],w=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];x.slen1_tab=y,x.slen2_tab=w,this.best_scalefac_store=function(t,n,r,o){var l,i,c,f,_=o.tt[n][r],m=0;for(c=0,l=0;l<_.sfbmax;l++){var v=_.width[l];for(c+=v,f=-v;f<0&&0==_.l3_enc[f+c];f++);0==f&&(_.scalefac[l]=m=-2)}if(0==_.scalefac_scale&&0==_.preflag){var s=0;for(l=0;l<_.sfbmax;l++)_.scalefac[l]>0&&(s|=_.scalefac[l]);if(0==(1&s)&&0!=s){for(l=0;l<_.sfbmax;l++)_.scalefac[l]>0&&(_.scalefac[l]>>=1);_.scalefac_scale=m=1}}if(0==_.preflag&&_.block_type!=U.SHORT_TYPE&&2==t.mode_gr){for(l=11;l<U.SBPSY_l&&!(_.scalefac[l]<e.pretab[l]&&-2!=_.scalefac[l]);l++);if(l==U.SBPSY_l){for(l=11;l<U.SBPSY_l;l++)_.scalefac[l]>0&&(_.scalefac[l]-=e.pretab[l]);_.preflag=m=1}}for(i=0;i<4;i++)o.scfsi[r][i]=0;for(2==t.mode_gr&&1==n&&o.tt[0][r].block_type!=U.SHORT_TYPE&&o.tt[1][r].block_type!=U.SHORT_TYPE&&(!function(e,t){for(var n,r=t.tt[1][e],o=t.tt[0][e],i=0;i<C.scfsi_band.length-1;i++){for(n=C.scfsi_band[i];n<C.scfsi_band[i+1]&&!(o.scalefac[n]!=r.scalefac[n]&&r.scalefac[n]>=0);n++);if(n==C.scfsi_band[i+1]){for(n=C.scfsi_band[i];n<C.scfsi_band[i+1];n++)r.scalefac[n]=-1;t.scfsi[e][i]=1}}var l=0,c=0;for(n=0;n<11;n++)-1!=r.scalefac[n]&&(c++,l<r.scalefac[n]&&(l=r.scalefac[n]));for(var f=0,_=0;n<U.SBPSY_l;n++)-1!=r.scalefac[n]&&(_++,f<r.scalefac[n]&&(f=r.scalefac[n]));for(i=0;i<16;i++)if(l<h[i]&&f<d[i]){var m=y[i]*c+w[i]*_;r.part2_length>m&&(r.part2_length=m,r.scalefac_compress=i)}}(r,o),m=0),l=0;l<_.sfbmax;l++)-2==_.scalefac[l]&&(_.scalefac[l]=0);0!=m&&(2==t.mode_gr?this.scale_bitcount(_):this.scale_bitcount_lsf(t,_))};var k=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],S=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],M=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(t){var n,r,o,l=0,c=0,f=t.scalefac;if(t.block_type==U.SHORT_TYPE)o=k,0!=t.mixed_block_flag&&(o=S);else if(o=M,0==t.preflag){for(r=11;r<U.SBPSY_l&&!(f[r]<e.pretab[r]);r++);if(r==U.SBPSY_l)for(t.preflag=1,r=11;r<U.SBPSY_l;r++)f[r]-=e.pretab[r]}for(r=0;r<t.sfbdivide;r++)l<f[r]&&(l=f[r]);for(;r<t.sfbmax;r++)c<f[r]&&(c=f[r]);for(t.part2_length=X.LARGE_BITS,n=0;n<16;n++)l<h[n]&&c<d[n]&&t.part2_length>o[n]&&(t.part2_length=o[n],t.scalefac_compress=n);return t.part2_length==X.LARGE_BITS};var R=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(t,n){var r,l,c,f,_,h,i,d,m=o(4),y=n.scalefac;for(r=0!=n.preflag?2:0,i=0;i<4;i++)m[i]=0;if(n.block_type==U.SHORT_TYPE){l=1;var w=e.nr_of_sfb_block[r][l];for(d=0,c=0;c<4;c++)for(f=w[c]/3,i=0;i<f;i++,d++)for(_=0;_<3;_++)y[3*d+_]>m[c]&&(m[c]=y[3*d+_])}else{l=0;w=e.nr_of_sfb_block[r][l];for(d=0,c=0;c<4;c++)for(f=w[c],i=0;i<f;i++,d++)y[d]>m[c]&&(m[c]=y[d])}for(h=!1,c=0;c<4;c++)m[c]>R[r][c]&&(h=!0);if(!h){var k,S,M,x;for(n.sfb_partition_table=e.nr_of_sfb_block[r][l],c=0;c<4;c++)n.slen[c]=P[m[c]];switch(k=n.slen[0],S=n.slen[1],M=n.slen[2],x=n.slen[3],r){case 0:n.scalefac_compress=(5*k+S<<4)+(M<<2)+x;break;case 1:n.scalefac_compress=400+(5*k+S<<2)+M;break;case 2:n.scalefac_compress=500+3*k+S;break;default:v.err.printf("intensity stereo not implemented yet\n")}}if(!h)for(n.part2_length=0,c=0;c<4;c++)n.part2_length+=n.slen[c]*n.sfb_partition_table[c];return h};var P=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(e){for(var i=2;i<=576;i+=2){for(var t,r=0;e.scalefac_band.l[++r]<i;);for(t=n[r][0];e.scalefac_band.l[t+1]>i;)t--;for(t<0&&(t=n[r][0]),e.bv_scf[i-2]=t,t=n[r][1];e.scalefac_band.l[t+e.bv_scf[i-2]+2]>i;)t--;t<0&&(t=n[r][1]),e.bv_scf[i-1]=t}}}function P(){}function E(){function e(e,t,n,r,o,l,c,f,_,h,d,m,v,y,w){this.vbr_q=e,this.quant_comp=t,this.quant_comp_s=n,this.expY=r,this.st_lrm=o,this.st_s=l,this.masking_adj=c,this.masking_adj_short=f,this.ath_lower=_,this.ath_curve=h,this.ath_sensitivity=d,this.interch=m,this.safejoint=v,this.sfb21mod=y,this.msfix=w}function t(e,t,n,r,o,l,c,f,_,mask,h,d,m,v){this.quant_comp=t,this.quant_comp_s=n,this.safejoint=r,this.nsmsfix=o,this.st_lrm=l,this.st_s=c,this.nsbass=f,this.scale=_,this.masking_adj=mask,this.ath_lower=h,this.ath_curve=d,this.interch=m,this.sfscale=v}var n;this.setModules=function(e){n=e};var r=[new e(0,9,9,0,5.2,125,-4.2,-6.3,4.8,1,0,0,2,21,.97),new e(1,9,9,0,5.3,125,-3.6,-5.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,5.6,125,-2.2,-3.5,2.8,2,0,0,2,21,1.49),new e(3,9,9,1,5.8,130,-1.8,-2.8,2.6,3,-4,0,2,20,1.64),new e(4,9,9,1,6,135,-.7,-1.1,1.1,3.5,-8,0,2,0,1.79),new e(5,9,9,1,6.4,140,.5,.4,-7.5,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,6.6,145,.67,.65,-14.7,6.5,-19,4e-4,0,0,2.3),new e(7,9,9,1,6.6,145,.8,.75,-19.7,8,-22,6e-4,0,0,2.7),new e(8,9,9,1,6.6,145,1.2,1.15,-27.5,10,-23,7e-4,0,0,0),new e(9,9,9,1,6.6,145,1.6,1.6,-36,11,-25,8e-4,0,0,0),new e(10,9,9,1,6.6,145,2,2,-36,12,-25,8e-4,0,0,0)],o=[new e(0,9,9,0,4.2,25,-7,-4,7.5,1,0,0,2,26,.97),new e(1,9,9,0,4.2,25,-5.6,-3.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,4.2,25,-4.4,-1.8,2,2,0,0,2,18,1.49),new e(3,9,9,1,4.2,25,-3.4,-1.25,1.1,3,-4,0,2,15,1.64),new e(4,9,9,1,4.2,25,-2.2,.1,0,3.5,-8,0,2,0,1.79),new e(5,9,9,1,4.2,25,-1,1.65,-7.7,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,4.2,25,-0,2.47,-7.7,6.5,-19,4e-4,0,0,2),new e(7,9,9,1,4.2,25,.5,2,-14.5,8,-22,6e-4,0,0,2),new e(8,9,9,1,4.2,25,1,2.4,-22,10,-23,7e-4,0,0,2),new e(9,9,9,1,4.2,25,1.5,2.95,-30,11,-25,8e-4,0,0,2),new e(10,9,9,1,4.2,25,2,2.95,-36,12,-30,8e-4,0,0,2)];function l(e,a,t){var n=e.VBR==S.vbr_rh?r:o,l=e.VBR_q_frac,p=n[a],q=n[a+1],c=p;p.st_lrm=p.st_lrm+l*(q.st_lrm-p.st_lrm),p.st_s=p.st_s+l*(q.st_s-p.st_s),p.masking_adj=p.masking_adj+l*(q.masking_adj-p.masking_adj),p.masking_adj_short=p.masking_adj_short+l*(q.masking_adj_short-p.masking_adj_short),p.ath_lower=p.ath_lower+l*(q.ath_lower-p.ath_lower),p.ath_curve=p.ath_curve+l*(q.ath_curve-p.ath_curve),p.ath_sensitivity=p.ath_sensitivity+l*(q.ath_sensitivity-p.ath_sensitivity),p.interch=p.interch+l*(q.interch-p.interch),p.msfix=p.msfix+l*(q.msfix-p.msfix),function(e,t){var n=0;0>t&&(n=-1,t=0);9<t&&(n=-1,t=9);e.VBR_q=t,e.VBR_q_frac=0}(e,c.vbr_q),0!=t?e.quant_comp=c.quant_comp:Math.abs(e.quant_comp- -1)>0||(e.quant_comp=c.quant_comp),0!=t?e.quant_comp_short=c.quant_comp_s:Math.abs(e.quant_comp_short- -1)>0||(e.quant_comp_short=c.quant_comp_s),0!=c.expY&&(e.experimentalY=0!=c.expY),0!=t?e.internal_flags.nsPsy.attackthre=c.st_lrm:Math.abs(e.internal_flags.nsPsy.attackthre- -1)>0||(e.internal_flags.nsPsy.attackthre=c.st_lrm),0!=t?e.internal_flags.nsPsy.attackthre_s=c.st_s:Math.abs(e.internal_flags.nsPsy.attackthre_s- -1)>0||(e.internal_flags.nsPsy.attackthre_s=c.st_s),0!=t?e.maskingadjust=c.masking_adj:Math.abs(e.maskingadjust-0)>0||(e.maskingadjust=c.masking_adj),0!=t?e.maskingadjust_short=c.masking_adj_short:Math.abs(e.maskingadjust_short-0)>0||(e.maskingadjust_short=c.masking_adj_short),0!=t?e.ATHlower=-c.ath_lower/10:Math.abs(10*-e.ATHlower-0)>0||(e.ATHlower=-c.ath_lower/10),0!=t?e.ATHcurve=c.ath_curve:Math.abs(e.ATHcurve- -1)>0||(e.ATHcurve=c.ath_curve),0!=t?e.athaa_sensitivity=c.ath_sensitivity:Math.abs(e.athaa_sensitivity- -1)>0||(e.athaa_sensitivity=c.ath_sensitivity),c.interch>0&&(0!=t?e.interChRatio=c.interch:Math.abs(e.interChRatio- -1)>0||(e.interChRatio=c.interch)),c.safejoint>0&&(e.exp_nspsytune=e.exp_nspsytune|c.safejoint),c.sfb21mod>0&&(e.exp_nspsytune=e.exp_nspsytune|c.sfb21mod<<20),0!=t?e.msfix=c.msfix:Math.abs(e.msfix- -1)>0||(e.msfix=c.msfix),0==t&&(e.VBR_q=a,e.VBR_q_frac=l)}var c=[new t(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new t(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new t(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new t(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new t(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new t(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new t(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new t(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new t(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new t(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new t(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new t(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new t(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new t(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new t(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];function f(e,t,r){var o=t,l=n.nearestBitrateFullIndex(t);if(e.VBR=S.vbr_abr,e.VBR_mean_bitrate_kbps=o,e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,320),e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,8),e.brate=e.VBR_mean_bitrate_kbps,e.VBR_mean_bitrate_kbps>320&&(e.disable_reservoir=!0),c[l].safejoint>0&&(e.exp_nspsytune=2|e.exp_nspsytune),c[l].sfscale>0&&(e.internal_flags.noise_shaping=2),Math.abs(c[l].nsbass)>0){var f=int(4*c[l].nsbass);f<0&&(f+=64),e.exp_nspsytune=e.exp_nspsytune|f<<2}return 0!=r?e.quant_comp=c[l].quant_comp:Math.abs(e.quant_comp- -1)>0||(e.quant_comp=c[l].quant_comp),0!=r?e.quant_comp_short=c[l].quant_comp_s:Math.abs(e.quant_comp_short- -1)>0||(e.quant_comp_short=c[l].quant_comp_s),0!=r?e.msfix=c[l].nsmsfix:Math.abs(e.msfix- -1)>0||(e.msfix=c[l].nsmsfix),0!=r?e.internal_flags.nsPsy.attackthre=c[l].st_lrm:Math.abs(e.internal_flags.nsPsy.attackthre- -1)>0||(e.internal_flags.nsPsy.attackthre=c[l].st_lrm),0!=r?e.internal_flags.nsPsy.attackthre_s=c[l].st_s:Math.abs(e.internal_flags.nsPsy.attackthre_s- -1)>0||(e.internal_flags.nsPsy.attackthre_s=c[l].st_s),0!=r?e.scale=c[l].scale:Math.abs(e.scale- -1)>0||(e.scale=c[l].scale),0!=r?e.maskingadjust=c[l].masking_adj:Math.abs(e.maskingadjust-0)>0||(e.maskingadjust=c[l].masking_adj),c[l].masking_adj>0?0!=r?e.maskingadjust_short=.9*c[l].masking_adj:Math.abs(e.maskingadjust_short-0)>0||(e.maskingadjust_short=.9*c[l].masking_adj):0!=r?e.maskingadjust_short=1.1*c[l].masking_adj:Math.abs(e.maskingadjust_short-0)>0||(e.maskingadjust_short=1.1*c[l].masking_adj),0!=r?e.ATHlower=-c[l].ath_lower/10:Math.abs(10*-e.ATHlower-0)>0||(e.ATHlower=-c[l].ath_lower/10),0!=r?e.ATHcurve=c[l].ath_curve:Math.abs(e.ATHcurve- -1)>0||(e.ATHcurve=c[l].ath_curve),0!=r?e.interChRatio=c[l].interch:Math.abs(e.interChRatio- -1)>0||(e.interChRatio=c[l].interch),t}this.apply_preset=function(e,t,n){switch(t){case re.R3MIX:t=re.V3,e.VBR=S.vbr_mtrh;break;case re.MEDIUM:t=re.V4,e.VBR=S.vbr_rh;break;case re.MEDIUM_FAST:t=re.V4,e.VBR=S.vbr_mtrh;break;case re.STANDARD:t=re.V2,e.VBR=S.vbr_rh;break;case re.STANDARD_FAST:t=re.V2,e.VBR=S.vbr_mtrh;break;case re.EXTREME:t=re.V0,e.VBR=S.vbr_rh;break;case re.EXTREME_FAST:t=re.V0,e.VBR=S.vbr_mtrh;break;case re.INSANE:return t=320,e.preset=t,f(e,t,n),e.VBR=S.vbr_off,t}switch(e.preset=t,t){case re.V9:return l(e,9,n),t;case re.V8:return l(e,8,n),t;case re.V7:return l(e,7,n),t;case re.V6:return l(e,6,n),t;case re.V5:return l(e,5,n),t;case re.V4:return l(e,4,n),t;case re.V3:return l(e,3,n),t;case re.V2:return l(e,2,n),t;case re.V1:return l(e,1,n),t;case re.V0:return l(e,0,n),t}return 8<=t&&t<=320?f(e,t,n):(e.preset=0,t)}}function A(){var e;this.setModules=function(t){e=t},this.ResvFrameBegin=function(t,n){var r,o=t.internal_flags,l=o.l3_side,c=e.getframebits(t);n.bits=(c-8*o.sideinfo_len)/o.mode_gr;var f=2048*o.mode_gr-8;t.brate>320?r=8*int(1e3*t.brate/(t.out_samplerate/1152)/8+.5):(r=11520,t.strict_ISO&&(r=8*int(32e4/(t.out_samplerate/1152)/8+.5))),o.ResvMax=r-c,o.ResvMax>f&&(o.ResvMax=f),(o.ResvMax<0||t.disable_reservoir)&&(o.ResvMax=0);var _=n.bits*o.mode_gr+Math.min(o.ResvSize,o.ResvMax);return _>r&&(_=r),l.resvDrain_pre=0,null!=o.pinfo&&(o.pinfo.mean_bits=n.bits/2,o.pinfo.resvsize=o.ResvSize),_},this.ResvMaxBits=function(e,t,n,r){var o,l=e.internal_flags,c=l.ResvSize,f=l.ResvMax;0!=r&&(c+=t),0!=(1&l.substep_shaping)&&(f*=.9),n.bits=t,10*c>9*f?(o=c-9*f/10,n.bits+=o,l.substep_shaping|=128):(o=0,l.substep_shaping&=127,e.disable_reservoir||0!=(1&l.substep_shaping)||(n.bits-=.1*t));var _=c<6*l.ResvMax/10?c:6*l.ResvMax/10;return(_-=o)<0&&(_=0),_},this.ResvAdjust=function(e,t){e.ResvSize-=t.part2_3_length+t.part2_length},this.ResvFrameEnd=function(e,t){var n,r=e.l3_side;e.ResvSize+=t*e.mode_gr;var o=0;r.resvDrain_post=0,r.resvDrain_pre=0,0!=(n=e.ResvSize%8)&&(o+=n),(n=e.ResvSize-o-e.ResvMax)>0&&(o+=n);var l=Math.min(8*r.main_data_begin,o)/8;r.resvDrain_pre+=8*l,o-=8*l,e.ResvSize-=8*l,r.main_data_begin-=l,r.resvDrain_post+=o,e.ResvSize-=o}}function T(){this.setModules=function(e,t,n){e,t,n};var e=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];function t(t,n){return n=n>>8^e[255&(n^t)]}this.updateMusicCRC=function(e,n,r,o){for(var i=0;i<o;++i)e[0]=t(n[r+i],e[0])}}function B(){var e=this,r=32773,l=null,c=null,_=null,h=null;this.setModules=function(e,t,n,r){l=e,c=t,_=n,h=r};var d=null,y=0,w=0,k=0;function S(e){v.arraycopy(e.header[e.w_ptr].buf,0,d,w,e.sideinfo_len),w+=e.sideinfo_len,y+=8*e.sideinfo_len,e.w_ptr=e.w_ptr+1&te.MAX_HEADER_BUF-1}function M(e,t,n){for(;n>0;){var r;0==k&&(k=8,w++,e.header[e.w_ptr].write_timing==y&&S(e),d[w]=0),n-=r=Math.min(n,k),k-=r,d[w]|=t>>n<<k,y+=r}}function R(e,t,n){for(;n>0;){var r;0==k&&(k=8,w++,d[w]=0),n-=r=Math.min(n,k),k-=r,d[w]|=t>>n<<k,y+=r}}function E(e,t){var i,n=e.internal_flags;if(t>=8&&(M(n,76,8),t-=8),t>=8&&(M(n,65,8),t-=8),t>=8&&(M(n,77,8),t-=8),t>=8&&(M(n,69,8),t-=8),t>=32){var r=_.getLameShortVersion();if(t>=32)for(i=0;i<r.length&&t>=8;++i)t-=8,M(n,r.charCodeAt(i),8)}for(;t>=1;t-=1)M(n,n.ancillary_flag,1),n.ancillary_flag^=e.disable_reservoir?0:1}function A(e,t,n){for(var r=e.header[e.h_ptr].ptr;n>0;){var o=Math.min(n,8-(7&r));n-=o,e.header[e.h_ptr].buf[r>>3]|=t>>n<<8-(7&r)-o,r+=o}e.header[e.h_ptr].ptr=r}function T(e,t){e<<=8;for(var i=0;i<8;i++)0!=(65536&((t<<=1)^(e<<=1)))&&(t^=r);return t}function B(e,t){var i,n=C.ht[t.count1table_select+32],r=0,o=t.big_values,l=t.big_values;for(i=(t.count1-t.big_values)/4;i>0;--i){var c=0,p=0;0!=t.l3_enc[o+0]&&(p+=8,t.xr[l+0]<0&&c++),0!=t.l3_enc[o+1]&&(p+=4,c*=2,t.xr[l+1]<0&&c++),0!=t.l3_enc[o+2]&&(p+=2,c*=2,t.xr[l+2]<0&&c++),0!=t.l3_enc[o+3]&&(p++,c*=2,t.xr[l+3]<0&&c++),o+=4,l+=4,M(e,c+n.table[p],n.hlen[p]),r+=n.hlen[p]}return r}function O(e,t,n,r,o){var l=C.ht[t],c=0;if(0==t)return c;for(var i=n;i<r;i+=2){var f=0,_=0,h=l.xlen,d=l.xlen,m=0,v=o.l3_enc[i],y=o.l3_enc[i+1];if(0!=v&&(o.xr[i]<0&&m++,f--),t>15){if(v>14)m|=v-15<<1,_=h,v=15;if(y>14)m<<=h,m|=y-15,_+=h,y=15;d=16}0!=y&&(m<<=1,o.xr[i+1]<0&&m++,f--),v=v*d+y,_-=f,f+=l.hlen[v],M(e,l.table[v],f),M(e,m,_),c+=f+_}return c}function j(e,t){var n=3*e.scalefac_band.s[3];n>t.big_values&&(n=t.big_values);var r=O(e,t.table_select[0],0,n,t);return r+=O(e,t.table_select[1],n,t.big_values,t)}function L(e,t){var n,r,o,l;n=t.big_values;var i=t.region0_count+1;return o=e.scalefac_band.l[i],i+=t.region1_count+1,o>n&&(o=n),(l=e.scalefac_band.l[i])>n&&(l=n),r=O(e,t.table_select[0],0,o,t),r+=O(e,t.table_select[1],o,l,t),r+=O(e,t.table_select[2],l,n,t)}function I(){this.total=0}function H(t,n){var r,o,l,c,f,_=t.internal_flags;return f=_.w_ptr,-1==(c=_.h_ptr-1)&&(c=te.MAX_HEADER_BUF-1),r=_.header[c].write_timing-y,n.total=r,r>=0&&(o=1+c-f,c<f&&(o=1+c-f+te.MAX_HEADER_BUF),r-=8*o*_.sideinfo_len),r+=l=e.getframebits(t),n.total+=l,n.total%8!=0?n.total=1+n.total/8:n.total=n.total/8,n.total+=w+1,r<0&&v.err.println("strange error flushing buffer ... \n"),r}this.getframebits=function(e){var t,n=e.internal_flags;return t=0!=n.bitrate_index?C.bitrate_table[e.version][n.bitrate_index]:e.brate,8*(0|72e3*(e.version+1)*t/e.out_samplerate+n.padding)},this.CRC_writeheader=function(e,header){var t=65535;t=T(255&header[2],t),t=T(255&header[3],t);for(var i=6;i<e.sideinfo_len;i++)t=T(255&header[i],t);header[4]=byte(t>>8),header[5]=byte(255&t)},this.flush_bitstream=function(e){var n,r,o=e.internal_flags,c=o.h_ptr-1;if(-1==c&&(c=te.MAX_HEADER_BUF-1),n=o.l3_side,!((r=H(e,new I))<0)){if(E(e,r),o.ResvSize=0,n.main_data_begin=0,o.findReplayGain){var f=l.GetTitleGain(o.rgdata);o.RadioGain=0|Math.floor(10*f+.5)}o.findPeakSample&&(o.noclipGainChange=0|Math.ceil(20*t(o.PeakSample/32767)*10),o.noclipGainChange>0&&(EQ(e.scale,1)||EQ(e.scale,0))?o.noclipScale=Math.floor(32767/o.PeakSample*100)/100:o.noclipScale=-1)}},this.add_dummy_byte=function(e,t,n){for(var i,r=e.internal_flags;n-- >0;)for(R(0,t,8),i=0;i<te.MAX_HEADER_BUF;++i)r.header[i].write_timing+=8},this.format_bitstream=function(e){var t,n=e.internal_flags;t=n.l3_side;var r=this.getframebits(e);E(e,t.resvDrain_pre),function(e,t){var n,r,o,l=e.internal_flags;if(n=l.l3_side,l.header[l.h_ptr].ptr=0,m.fill(l.header[l.h_ptr].buf,0,l.sideinfo_len,0),e.out_samplerate<16e3?A(l,4094,12):A(l,4095,12),A(l,e.version,1),A(l,1,2),A(l,e.error_protection?0:1,1),A(l,l.bitrate_index,4),A(l,l.samplerate_index,2),A(l,l.padding,1),A(l,e.extension,1),A(l,e.mode.ordinal(),2),A(l,l.mode_ext,2),A(l,e.copyright,1),A(l,e.original,1),A(l,e.emphasis,2),e.error_protection&&A(l,0,16),1==e.version){for(A(l,n.main_data_begin,9),2==l.channels_out?A(l,n.private_bits,3):A(l,n.private_bits,5),o=0;o<l.channels_out;o++){var c;for(c=0;c<4;c++)A(l,n.scfsi[o][c],1)}for(r=0;r<2;r++)for(o=0;o<l.channels_out;o++){A(l,(f=n.tt[r][o]).part2_3_length+f.part2_length,12),A(l,f.big_values/2,9),A(l,f.global_gain,8),A(l,f.scalefac_compress,4),f.block_type!=U.NORM_TYPE?(A(l,1,1),A(l,f.block_type,2),A(l,f.mixed_block_flag,1),14==f.table_select[0]&&(f.table_select[0]=16),A(l,f.table_select[0],5),14==f.table_select[1]&&(f.table_select[1]=16),A(l,f.table_select[1],5),A(l,f.subblock_gain[0],3),A(l,f.subblock_gain[1],3),A(l,f.subblock_gain[2],3)):(A(l,0,1),14==f.table_select[0]&&(f.table_select[0]=16),A(l,f.table_select[0],5),14==f.table_select[1]&&(f.table_select[1]=16),A(l,f.table_select[1],5),14==f.table_select[2]&&(f.table_select[2]=16),A(l,f.table_select[2],5),A(l,f.region0_count,4),A(l,f.region1_count,3)),A(l,f.preflag,1),A(l,f.scalefac_scale,1),A(l,f.count1table_select,1)}}else for(A(l,n.main_data_begin,8),A(l,n.private_bits,l.channels_out),r=0,o=0;o<l.channels_out;o++){var f;A(l,(f=n.tt[r][o]).part2_3_length+f.part2_length,12),A(l,f.big_values/2,9),A(l,f.global_gain,8),A(l,f.scalefac_compress,9),f.block_type!=U.NORM_TYPE?(A(l,1,1),A(l,f.block_type,2),A(l,f.mixed_block_flag,1),14==f.table_select[0]&&(f.table_select[0]=16),A(l,f.table_select[0],5),14==f.table_select[1]&&(f.table_select[1]=16),A(l,f.table_select[1],5),A(l,f.subblock_gain[0],3),A(l,f.subblock_gain[1],3),A(l,f.subblock_gain[2],3)):(A(l,0,1),14==f.table_select[0]&&(f.table_select[0]=16),A(l,f.table_select[0],5),14==f.table_select[1]&&(f.table_select[1]=16),A(l,f.table_select[1],5),14==f.table_select[2]&&(f.table_select[2]=16),A(l,f.table_select[2],5),A(l,f.region0_count,4),A(l,f.region1_count,3)),A(l,f.scalefac_scale,1),A(l,f.count1table_select,1)}e.error_protection&&CRC_writeheader(l,l.header[l.h_ptr].buf);var _=l.h_ptr;l.h_ptr=_+1&te.MAX_HEADER_BUF-1,l.header[l.h_ptr].write_timing=l.header[_].write_timing+t,l.h_ptr==l.w_ptr&&v.err.println("Error: MAX_HEADER_BUF too small in bitstream.c \n")}(e,r);var o=8*n.sideinfo_len;if(o+=function(e){var t,n,r,o,l=0,c=e.internal_flags,f=c.l3_side;if(1==e.version)for(t=0;t<2;t++)for(n=0;n<c.channels_out;n++){var _=f.tt[t][n],h=x.slen1_tab[_.scalefac_compress],d=x.slen2_tab[_.scalefac_compress];for(o=0,r=0;r<_.sfbdivide;r++)-1!=_.scalefac[r]&&(M(c,_.scalefac[r],h),o+=h);for(;r<_.sfbmax;r++)-1!=_.scalefac[r]&&(M(c,_.scalefac[r],d),o+=d);_.block_type==U.SHORT_TYPE?o+=j(c,_):o+=L(c,_),l+=o+=B(c,_)}else for(t=0,n=0;n<c.channels_out;n++){var i,m,v=0;if(o=0,r=0,m=0,(_=f.tt[t][n]).block_type==U.SHORT_TYPE){for(;m<4;m++){var y=_.sfb_partition_table[m]/3,w=_.slen[m];for(i=0;i<y;i++,r++)M(c,Math.max(_.scalefac[3*r+0],0),w),M(c,Math.max(_.scalefac[3*r+1],0),w),M(c,Math.max(_.scalefac[3*r+2],0),w),v+=3*w}o+=j(c,_)}else{for(;m<4;m++){y=_.sfb_partition_table[m],w=_.slen[m];for(i=0;i<y;i++,r++)M(c,Math.max(_.scalefac[r],0),w),v+=w}o+=L(c,_)}l+=v+(o+=B(c,_))}return l}(e),E(e,t.resvDrain_post),o+=t.resvDrain_post,t.main_data_begin+=(r-o)/8,H(e,new I)!=n.ResvSize&&v.err.println("Internal buffer inconsistency. flushbits <> ResvSize"),8*t.main_data_begin!=n.ResvSize&&(v.err.printf("bit reservoir error: \nl3_side.main_data_begin: %d \nResvoir size:             %d \nresv drain (post)         %d \nresv drain (pre)          %d \nheader and sideinfo:      %d \ndata bits:                %d \ntotal bits:               %d (remainder: %d) \nbitsperframe:             %d \n",8*t.main_data_begin,n.ResvSize,t.resvDrain_post,t.resvDrain_pre,8*n.sideinfo_len,o-t.resvDrain_post-8*n.sideinfo_len,o,o%8,r),v.err.println("This is a fatal error.  It has several possible causes:"),v.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations"),v.err.println(" 9%%  Your system is overclocked"),v.err.println(" 1%%  bug in LAME encoding library"),n.ResvSize=8*t.main_data_begin),y>1e9){var i;for(i=0;i<te.MAX_HEADER_BUF;++i)n.header[i].write_timing-=y;y=0}return 0},this.copy_buffer=function(e,t,n,r,_){var m=w+1;if(m<=0)return 0;if(0!=r&&m>r)return-1;if(v.arraycopy(d,0,t,n,m),w=-1,k=0,0!=_){var y=o(1);if(y[0]=e.nMusicCRC,h.updateMusicCRC(y,t,n,m),e.nMusicCRC=y[0],m>0&&(e.VBR_seek_table.nBytesWritten+=m),e.decode_on_the_fly)for(var i,S=f([2,1152]),M=m,R=-1;0!=R;)if(R=c.hip_decode1_unclipped(e.hip,t,n,M,S[0],S[1]),M=0,-1==R&&(R=0),R>0){if(e.findPeakSample){for(i=0;i<R;i++)S[0][i]>e.PeakSample?e.PeakSample=S[0][i]:-S[0][i]>e.PeakSample&&(e.PeakSample=-S[0][i]);if(e.channels_out>1)for(i=0;i<R;i++)S[1][i]>e.PeakSample?e.PeakSample=S[1][i]:-S[1][i]>e.PeakSample&&(e.PeakSample=-S[1][i])}if(e.findReplayGain&&l.AnalyzeSamples(e.rgdata,S[0],0,S[1],0,R,e.channels_out)==P.GAIN_ANALYSIS_ERROR)return-6}}return m},this.init_bit_stream_w=function(e){d=n(re.LAME_MAXMP3BUFFER),e.h_ptr=e.w_ptr=0,e.header[e.h_ptr].write_timing=0,w=-1,k=0,y=0}}function O(e,t,n,r){this.xlen=e,this.linmax=t,this.table=n,this.hlen=r}M.STEREO=new M(0),M.JOINT_STEREO=new M(1),M.DUAL_CHANNEL=new M(2),M.MONO=new M(3),M.NOT_SET=new M(4),P.STEPS_per_dB=100,P.MAX_dB=120,P.GAIN_NOT_ENOUGH_SAMPLES=-24601,P.GAIN_ANALYSIS_ERROR=0,P.GAIN_ANALYSIS_OK=1,P.INIT_GAIN_ANALYSIS_ERROR=0,P.INIT_GAIN_ANALYSIS_OK=1,P.YULE_ORDER=10,P.MAX_ORDER=P.YULE_ORDER,P.MAX_SAMP_FREQ=48e3,P.RMS_WINDOW_TIME_NUMERATOR=1,P.RMS_WINDOW_TIME_DENOMINATOR=20,P.MAX_SAMPLES_PER_WINDOW=P.MAX_SAMP_FREQ*P.RMS_WINDOW_TIME_NUMERATOR/P.RMS_WINDOW_TIME_DENOMINATOR+1,T.NUMTOCENTRIES=100,T.MAXFRAMESIZE=2880,B.EQ=function(a,b){return Math.abs(a)>Math.abs(b)?Math.abs(a-b)<=1e-6*Math.abs(a):Math.abs(a-b)<=1e-6*Math.abs(b)},B.NEQ=function(a,b){return!B.EQ(a,b)};var C={};function j(e){this.bits=e}function L(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}function I(){this.setModules=function(e,t){e,t}}function H(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=l(U.SBMAX_l),this.s=l(U.SBMAX_s),this.psfb21=l(U.PSFB21),this.psfb12=l(U.PSFB12),this.cb_l=l(U.CBANDS),this.cb_s=l(U.CBANDS),this.eql_w=l(U.BLKSIZE/2)}function D(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=M.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}function V(e){var t=e;this.quantize=t,this.iteration_loop=function(e,t,n,r){var c,f=e.internal_flags,_=l(z.SFBMAX),h=l(576),d=o(2),m=0,v=f.l3_side,y=new j(m);this.quantize.rv.ResvFrameBegin(e,y),m=y.bits;for(var w=0;w<f.mode_gr;w++){c=this.quantize.qupvt.on_pe(e,t,d,m,w,w),f.mode_ext==U.MPG_MD_MS_LR&&(this.quantize.ms_convert(f.l3_side,w),this.quantize.qupvt.reduce_side(d,n[w],m,c));for(var k=0;k<f.channels_out;k++){var S,M,R=v.tt[w][k];R.block_type!=U.SHORT_TYPE?(S=0,M=f.PSY.mask_adjust-S):(S=0,M=f.PSY.mask_adjust_short-S),f.masking_lower=Math.pow(10,.1*M),this.quantize.init_outer_loop(f,R),this.quantize.init_xrpow(f,R,h)&&(this.quantize.qupvt.calc_xmin(e,r[w][k],R,_),this.quantize.outer_loop(e,R,_,h,k,d[k])),this.quantize.iteration_finish_one(f,w,k)}}this.quantize.rv.ResvFrameEnd(f,m)}}function N(){}function Y(e,t,n,r){this.l=o(1+U.SBMAX_l),this.s=o(1+U.SBMAX_s),this.psfb21=o(1+U.PSFB21),this.psfb12=o(1+U.PSFB12);var l=this.l,s=this.s;4==arguments.length&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],v.arraycopy(this.arrL,0,l,0,Math.min(this.arrL.length,this.l.length)),v.arraycopy(this.arrS,0,s,0,Math.min(this.arrS.length,this.s.length)),v.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),v.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}function X(){var e=null,n=null,r=null;this.setModules=function(t,o,l){e=t,n=o,r=l},this.IPOW20=function(e){return v[e]};var c=X.IXMAX_VAL+2,f=X.Q_MAX,_=X.Q_MAX2,h=(X.LARGE_BITS,100);this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var d=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=d,this.sfBandIndex=[new Y([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Y([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Y([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Y([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Y([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Y([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Y([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Y([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Y([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0,8,16,24,36,52,72,96,124,160,162,164,166,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var m=l(f+_+1),v=l(f),w=l(c),M=l(c);function R(e,t){var n=r.ATHformula(t,e);return n-=h,n=Math.pow(10,n/10+e.ATHlower)}function x(e){this.s=e}this.adj43=M,this.iteration_init=function(n){var i,r=n.internal_flags,o=r.l3_side;if(0==r.iteration_init_init){for(r.iteration_init_init=1,o.main_data_begin=0,function(e){for(var n=e.internal_flags.ATH.l,r=e.internal_flags.ATH.psfb21,o=e.internal_flags.ATH.s,l=e.internal_flags.ATH.psfb12,c=e.internal_flags,f=e.out_samplerate,_=0;_<U.SBMAX_l;_++){var h=c.scalefac_band.l[_],d=c.scalefac_band.l[_+1];n[_]=k.MAX_VALUE;for(var i=h;i<d;i++){var m=R(e,i*f/1152);n[_]=Math.min(n[_],m)}}for(_=0;_<U.PSFB21;_++){h=c.scalefac_band.psfb21[_],d=c.scalefac_band.psfb21[_+1];r[_]=k.MAX_VALUE;for(i=h;i<d;i++){m=R(e,i*f/1152);r[_]=Math.min(r[_],m)}}for(_=0;_<U.SBMAX_s;_++){h=c.scalefac_band.s[_],d=c.scalefac_band.s[_+1];o[_]=k.MAX_VALUE;for(i=h;i<d;i++){m=R(e,i*f/384);o[_]=Math.min(o[_],m)}o[_]*=c.scalefac_band.s[_+1]-c.scalefac_band.s[_]}for(_=0;_<U.PSFB12;_++){h=c.scalefac_band.psfb12[_],d=c.scalefac_band.psfb12[_+1];l[_]=k.MAX_VALUE;for(i=h;i<d;i++){m=R(e,i*f/384);l[_]=Math.min(l[_],m)}l[_]*=c.scalefac_band.s[13]-c.scalefac_band.s[12]}if(e.noATH){for(_=0;_<U.SBMAX_l;_++)n[_]=1e-20;for(_=0;_<U.PSFB21;_++)r[_]=1e-20;for(_=0;_<U.SBMAX_s;_++)o[_]=1e-20;for(_=0;_<U.PSFB12;_++)l[_]=1e-20}c.ATH.floor=10*t(R(e,-1))}(n),w[0]=0,i=1;i<c;i++)w[i]=Math.pow(i,4/3);for(i=0;i<c-1;i++)M[i]=i+1-Math.pow(.5*(w[i]+w[i+1]),.75);for(M[i]=.5,i=0;i<f;i++)v[i]=Math.pow(2,-.1875*(i-210));for(i=0;i<=f+_;i++)m[i]=Math.pow(2,.25*(i-210-_));var l,h,d,y;for(e.huffman_init(r),(i=n.exp_nspsytune>>2&63)>=32&&(i-=64),l=Math.pow(10,i/4/10),(i=n.exp_nspsytune>>8&63)>=32&&(i-=64),h=Math.pow(10,i/4/10),(i=n.exp_nspsytune>>14&63)>=32&&(i-=64),d=Math.pow(10,i/4/10),(i=n.exp_nspsytune>>20&63)>=32&&(i-=64),y=d*Math.pow(10,i/4/10),i=0;i<U.SBMAX_l;i++){S=i<=6?l:i<=13?h:i<=20?d:y,r.nsPsy.longfact[i]=S}for(i=0;i<U.SBMAX_s;i++){var S;S=i<=5?l:i<=10?h:i<=11?d:y,r.nsPsy.shortfact[i]=S}}},this.on_pe=function(e,t,r,l,c,f){var _,h,d=e.internal_flags,m=0,v=o(2),y=new j(m),w=n.ResvMaxBits(e,l,y,f),k=(m=y.bits)+w;for(k>te.MAX_BITS_PER_GRANULE&&(k=te.MAX_BITS_PER_GRANULE),_=0,h=0;h<d.channels_out;++h)r[h]=Math.min(te.MAX_BITS_PER_CHANNEL,m/d.channels_out),v[h]=0|r[h]*t[c][h]/700-r[h],v[h]>3*l/4&&(v[h]=3*l/4),v[h]<0&&(v[h]=0),v[h]+r[h]>te.MAX_BITS_PER_CHANNEL&&(v[h]=Math.max(0,te.MAX_BITS_PER_CHANNEL-r[h])),_+=v[h];if(_>w)for(h=0;h<d.channels_out;++h)v[h]=w*v[h]/_;for(h=0;h<d.channels_out;++h)r[h]+=v[h],w-=v[h];for(_=0,h=0;h<d.channels_out;++h)_+=r[h];if(_>te.MAX_BITS_PER_GRANULE){for(h=0;h<d.channels_out;++h)r[h]*=te.MAX_BITS_PER_GRANULE,r[h]/=_,r[h]}return k},this.reduce_side=function(e,t,n,r){var o=.33*(.5-t)/.5;o<0&&(o=0),o>.5&&(o=.5);var l=0|.5*o*(e[0]+e[1]);l>te.MAX_BITS_PER_CHANNEL-e[0]&&(l=te.MAX_BITS_PER_CHANNEL-e[0]),l<0&&(l=0),e[1]>=125&&(e[1]-l>125?(e[0]<n&&(e[0]+=l),e[1]-=l):(e[0]+=e[1]-125,e[1]=125)),(l=e[0]+e[1])>r&&(e[0]=r*e[0]/l,e[1]=r*e[1]/l)},this.athAdjust=function(a,e,t){var n=90.30873362,u=y.FAST_LOG10_X(e,10),r=a*a,o=0;return u-=t,r>1e-20&&(o=1+y.FAST_LOG10_X(r,10/n)),o<0&&(o=0),u*=o,u+=t+n-94.82444863,Math.pow(10,.1*u)},this.calc_xmin=function(e,t,n,r){var o,l=0,c=e.internal_flags,f=0,_=0,h=c.ATH,d=n.xr,m=e.VBR==S.vbr_mtrh?1:0,v=c.masking_lower;for(e.VBR!=S.vbr_mtrh&&e.VBR!=S.vbr_mt||(v=1),o=0;o<n.psy_lmax;o++){P=(x=e.VBR==S.vbr_rh||e.VBR==S.vbr_mtrh?athAdjust(h.adjust,h.l[o],h.floor):h.adjust*h.l[o])/(M=n.width[o]),E=2220446049250313e-31,C=M>>1,O=0;do{O+=j=d[f]*d[f],E+=j<P?j:P,O+=L=d[++f]*d[f],E+=L<P?L:P,f++}while(--C>0);if(O>x&&_++,o==U.SBPSY_l)E<(T=x*c.nsPsy.longfact[o])&&(E=T);if(0!=m&&(x=E),!e.ATHonly)if((A=t.en.l[o])>0)T=O*t.thm.l[o]*v/A,0!=m&&(T*=c.nsPsy.longfact[o]),x<T&&(x=T);r[l++]=0!=m?x:x*c.nsPsy.longfact[o]}var y=575;if(n.block_type!=U.SHORT_TYPE)for(var w=576;0!=w--&&B.EQ(d[w],0);)y=w;n.max_nonzero_coeff=y;for(var k=n.sfb_smin;o<n.psymax;k++,o+=3){var M,b,R;for(R=e.VBR==S.vbr_rh||e.VBR==S.vbr_mtrh?athAdjust(h.adjust,h.s[k],h.floor):h.adjust*h.s[k],M=n.width[o],b=0;b<3;b++){var x,P,E,A,T,O=0,C=M>>1;P=R/M,E=2220446049250313e-31;do{var j,L;O+=j=d[f]*d[f],E+=j<P?j:P,O+=L=d[++f]*d[f],E+=L<P?L:P,f++}while(--C>0);if(O>R&&_++,k==U.SBPSY_s)E<(T=R*c.nsPsy.shortfact[k])&&(E=T);if(x=0!=m?E:R,!e.ATHonly&&!e.ATHshort)if((A=t.en.s[k][b])>0)T=O*t.thm.s[k][b]*v/A,0!=m&&(T*=c.nsPsy.shortfact[k]),x<T&&(x=T);r[l++]=0!=m?x:x*c.nsPsy.shortfact[k]}e.useTemporal&&(r[l-3]>r[l-3+1]&&(r[l-3+1]+=(r[l-3]-r[l-3+1])*c.decay),r[l-3+1]>r[l-3+2]&&(r[l-3+2]+=(r[l-3+1]-r[l-3+2])*c.decay))}return _},this.calc_noise_core=function(e,t,n,r){var o=0,c=t.s,f=e.l3_enc;if(c>e.count1)for(;0!=n--;){h=e.xr[c],c++,o+=h*h,h=e.xr[c],c++,o+=h*h}else if(c>e.big_values){var _=l(2);for(_[0]=0,_[1]=r;0!=n--;){h=Math.abs(e.xr[c])-_[f[c]],c++,o+=h*h,h=Math.abs(e.xr[c])-_[f[c]],c++,o+=h*h}}else for(;0!=n--;){var h;h=Math.abs(e.xr[c])-w[f[c]]*r,c++,o+=h*h,h=Math.abs(e.xr[c])-w[f[c]]*r,c++,o+=h*h}return t.s=c,o},this.calc_noise=function(e,t,n,r,o){var l,c,f=0,_=0,h=0,v=0,w=0,k=-20,S=0,M=e.scalefac,R=0;for(r.over_SSD=0,l=0;l<e.psymax;l++){var P,s=e.global_gain-(M[R++]+(0!=e.preflag?d[l]:0)<<e.scalefac_scale+1)-8*e.subblock_gain[e.window[l]],E=0;if(null!=o&&o.step[l]==s)E=o.noise[l],S+=e.width[l],n[f++]=E/t[_++],E=o.noise_log[l];else{var A,T=m[s+X.Q_MAX2];if(c=e.width[l]>>1,S+e.width[l]>e.max_nonzero_coeff)c=(A=e.max_nonzero_coeff-S+1)>0?A>>1:0;var B=new x(S);E=this.calc_noise_core(e,B,c,T),S=B.s,null!=o&&(o.step[l]=s,o.noise[l]=E),E=n[f++]=E/t[_++],E=y.FAST_LOG10(Math.max(E,1e-20)),null!=o&&(o.noise_log[l]=E)}if(null!=o&&(o.global_gain=e.global_gain),w+=E,E>0)P=Math.max(0|10*E+.5,1),r.over_SSD+=P*P,h++,v+=E;k=Math.max(k,E)}return r.over_count=h,r.tot_noise=w,r.over_noise=v,r.max_noise=k,h},this.set_pinfo=function(e,t,n,r,o){var c,f,_,h,m,v=e.internal_flags,y=0==t.scalefac_scale?.5:1,w=t.scalefac,k=l(z.SFBMAX),S=l(z.SFBMAX),M=new L;calc_xmin(e,n,t,k),calc_noise(t,k,S,M,null);var R=0;for(f=t.sfb_lmax,t.block_type!=U.SHORT_TYPE&&0==t.mixed_block_flag&&(f=22),c=0;c<f;c++){var x=v.scalefac_band.l[c],P=(E=v.scalefac_band.l[c+1])-x;for(h=0;R<E;R++)h+=t.xr[R]*t.xr[R];h/=P,m=1e15,v.pinfo.en[r][o][c]=m*h,v.pinfo.xfsf[r][o][c]=m*k[c]*S[c]/P,n.en.l[c]>0&&!e.ATHonly?h/=n.en.l[c]:h=0,v.pinfo.thr[r][o][c]=m*Math.max(h*n.thm.l[c],v.ATH.l[c]),v.pinfo.LAMEsfb[r][o][c]=0,0!=t.preflag&&c>=11&&(v.pinfo.LAMEsfb[r][o][c]=-y*d[c]),c<U.SBPSY_l&&(v.pinfo.LAMEsfb[r][o][c]-=y*w[c])}if(t.block_type==U.SHORT_TYPE)for(f=c,c=t.sfb_smin;c<U.SBMAX_s;c++){x=v.scalefac_band.s[c],P=(E=v.scalefac_band.s[c+1])-x;for(var E,i=0;i<3;i++){for(h=0,_=x;_<E;_++)h+=t.xr[R]*t.xr[R],R++;h=Math.max(h/P,1e-20),m=1e15,v.pinfo.en_s[r][o][3*c+i]=m*h,v.pinfo.xfsf_s[r][o][3*c+i]=m*k[f]*S[f]/P,n.en.s[c][i]>0?h/=n.en.s[c][i]:h=0,(e.ATHonly||e.ATHshort)&&(h=0),v.pinfo.thr_s[r][o][3*c+i]=m*Math.max(h*n.thm.s[c][i],v.ATH.s[c]),v.pinfo.LAMEsfb_s[r][o][3*c+i]=-2*t.subblock_gain[i],c<U.SBPSY_s&&(v.pinfo.LAMEsfb_s[r][o][3*c+i]-=y*w[f]),f++}}v.pinfo.LAMEqss[r][o]=t.global_gain,v.pinfo.LAMEmainbits[r][o]=t.part2_3_length+t.part2_length,v.pinfo.LAMEsfbits[r][o]=t.part2_length,v.pinfo.over[r][o]=M.over_count,v.pinfo.max_noise[r][o]=10*M.max_noise,v.pinfo.over_noise[r][o]=10*M.over_noise,v.pinfo.tot_noise[r][o]=10*M.tot_noise,v.pinfo.over_SSD[r][o]=M.over_SSD}}function F(){this.global_gain=0,this.sfb_count1=0,this.step=o(39),this.noise=l(39),this.noise_log=l(39)}function W(){this.xr=l(576),this.l3_enc=o(576),this.scalefac=o(z.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=o(3),this.subblock_gain=o(4),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=o(z.SFBMAX),this.window=o(z.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=o(4),this.max_nonzero_coeff=0;var e=this;function t(e){return new Int32Array(e)}this.assign=function(n){var r;e.xr=(r=n.xr,new Float32Array(r)),e.l3_enc=t(n.l3_enc),e.scalefac=t(n.scalefac),e.xrpow_max=n.xrpow_max,e.part2_3_length=n.part2_3_length,e.big_values=n.big_values,e.count1=n.count1,e.global_gain=n.global_gain,e.scalefac_compress=n.scalefac_compress,e.block_type=n.block_type,e.mixed_block_flag=n.mixed_block_flag,e.table_select=t(n.table_select),e.subblock_gain=t(n.subblock_gain),e.region0_count=n.region0_count,e.region1_count=n.region1_count,e.preflag=n.preflag,e.scalefac_scale=n.scalefac_scale,e.count1table_select=n.count1table_select,e.part2_length=n.part2_length,e.sfb_lmax=n.sfb_lmax,e.sfb_smin=n.sfb_smin,e.psy_lmax=n.psy_lmax,e.sfbmax=n.sfbmax,e.psymax=n.psymax,e.sfbdivide=n.sfbdivide,e.width=t(n.width),e.window=t(n.window),e.count1bits=n.count1bits,e.sfb_partition_table=n.sfb_partition_table.slice(0),e.slen=t(n.slen),e.max_nonzero_coeff=n.max_nonzero_coeff}}C.t1HB=[1,1,1,0],C.t2HB=[1,2,1,3,1,1,3,2,0],C.t3HB=[3,2,1,1,1,1,3,2,0],C.t5HB=[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0],C.t6HB=[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0],C.t7HB=[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0],C.t8HB=[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0],C.t9HB=[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0],C.t10HB=[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0],C.t11HB=[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0],C.t12HB=[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0],C.t13HB=[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1],C.t15HB=[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0],C.t16HB=[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3],C.t24HB=[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3],C.t32HB=[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16],C.t33HB=[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0],C.t1l=[1,4,3,5],C.t2l=[1,4,7,4,5,7,6,7,8],C.t3l=[2,3,7,4,4,7,6,7,8],C.t5l=[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10],C.t6l=[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9],C.t7l=[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12],C.t8l=[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13],C.t9l=[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11],C.t10l=[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13],C.t11l=[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12],C.t12l=[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12],C.t13l=[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18],C.t15l=[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15],C.t16_5l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12],C.t16l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10],C.t24l=[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6],C.t32l=[1,5,5,7,5,8,7,9,5,7,7,9,7,9,9,10],C.t33l=[4,5,5,6,5,6,6,7,5,6,6,7,6,7,7,8],C.ht=[new O(0,0,null,null),new O(2,0,C.t1HB,C.t1l),new O(3,0,C.t2HB,C.t2l),new O(3,0,C.t3HB,C.t3l),new O(0,0,null,null),new O(4,0,C.t5HB,C.t5l),new O(4,0,C.t6HB,C.t6l),new O(6,0,C.t7HB,C.t7l),new O(6,0,C.t8HB,C.t8l),new O(6,0,C.t9HB,C.t9l),new O(8,0,C.t10HB,C.t10l),new O(8,0,C.t11HB,C.t11l),new O(8,0,C.t12HB,C.t12l),new O(16,0,C.t13HB,C.t13l),new O(0,0,null,C.t16_5l),new O(16,0,C.t15HB,C.t15l),new O(1,1,C.t16HB,C.t16l),new O(2,3,C.t16HB,C.t16l),new O(3,7,C.t16HB,C.t16l),new O(4,15,C.t16HB,C.t16l),new O(6,63,C.t16HB,C.t16l),new O(8,255,C.t16HB,C.t16l),new O(10,1023,C.t16HB,C.t16l),new O(13,8191,C.t16HB,C.t16l),new O(4,15,C.t24HB,C.t24l),new O(5,31,C.t24HB,C.t24l),new O(6,63,C.t24HB,C.t24l),new O(7,127,C.t24HB,C.t24l),new O(8,255,C.t24HB,C.t24l),new O(9,511,C.t24HB,C.t24l),new O(11,2047,C.t24HB,C.t24l),new O(13,8191,C.t24HB,C.t24l),new O(0,0,C.t32HB,C.t32l),new O(0,0,C.t33HB,C.t33l)],C.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366],C.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296],C.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369],C.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]],C.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]],C.scfsi_band=[0,6,11,16,21],X.Q_MAX=257,X.Q_MAX2=116,X.LARGE_BITS=1e5,X.IXMAX_VAL=8206;var z={};function G(){var e,t,n;this.rv=null,this.qupvt=null;var r,o=new I;function c(e){this.ordinal=e}function f(e){for(var t=0;t<e.sfbmax;t++)if(e.scalefac[t]+e.subblock_gain[e.window[t]]==0)return!1;return!0}function _(e,t,n,r,o){var l;switch(e){default:case 9:t.over_count>0?(l=n.over_SSD<=t.over_SSD,n.over_SSD==t.over_SSD&&(l=n.bits<t.bits)):l=n.max_noise<0&&10*n.max_noise+n.bits<=10*t.max_noise+t.bits;break;case 0:l=n.over_count<t.over_count||n.over_count==t.over_count&&n.over_noise<t.over_noise||n.over_count==t.over_count&&B.EQ(n.over_noise,t.over_noise)&&n.tot_noise<t.tot_noise;break;case 8:n.max_noise=function(e,t){for(var n,r=1e-37,o=0;o<t.psymax;o++)r+=(n=e[o],y.FAST_LOG10(.368+.632*n*n*n));return Math.max(1e-20,r)}(o,r);case 1:l=n.max_noise<t.max_noise;break;case 2:l=n.tot_noise<t.tot_noise;break;case 3:l=n.tot_noise<t.tot_noise&&n.max_noise<t.max_noise;break;case 4:l=n.max_noise<=0&&t.max_noise>.2||n.max_noise<=0&&t.max_noise<0&&t.max_noise>n.max_noise-.2&&n.tot_noise<t.tot_noise||n.max_noise<=0&&t.max_noise>0&&t.max_noise>n.max_noise-.2&&n.tot_noise<t.tot_noise+t.over_noise||n.max_noise>0&&t.max_noise>-.05&&t.max_noise>n.max_noise-.1&&n.tot_noise+n.over_noise<t.tot_noise+t.over_noise||n.max_noise>0&&t.max_noise>-.1&&t.max_noise>n.max_noise-.15&&n.tot_noise+n.over_noise+n.over_noise<t.tot_noise+t.over_noise+t.over_noise;break;case 5:l=n.over_noise<t.over_noise||B.EQ(n.over_noise,t.over_noise)&&n.tot_noise<t.tot_noise;break;case 6:l=n.over_noise<t.over_noise||B.EQ(n.over_noise,t.over_noise)&&(n.max_noise<t.max_noise||B.EQ(n.max_noise,t.max_noise)&&n.tot_noise<=t.tot_noise);break;case 7:l=n.over_count<t.over_count||n.over_noise<t.over_noise}return 0==t.over_count&&(l=l&&n.bits<t.bits),l}function h(e,t,o,l,c){var _=e.internal_flags;!function(e,t,n,r,o){var l,c=e.internal_flags;l=0==t.scalefac_scale?1.2968395546510096:1.6817928305074292;for(var f=0,_=0;_<t.sfbmax;_++)f<n[_]&&(f=n[_]);var h=c.noise_shaping_amp;switch(3==h&&(h=o?2:1),h){case 2:break;case 1:f>1?f=Math.pow(f,.5):f*=.95;break;case 0:default:f>1?f=1:f*=.95}var d=0;for(_=0;_<t.sfbmax;_++){var m,v=t.width[_];if(d+=v,!(n[_]<f)){if(0!=(2&c.substep_shaping)&&(c.pseudohalf[_]=0==c.pseudohalf[_]?1:0,0==c.pseudohalf[_]&&2==c.noise_shaping_amp))return;for(t.scalefac[_]++,m=-v;m<0;m++)r[d+m]*=l,r[d+m]>t.xrpow_max&&(t.xrpow_max=r[d+m]);if(2==c.noise_shaping_amp)return}}}(e,t,o,l,c);var h=f(t);return!h&&(!(h=2==_.mode_gr?r.scale_bitcount(t):r.scale_bitcount_lsf(_,t))||(_.noise_shaping>1&&(m.fill(_.pseudohalf,0),0==t.scalefac_scale?(!function(e,t){for(var r=0,o=0;o<e.sfbmax;o++){var l=e.width[o],s=e.scalefac[o];if(0!=e.preflag&&(s+=n.pretab[o]),r+=l,0!=(1&s)){s++;for(var c=-l;c<0;c++)t[r+c]*=1.2968395546510096,t[r+c]>e.xrpow_max&&(e.xrpow_max=t[r+c])}e.scalefac[o]=s>>1}e.preflag=0,e.scalefac_scale=1}(t,l),h=!1):t.block_type==U.SHORT_TYPE&&_.subblock_gain>0&&(h=function(e,t,r){var o,l=t.scalefac;for(o=0;o<t.sfb_lmax;o++)if(l[o]>=16)return!0;for(var c=0;c<3;c++){var f=0,_=0;for(o=t.sfb_lmax+c;o<t.sfbdivide;o+=3)f<l[o]&&(f=l[o]);for(;o<t.sfbmax;o+=3)_<l[o]&&(_=l[o]);if(!(f<16&&_<8)){if(t.subblock_gain[c]>=7)return!0;t.subblock_gain[c]++;var h=e.scalefac_band.l[t.sfb_lmax];for(o=t.sfb_lmax+c;o<t.sfbmax;o+=3){var d=t.width[o],s=l[o];if((s-=4>>t.scalefac_scale)>=0)l[o]=s,h+=3*d;else{l[o]=0;var m=210+(s<<t.scalefac_scale+1);y=n.IPOW20(m),h+=d*(c+1);for(var v=-d;v<0;v++)r[h+v]*=y,r[h+v]>t.xrpow_max&&(t.xrpow_max=r[h+v]);h+=d*(3-c-1)}}var y=n.IPOW20(202);h+=t.width[o]*(c+1);for(v=-t.width[o];v<0;v++)r[h+v]*=y,r[h+v]>t.xrpow_max&&(t.xrpow_max=r[h+v])}}return!1}(_,t,l)||f(t))),h||(h=2==_.mode_gr?r.scale_bitcount(t):r.scale_bitcount_lsf(_,t)),!h))}this.setModules=function(l,c,f,_){e=l,t=c,this.rv=c,n=f,this.qupvt=f,r=_,o.setModules(n,r)},this.ms_convert=function(e,t){for(var i=0;i<576;++i){var n=e.tt[t][0].xr[i],r=e.tt[t][1].xr[i];e.tt[t][0].xr[i]=(n+r)*(.5*y.SQRT2),e.tt[t][1].xr[i]=(n-r)*(.5*y.SQRT2)}},this.init_xrpow=function(e,t,n){var r=0,o=0|t.max_nonzero_coeff;if(t.xrpow_max=0,m.fill(n,o,576,0),(r=function(e,t,n,r){r=0;for(var i=0;i<=n;++i){var o=Math.abs(e.xr[i]);r+=o,t[i]=Math.sqrt(o*Math.sqrt(o)),t[i]>e.xrpow_max&&(e.xrpow_max=t[i])}return r}(t,n,o,r))>1e-20){var l=0;0!=(2&e.substep_shaping)&&(l=1);for(var i=0;i<t.psymax;i++)e.pseudohalf[i]=l;return!0}return m.fill(t.l3_enc,0,576,0),!1},this.init_outer_loop=function(e,t){t.part2_3_length=0,t.big_values=0,t.count1=0,t.global_gain=210,t.scalefac_compress=0,t.table_select[0]=0,t.table_select[1]=0,t.table_select[2]=0,t.subblock_gain[0]=0,t.subblock_gain[1]=0,t.subblock_gain[2]=0,t.subblock_gain[3]=0,t.region0_count=0,t.region1_count=0,t.preflag=0,t.scalefac_scale=0,t.count1table_select=0,t.part2_length=0,t.sfb_lmax=U.SBPSY_l,t.sfb_smin=U.SBPSY_s,t.psy_lmax=e.sfb21_extra?U.SBMAX_l:U.SBPSY_l,t.psymax=t.psy_lmax,t.sfbmax=t.sfb_lmax,t.sfbdivide=11;for(var r=0;r<U.SBMAX_l;r++)t.width[r]=e.scalefac_band.l[r+1]-e.scalefac_band.l[r],t.window[r]=3;if(t.block_type==U.SHORT_TYPE){var o=l(576);t.sfb_smin=0,t.sfb_lmax=0,0!=t.mixed_block_flag&&(t.sfb_smin=3,t.sfb_lmax=2*e.mode_gr+4),t.psymax=t.sfb_lmax+3*((e.sfb21_extra?U.SBMAX_s:U.SBPSY_s)-t.sfb_smin),t.sfbmax=t.sfb_lmax+3*(U.SBPSY_s-t.sfb_smin),t.sfbdivide=t.sfbmax-18,t.psy_lmax=t.sfb_lmax;var c=e.scalefac_band.l[t.sfb_lmax];v.arraycopy(t.xr,0,o,0,576);for(r=t.sfb_smin;r<U.SBMAX_s;r++)for(var f=e.scalefac_band.s[r],_=e.scalefac_band.s[r+1],h=0;h<3;h++)for(var d=f;d<_;d++)t.xr[c++]=o[3*d+h];var y=t.sfb_lmax;for(r=t.sfb_smin;r<U.SBMAX_s;r++)t.width[y]=t.width[y+1]=t.width[y+2]=e.scalefac_band.s[r+1]-e.scalefac_band.s[r],t.window[y]=0,t.window[y+1]=1,t.window[y+2]=2,y+=3}t.count1bits=0,t.sfb_partition_table=n.nr_of_sfb_block[0][0],t.slen[0]=0,t.slen[1]=0,t.slen[2]=0,t.slen[3]=0,t.max_nonzero_coeff=575,m.fill(t.scalefac,0),function(e,t){var r=e.ATH,o=t.xr;if(t.block_type!=U.SHORT_TYPE)for(var l=!1,c=U.PSFB21-1;c>=0&&!l;c--){var f=e.scalefac_band.psfb21[c],_=e.scalefac_band.psfb21[c+1],h=n.athAdjust(r.adjust,r.psfb21[c],r.floor);e.nsPsy.longfact[21]>1e-12&&(h*=e.nsPsy.longfact[21]);for(var d=_-1;d>=f;d--){if(!(Math.abs(o[d])<h)){l=!0;break}o[d]=0}}else for(var m=0;m<3;m++)for(l=!1,c=U.PSFB12-1;c>=0&&!l;c--){_=(f=3*e.scalefac_band.s[12]+(e.scalefac_band.s[13]-e.scalefac_band.s[12])*m+(e.scalefac_band.psfb12[c]-e.scalefac_band.psfb12[0]))+(e.scalefac_band.psfb12[c+1]-e.scalefac_band.psfb12[c]);var v=n.athAdjust(r.adjust,r.psfb12[c],r.floor);e.nsPsy.shortfact[12]>1e-12&&(v*=e.nsPsy.shortfact[12]);for(d=_-1;d>=f;d--){if(!(Math.abs(o[d])<v)){l=!0;break}o[d]=0}}}(e,t)},c.BINSEARCH_NONE=new c(0),c.BINSEARCH_UP=new c(1),c.BINSEARCH_DOWN=new c(2),this.trancate_smallspectrums=function(e,t,o,c){var f=l(z.SFBMAX);if((0!=(4&e.substep_shaping)||t.block_type!=U.SHORT_TYPE)&&0==(128&e.substep_shaping)){n.calc_noise(t,o,f,new L,null);for(var _=0;_<576;_++){var h=0;0!=t.l3_enc[_]&&(h=Math.abs(t.xr[_])),c[_]=h}_=0;var d=8;t.block_type==U.SHORT_TYPE&&(d=6);do{var v,y,w,k,S=t.width[d];if(_+=S,!(f[d]>=1||(m.sort(c,_-S,S),B.EQ(c[_-1],0)))){v=(1-f[d])*o[d],y=0,k=0;do{var M;for(w=1;k+w<S&&!B.NEQ(c[k+_-S],c[k+_+w-S]);w++);if(v<(M=c[k+_-S]*c[k+_-S]*w)){0!=k&&(y=c[k+_-S-1]);break}v-=M,k+=w}while(k<S);if(!B.EQ(y,0))do{Math.abs(t.xr[_-S])<=y&&(t.l3_enc[_-S]=0)}while(--S>0)}}while(++d<t.psymax);t.part2_3_length=r.noquant_count_bits(e,t,null)}},this.outer_loop=function(e,t,o,f,d,m){var y=e.internal_flags,w=new W,k=l(576),M=l(z.SFBMAX),R=new L,x=new F,P=9999999,E=!1,A=!1,T=0;if(function(e,t,n,o,l){var f,_=e.CurrentStep[o],h=!1,d=e.OldValue[o],m=c.BINSEARCH_NONE;for(t.global_gain=d,n-=t.part2_length;;){var v;if(f=r.count_bits(e,l,t,null),1==_||f==n)break;f>n?(m==c.BINSEARCH_DOWN&&(h=!0),h&&(_/=2),m=c.BINSEARCH_UP,v=_):(m==c.BINSEARCH_UP&&(h=!0),h&&(_/=2),m=c.BINSEARCH_DOWN,v=-_),t.global_gain+=v,t.global_gain<0&&(t.global_gain=0,h=!0),t.global_gain>255&&(t.global_gain=255,h=!0)}for(;f>n&&t.global_gain<255;)t.global_gain++,f=r.count_bits(e,l,t,null);e.CurrentStep[o]=d-t.global_gain>=4?4:2,e.OldValue[o]=t.global_gain,t.part2_3_length=f}(y,t,m,d,f),0==y.noise_shaping)return 100;n.calc_noise(t,o,M,R,x),R.bits=t.part2_3_length,w.assign(t);var B=0;for(v.arraycopy(f,0,k,0,576);!E;){do{var O,C=new L,j=255;if(O=0!=(2&y.substep_shaping)?20:3,y.sfb21_extra){if(M[w.sfbmax]>1)break;if(w.block_type==U.SHORT_TYPE&&(M[w.sfbmax+1]>1||M[w.sfbmax+2]>1))break}if(!h(e,w,M,f,A))break;0!=w.scalefac_scale&&(j=254);var I=m-w.part2_length;if(I<=0)break;for(;(w.part2_3_length=r.count_bits(y,f,w,x))>I&&w.global_gain<=j;)w.global_gain++;if(w.global_gain>j)break;if(0==R.over_count){for(;(w.part2_3_length=r.count_bits(y,f,w,x))>P&&w.global_gain<=j;)w.global_gain++;if(w.global_gain>j)break}if(n.calc_noise(w,o,M,C,x),C.bits=w.part2_3_length,0!=(_(t.block_type!=U.SHORT_TYPE?e.quant_comp:e.quant_comp_short,R,C,w,M)?1:0))P=t.part2_3_length,R=C,t.assign(w),B=0,v.arraycopy(f,0,k,0,576);else if(0==y.full_outer_loop){if(++B>O&&0==R.over_count)break;if(3==y.noise_shaping_amp&&A&&B>30)break;if(3==y.noise_shaping_amp&&A&&w.global_gain-T>15)break}}while(w.global_gain+w.scalefac_scale<255);3==y.noise_shaping_amp?A?E=!0:(w.assign(t),v.arraycopy(k,0,f,0,576),B=0,T=w.global_gain,A=!0):E=!0}return e.VBR==S.vbr_rh||e.VBR==S.vbr_mtrh?v.arraycopy(k,0,f,0,576):0!=(1&y.substep_shaping)&&trancate_smallspectrums(y,t,o,f),R.over_count},this.iteration_finish_one=function(e,n,o){var l=e.l3_side,c=l.tt[n][o];r.best_scalefac_store(e,n,o,l),1==e.use_best_huffman&&r.best_huffman_divide(e,c),t.ResvAdjust(e,c)},this.VBR_encode_granule=function(e,t,n,r,o,c,f){var _,h=e.internal_flags,d=new W,y=l(576),w=f,k=f+1,S=(f+c)/2,M=0,R=h.sfb21_extra;m.fill(d.l3_enc,0);do{h.sfb21_extra=!(S>w-42)&&R,outer_loop(e,t,n,r,o,S)<=0?(M=1,k=t.part2_3_length,d.assign(t),v.arraycopy(r,0,y,0,576),_=(f=k-32)-c,S=(f+c)/2):(_=f-(c=S+32),S=(f+c)/2,0!=M&&(M=2,t.assign(d),v.arraycopy(y,0,r,0,576)))}while(_>12);h.sfb21_extra=R,2==M&&v.arraycopy(d.l3_enc,0,t.l3_enc,0,576)},this.get_framebits=function(n,r){var o=n.internal_flags;o.bitrate_index=o.VBR_min_bitrate;var l=e.getframebits(n);o.bitrate_index=1,l=e.getframebits(n);for(var i=1;i<=o.VBR_max_bitrate;i++){o.bitrate_index=i;var c=new j(l);r[i]=t.ResvFrameBegin(n,c),l=c.bits}},this.VBR_old_prepare=function(e,r,o,l,c,f,_,h,d){var m,v=e.internal_flags,y=0,w=1,k=0;v.bitrate_index=v.VBR_max_bitrate;var S=t.ResvFrameBegin(e,new j(0))/v.mode_gr;get_framebits(e,f);for(var M=0;M<v.mode_gr;M++){var R=n.on_pe(e,r,h[M],S,M,0);v.mode_ext==U.MPG_MD_MS_LR&&(ms_convert(v.l3_side,M),n.reduce_side(h[M],o[M],S,R));for(var x=0;x<v.channels_out;++x){var P=v.l3_side.tt[M][x];P.block_type!=U.SHORT_TYPE?(y=1.28/(1+Math.exp(3.5-r[M][x]/300))-.05,m=v.PSY.mask_adjust-y):(y=2.56/(1+Math.exp(3.5-r[M][x]/300))-.14,m=v.PSY.mask_adjust_short-y),v.masking_lower=Math.pow(10,.1*m),init_outer_loop(v,P),d[M][x]=n.calc_xmin(e,l[M][x],P,c[M][x]),0!=d[M][x]&&(w=0),_[M][x]=126,k+=h[M][x]}}for(M=0;M<v.mode_gr;M++)for(x=0;x<v.channels_out;x++)k>f[v.VBR_max_bitrate]&&(h[M][x]*=f[v.VBR_max_bitrate],h[M][x]/=k),_[M][x]>h[M][x]&&(_[M][x]=h[M][x]);return w},this.bitpressure_strategy=function(e,t,n,r){for(var o=0;o<e.mode_gr;o++)for(var l=0;l<e.channels_out;l++){for(var c=e.l3_side.tt[o][l],f=t[o][l],_=0,h=0;h<c.psy_lmax;h++)f[_++]*=1+.029*h*h/U.SBMAX_l/U.SBMAX_l;if(c.block_type==U.SHORT_TYPE)for(h=c.sfb_smin;h<U.SBMAX_s;h++)f[_++]*=1+.029*h*h/U.SBMAX_s/U.SBMAX_s,f[_++]*=1+.029*h*h/U.SBMAX_s/U.SBMAX_s,f[_++]*=1+.029*h*h/U.SBMAX_s/U.SBMAX_s;r[o][l]=0|Math.max(n[o][l],.9*r[o][l])}},this.VBR_new_prepare=function(e,r,o,l,c,f){var _,h=e.internal_flags,d=1,m=0,v=0;if(e.free_format){h.bitrate_index=0;y=new j(m);_=t.ResvFrameBegin(e,y),m=y.bits,c[0]=_}else{h.bitrate_index=h.VBR_max_bitrate;var y=new j(m);t.ResvFrameBegin(e,y),m=y.bits,get_framebits(e,c),_=c[h.VBR_max_bitrate]}for(var w=0;w<h.mode_gr;w++){n.on_pe(e,r,f[w],m,w,0),h.mode_ext==U.MPG_MD_MS_LR&&ms_convert(h.l3_side,w);for(var k=0;k<h.channels_out;++k){var S=h.l3_side.tt[w][k];h.masking_lower=Math.pow(10,.1*h.PSY.mask_adjust),init_outer_loop(h,S),0!=n.calc_xmin(e,o[w][k],S,l[w][k])&&(d=0),v+=f[w][k]}}for(w=0;w<h.mode_gr;w++)for(k=0;k<h.channels_out;k++)v>_&&(f[w][k]*=_,f[w][k]/=v);return d},this.calc_target_bits=function(r,o,l,c,f,_){var h,d,m,v,y=r.internal_flags,w=y.l3_side,k=0;y.bitrate_index=y.VBR_max_bitrate;var S=new j(k);for(_[0]=t.ResvFrameBegin(r,S),k=S.bits,y.bitrate_index=1,k=e.getframebits(r)-8*y.sideinfo_len,f[0]=k/(y.mode_gr*y.channels_out),k=r.VBR_mean_bitrate_kbps*r.framesize*1e3,0!=(1&y.substep_shaping)&&(k*=1.09),k/=r.out_samplerate,k-=8*y.sideinfo_len,k/=y.mode_gr*y.channels_out,(h=.93+.07*(11-r.compression_ratio)/5.5)<.9&&(h=.9),h>1&&(h=1),d=0;d<y.mode_gr;d++){var M=0;for(m=0;m<y.channels_out;m++){if(c[d][m]=int(h*k),o[d][m]>700){var R=int((o[d][m]-700)/1.4),x=w.tt[d][m];c[d][m]=int(h*k),x.block_type==U.SHORT_TYPE&&R<k/2&&(R=k/2),R>3*k/2?R=3*k/2:R<0&&(R=0),c[d][m]+=R}c[d][m]>te.MAX_BITS_PER_CHANNEL&&(c[d][m]=te.MAX_BITS_PER_CHANNEL),M+=c[d][m]}if(M>te.MAX_BITS_PER_GRANULE)for(m=0;m<y.channels_out;++m)c[d][m]*=te.MAX_BITS_PER_GRANULE,c[d][m]/=M}if(y.mode_ext==U.MPG_MD_MS_LR)for(d=0;d<y.mode_gr;d++)n.reduce_side(c[d],l[d],k*y.channels_out,te.MAX_BITS_PER_GRANULE);for(v=0,d=0;d<y.mode_gr;d++)for(m=0;m<y.channels_out;m++)c[d][m]>te.MAX_BITS_PER_CHANNEL&&(c[d][m]=te.MAX_BITS_PER_CHANNEL),v+=c[d][m];if(v>_[0])for(d=0;d<y.mode_gr;d++)for(m=0;m<y.channels_out;m++)c[d][m]*=_[0],c[d][m]/=v}}function Z(){var e=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*y.SQRT2*.5/2384e-9,.017876148*y.SQRT2*.5/2384e-9,.003134727*y.SQRT2*.5/2384e-9,.002457142*y.SQRT2*.5/2384e-9,971317e-9*y.SQRT2*.5/2384e-9,218868e-9*y.SQRT2*.5/2384e-9,101566e-9*y.SQRT2*.5/2384e-9,13828e-9*y.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,49591e-9/2384e-9,1995.1556208053692,21458e-9/2384e-9,-69618e-9/2384e-9],t=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],n=t[U.SHORT_TYPE],r=t[U.SHORT_TYPE],o=t[U.SHORT_TYPE],c=t[U.SHORT_TYPE],f=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];function _(t,n,a){for(var u,r,o,l=10,c=n+238-14-286,i=-15;i<0;i++){var f,s,_;f=e[l+-10],s=t[c+-224]*f,_=t[n+224]*f,f=e[l+-9],s+=t[c+-160]*f,_+=t[n+160]*f,f=e[l+-8],s+=t[c+-96]*f,_+=t[n+96]*f,f=e[l+-7],s+=t[c+-32]*f,_+=t[n+32]*f,f=e[l+-6],s+=t[c+32]*f,_+=t[n+-32]*f,f=e[l+-5],s+=t[c+96]*f,_+=t[n+-96]*f,f=e[l+-4],s+=t[c+160]*f,_+=t[n+-160]*f,f=e[l+-3],s+=t[c+224]*f,_+=t[n+-224]*f,f=e[l+-2],s+=t[n+-256]*f,_-=t[c+256]*f,f=e[l+-1],s+=t[n+-192]*f,_-=t[c+192]*f,f=e[l+0],s+=t[n+-128]*f,_-=t[c+128]*f,f=e[l+1],s+=t[n+-64]*f,_-=t[c+64]*f,f=e[l+2],s+=t[n+0]*f,_-=t[c+0]*f,f=e[l+3],s+=t[n+64]*f,_-=t[c+-64]*f,f=e[l+4],s+=t[n+128]*f,_-=t[c+-128]*f,f=e[l+5],s+=t[n+192]*f,f=(_-=t[c+-192]*f)-(s*=e[l+6]),a[30+2*i]=_+s,a[31+2*i]=e[l+7]*f,l+=18,n--,c++}_=t[n+-16]*e[l+-10],s=t[n+-32]*e[l+-2],_+=(t[n+-48]-t[n+16])*e[l+-9],s+=t[n+-96]*e[l+-1],_+=(t[n+-80]+t[n+48])*e[l+-8],s+=t[n+-160]*e[l+0],_+=(t[n+-112]-t[n+80])*e[l+-7],s+=t[n+-224]*e[l+1],_+=(t[n+-144]+t[n+112])*e[l+-6],s-=t[n+32]*e[l+2],_+=(t[n+-176]-t[n+144])*e[l+-5],s-=t[n+96]*e[l+3],_+=(t[n+-208]+t[n+176])*e[l+-4],s-=t[n+160]*e[l+4],_+=(t[n+-240]-t[n+208])*e[l+-3],u=(s-=t[n+224])-_,r=s+_,_=a[14],s=a[15]-_,a[31]=r+_,a[30]=u+s,a[15]=u-s,a[14]=r-_,o=a[28]-a[0],a[0]+=a[28],a[28]=o*e[l+-36+7],o=a[29]-a[1],a[1]+=a[29],a[29]=o*e[l+-36+7],o=a[26]-a[2],a[2]+=a[26],a[26]=o*e[l+-72+7],o=a[27]-a[3],a[3]+=a[27],a[27]=o*e[l+-72+7],o=a[24]-a[4],a[4]+=a[24],a[24]=o*e[l+-108+7],o=a[25]-a[5],a[5]+=a[25],a[25]=o*e[l+-108+7],o=a[22]-a[6],a[6]+=a[22],a[22]=o*y.SQRT2,o=a[23]-a[7],a[7]+=a[23],a[23]=o*y.SQRT2-a[7],a[7]-=a[6],a[22]-=a[7],a[23]-=a[22],o=a[6],a[6]=a[31]-o,a[31]=a[31]+o,o=a[7],a[7]=a[30]-o,a[30]=a[30]+o,o=a[22],a[22]=a[15]-o,a[15]=a[15]+o,o=a[23],a[23]=a[14]-o,a[14]=a[14]+o,o=a[20]-a[8],a[8]+=a[20],a[20]=o*e[l+-180+7],o=a[21]-a[9],a[9]+=a[21],a[21]=o*e[l+-180+7],o=a[18]-a[10],a[10]+=a[18],a[18]=o*e[l+-216+7],o=a[19]-a[11],a[11]+=a[19],a[19]=o*e[l+-216+7],o=a[16]-a[12],a[12]+=a[16],a[16]=o*e[l+-252+7],o=a[17]-a[13],a[13]+=a[17],a[17]=o*e[l+-252+7],o=-a[20]+a[24],a[20]+=a[24],a[24]=o*e[l+-216+7],o=-a[21]+a[25],a[21]+=a[25],a[25]=o*e[l+-216+7],o=a[4]-a[8],a[4]+=a[8],a[8]=o*e[l+-216+7],o=a[5]-a[9],a[5]+=a[9],a[9]=o*e[l+-216+7],o=a[0]-a[12],a[0]+=a[12],a[12]=o*e[l+-72+7],o=a[1]-a[13],a[1]+=a[13],a[13]=o*e[l+-72+7],o=a[16]-a[28],a[16]+=a[28],a[28]=o*e[l+-72+7],o=-a[17]+a[29],a[17]+=a[29],a[29]=o*e[l+-72+7],o=y.SQRT2*(a[2]-a[10]),a[2]+=a[10],a[10]=o,o=y.SQRT2*(a[3]-a[11]),a[3]+=a[11],a[11]=o,o=y.SQRT2*(-a[18]+a[26]),a[18]+=a[26],a[26]=o-a[18],o=y.SQRT2*(-a[19]+a[27]),a[19]+=a[27],a[27]=o-a[19],o=a[2],a[19]-=a[3],a[3]-=o,a[2]=a[31]-o,a[31]+=o,o=a[3],a[11]-=a[19],a[18]-=o,a[3]=a[30]-o,a[30]+=o,o=a[18],a[27]-=a[11],a[19]-=o,a[18]=a[15]-o,a[15]+=o,o=a[19],a[10]-=o,a[19]=a[14]-o,a[14]+=o,o=a[10],a[11]-=o,a[10]=a[23]-o,a[23]+=o,o=a[11],a[26]-=o,a[11]=a[22]-o,a[22]+=o,o=a[26],a[27]-=o,a[26]=a[7]-o,a[7]+=o,o=a[27],a[27]=a[6]-o,a[6]+=o,o=y.SQRT2*(a[0]-a[4]),a[0]+=a[4],a[4]=o,o=y.SQRT2*(a[1]-a[5]),a[1]+=a[5],a[5]=o,o=y.SQRT2*(a[16]-a[20]),a[16]+=a[20],a[20]=o,o=y.SQRT2*(a[17]-a[21]),a[17]+=a[21],a[21]=o,o=-y.SQRT2*(a[8]-a[12]),a[8]+=a[12],a[12]=o-a[8],o=-y.SQRT2*(a[9]-a[13]),a[9]+=a[13],a[13]=o-a[9],o=-y.SQRT2*(a[25]-a[29]),a[25]+=a[29],a[29]=o-a[25],o=-y.SQRT2*(a[24]+a[28]),a[24]-=a[28],a[28]=o-a[24],o=a[24]-a[16],a[24]=o,o=a[20]-o,a[20]=o,o=a[28]-o,a[28]=o,o=a[25]-a[17],a[25]=o,o=a[21]-o,a[21]=o,o=a[29]-o,a[29]=o,o=a[17]-a[1],a[17]=o,o=a[9]-o,a[9]=o,o=a[25]-o,a[25]=o,o=a[5]-o,a[5]=o,o=a[21]-o,a[21]=o,o=a[13]-o,a[13]=o,o=a[29]-o,a[29]=o,o=a[1]-a[0],a[1]=o,o=a[16]-o,a[16]=o,o=a[17]-o,a[17]=o,o=a[8]-o,a[8]=o,o=a[9]-o,a[9]=o,o=a[24]-o,a[24]=o,o=a[25]-o,a[25]=o,o=a[4]-o,a[4]=o,o=a[5]-o,a[5]=o,o=a[20]-o,a[20]=o,o=a[21]-o,a[21]=o,o=a[12]-o,a[12]=o,o=a[13]-o,a[13]=o,o=a[28]-o,a[28]=o,o=a[29]-o,a[29]=o,o=a[0],a[0]+=a[31],a[31]-=o,o=a[1],a[1]+=a[30],a[30]-=o,o=a[16],a[16]+=a[15],a[15]-=o,o=a[17],a[17]+=a[14],a[14]-=o,o=a[8],a[8]+=a[23],a[23]-=o,o=a[9],a[9]+=a[22],a[22]-=o,o=a[24],a[24]+=a[7],a[7]-=o,o=a[25],a[25]+=a[6],a[6]-=o,o=a[4],a[4]+=a[27],a[27]-=o,o=a[5],a[5]+=a[26],a[26]-=o,o=a[20],a[20]+=a[11],a[11]-=o,o=a[21],a[21]+=a[10],a[10]-=o,o=a[12],a[12]+=a[19],a[19]-=o,o=a[13],a[13]+=a[18],a[18]-=o,o=a[28],a[28]+=a[3],a[3]-=o,o=a[29],a[29]+=a[2],a[2]-=o}function h(e,n){for(var r=0;r<3;r++){var o,l,c,f,_,h;l=(f=e[n+6]*t[U.SHORT_TYPE][0]-e[n+15])+(o=e[n+0]*t[U.SHORT_TYPE][2]-e[n+9]),c=f-o,_=(f=e[n+15]*t[U.SHORT_TYPE][0]+e[n+6])+(o=e[n+9]*t[U.SHORT_TYPE][2]+e[n+0]),h=-f+o,o=2069978111953089e-26*(e[n+3]*t[U.SHORT_TYPE][1]-e[n+12]),f=2069978111953089e-26*(e[n+12]*t[U.SHORT_TYPE][1]+e[n+3]),e[n+0]=190752519173728e-25*l+o,e[n+15]=190752519173728e-25*-_+f,c=.8660254037844387*c*1907525191737281e-26,_=.5*_*1907525191737281e-26+f,e[n+3]=c-_,e[n+6]=c+_,l=.5*l*1907525191737281e-26-o,h=.8660254037844387*h*1907525191737281e-26,e[n+9]=l+h,e[n+12]=l-h,n++}}this.mdct_sub48=function(e,d,y){for(var w,k,S,M,R,x,P,E,A,T,B,O,C,j,L,I,H,D,V,N,Y,X=d,F=286,W=0;W<e.channels_out;W++){for(var z=0;z<e.mode_gr;z++){for(var G,Z=e.l3_side.tt[z][W],K=Z.xr,Q=0,samp=e.sb_sample[W][1-z],J=0,$=0;$<9;$++)for(_(X,F,samp[J]),_(X,F+32,samp[J+1]),J+=2,F+=64,G=1;G<32;G+=2)samp[J-1][G]*=-1;for(G=0;G<32;G++,Q+=18){var ee=Z.block_type,te=e.sb_sample[W][z],ae=e.sb_sample[W][1-z];if(0!=Z.mixed_block_flag&&G<2&&(ee=0),e.amp_filter[G]<1e-12)m.fill(K,Q+0,Q+18,0);else{if(e.amp_filter[G]<1)for($=0;$<18;$++)ae[$][f[G]]*=e.amp_filter[G];if(ee==U.SHORT_TYPE){for($=-3;$<0;$++){var ne=t[U.SHORT_TYPE][$+3];K[Q+3*$+9]=te[9+$][f[G]]*ne-te[8-$][f[G]],K[Q+3*$+18]=te[14-$][f[G]]*ne+te[15+$][f[G]],K[Q+3*$+10]=te[15+$][f[G]]*ne-te[14-$][f[G]],K[Q+3*$+19]=ae[2-$][f[G]]*ne+ae[3+$][f[G]],K[Q+3*$+11]=ae[3+$][f[G]]*ne-ae[2-$][f[G]],K[Q+3*$+20]=ae[8-$][f[G]]*ne+ae[9+$][f[G]]}h(K,Q)}else{var re=l(18);for($=-9;$<0;$++){var a,b;a=t[ee][$+27]*ae[$+9][f[G]]+t[ee][$+36]*ae[8-$][f[G]],b=t[ee][$+9]*te[$+9][f[G]]-t[ee][$+18]*te[8-$][f[G]],re[$+9]=a-b*n[3+$+9],re[$+18]=a*n[3+$+9]+b}w=K,k=Q,M=void 0,R=void 0,x=void 0,P=void 0,E=void 0,A=void 0,T=void 0,B=void 0,O=void 0,C=void 0,j=void 0,L=void 0,I=void 0,H=void 0,D=void 0,V=void 0,N=void 0,Y=void 0,x=(S=re)[17]-S[9],E=S[15]-S[11],A=S[14]-S[12],T=S[0]+S[8],B=S[1]+S[7],O=S[2]+S[6],C=S[3]+S[5],w[k+17]=T+O-C-(B-S[4]),R=(T+O-C)*r[19]+(B-S[4]),M=(x-E-A)*r[18],w[k+5]=M+R,w[k+6]=M-R,P=(S[16]-S[10])*r[18],B=B*r[19]+S[4],M=x*r[12]+P+E*r[13]+A*r[14],R=-T*r[16]+B-O*r[17]+C*r[15],w[k+1]=M+R,w[k+2]=M-R,M=x*r[13]-P-E*r[14]+A*r[12],R=-T*r[17]+B-O*r[15]+C*r[16],w[k+9]=M+R,w[k+10]=M-R,M=x*r[14]-P+E*r[12]-A*r[13],R=T*r[15]-B+O*r[16]-C*r[17],w[k+13]=M+R,w[k+14]=M-R,j=S[8]-S[0],I=S[6]-S[2],H=S[5]-S[3],D=S[17]+S[9],V=S[16]+S[10],N=S[15]+S[11],Y=S[14]+S[12],w[k+0]=D+N+Y+(V+S[13]),M=(D+N+Y)*r[19]-(V+S[13]),R=(j-I+H)*r[18],w[k+11]=M+R,w[k+12]=M-R,L=(S[7]-S[1])*r[18],V=S[13]-V*r[19],M=D*r[15]-V+N*r[16]+Y*r[17],R=j*r[14]+L+I*r[12]+H*r[13],w[k+3]=M+R,w[k+4]=M-R,M=-D*r[17]+V-N*r[15]-Y*r[16],R=j*r[13]+L-I*r[14]-H*r[12],w[k+7]=M+R,w[k+8]=M-R,M=-D*r[16]+V-N*r[17]-Y*r[15],R=j*r[12]-L+I*r[13]-H*r[14],w[k+15]=M+R,w[k+16]=M-R}}if(ee!=U.SHORT_TYPE&&0!=G)for($=7;$>=0;--$){var se,ie;se=K[Q+$]*o[20+$]+K[Q+-1-$]*c[28+$],ie=K[Q+$]*c[28+$]-K[Q+-1-$]*o[20+$],K[Q+-1-$]=se,K[Q+$]=ie}}}if(X=y,F=286,1==e.mode_gr)for(var i=0;i<18;i++)v.arraycopy(e.sb_sample[W][1][i],0,e.sb_sample[W][0][i],0,32)}}}function K(){this.thm=new $,this.en=new $}function U(){var e=U.FFTOFFSET,t=U.MPG_MD_MS_LR,n=null;this.psy=null;var r=null,c=null,_=null;this.setModules=function(e,t,o,l){n=e,this.psy=t,r=t,c=l,_=o};var h=new Z;this.lame_encode_mp3_frame=function(m,y,w,k,R,x){var P,E=d([2,2]);E[0][0]=new K,E[0][1]=new K,E[1][0]=new K,E[1][1]=new K;var A,T=d([2,2]);T[0][0]=new K,T[0][1]=new K,T[1][0]=new K,T[1][1]=new K;var B,O,C,j=[null,null],L=m.internal_flags,I=f([2,4]),H=[.5,.5],D=[[0,0],[0,0]],V=[[0,0],[0,0]];if(j[0]=y,j[1]=w,0==L.lame_encode_frame_init&&function(e,t){var n,r,o=e.internal_flags;if(0==o.lame_encode_frame_init){var i,c,f=l(2014),_=l(2014);for(o.lame_encode_frame_init=1,i=0,c=0;i<286+576*(1+o.mode_gr);++i)i<576*o.mode_gr?(f[i]=0,2==o.channels_out&&(_[i]=0)):(f[i]=t[0][c],2==o.channels_out&&(_[i]=t[1][c]),++c);for(r=0;r<o.mode_gr;r++)for(n=0;n<o.channels_out;n++)o.l3_side.tt[r][n].block_type=U.SHORT_TYPE;h.mdct_sub48(o,f,_)}}(m,j),L.padding=0,(L.slot_lag-=L.frac_SpF)<0&&(L.slot_lag+=m.out_samplerate,L.padding=1),0!=L.psymodel){var N=[null,null],Y=0,X=o(2);for(C=0;C<L.mode_gr;C++){for(O=0;O<L.channels_out;O++)N[O]=j[O],Y=576+576*C-U.FFTOFFSET;if(0!=(m.VBR==S.vbr_mtrh||m.VBR==S.vbr_mt?r.L3psycho_anal_vbr(m,N,Y,C,E,T,D[C],V[C],I[C],X):r.L3psycho_anal_ns(m,N,Y,C,E,T,D[C],V[C],I[C],X)))return-4;for(m.mode==M.JOINT_STEREO&&(H[C]=I[C][2]+I[C][3],H[C]>0&&(H[C]=I[C][3]/H[C])),O=0;O<L.channels_out;O++){var F=L.l3_side.tt[C][O];F.block_type=X[O],F.mixed_block_flag=0}}}else for(C=0;C<L.mode_gr;C++)for(O=0;O<L.channels_out;O++)L.l3_side.tt[C][O].block_type=U.NORM_TYPE,L.l3_side.tt[C][O].mixed_block_flag=0,V[C][O]=D[C][O]=700;if(function(e){var t,n;if(0!=e.ATH.useAdjust)if(n=e.loudness_sq[0][0],t=e.loudness_sq[1][0],2==e.channels_out?(n+=e.loudness_sq[0][1],t+=e.loudness_sq[1][1]):(n+=n,t+=t),2==e.mode_gr&&(n=Math.max(n,t)),n*=.5,(n*=e.ATH.aaSensitivityP)>.03125)e.ATH.adjust>=1?e.ATH.adjust=1:e.ATH.adjust<e.ATH.adjustLimit&&(e.ATH.adjust=e.ATH.adjustLimit),e.ATH.adjustLimit=1;else{var r=31.98*n+625e-6;e.ATH.adjust>=r?(e.ATH.adjust*=.075*r+.925,e.ATH.adjust<r&&(e.ATH.adjust=r)):e.ATH.adjustLimit>=r?e.ATH.adjust=r:e.ATH.adjust<e.ATH.adjustLimit&&(e.ATH.adjust=e.ATH.adjustLimit),e.ATH.adjustLimit=r}else e.ATH.adjust=1}(L),h.mdct_sub48(L,j[0],j[1]),L.mode_ext=U.MPG_MD_LR_LR,m.force_ms)L.mode_ext=U.MPG_MD_MS_LR;else if(m.mode==M.JOINT_STEREO){var W=0,z=0;for(C=0;C<L.mode_gr;C++)for(O=0;O<L.channels_out;O++)W+=V[C][O],z+=D[C][O];if(W<=1*z){var G=L.l3_side.tt[0],Z=L.l3_side.tt[L.mode_gr-1];G[0].block_type==G[1].block_type&&Z[0].block_type==Z[1].block_type&&(L.mode_ext=U.MPG_MD_MS_LR)}}if(L.mode_ext==t?(A=T,B=V):(A=E,B=D),m.analysis&&null!=L.pinfo)for(C=0;C<L.mode_gr;C++)for(O=0;O<L.channels_out;O++)L.pinfo.ms_ratio[C]=L.ms_ratio[C],L.pinfo.ms_ener_ratio[C]=H[C],L.pinfo.blocktype[C][O]=L.l3_side.tt[C][O].block_type,L.pinfo.pe[C][O]=B[C][O],v.arraycopy(L.l3_side.tt[C][O].xr,0,L.pinfo.xr[C][O],0,576),L.mode_ext==t&&(L.pinfo.ers[C][O]=L.pinfo.ers[C][O+2],v.arraycopy(L.pinfo.energy[C][O+2],0,L.pinfo.energy[C][O],0,L.pinfo.energy[C][O].length));if(m.VBR==S.vbr_off||m.VBR==S.vbr_abr){var i,Q;for(i=0;i<18;i++)L.nsPsy.pefirbuf[i]=L.nsPsy.pefirbuf[i+1];for(Q=0,C=0;C<L.mode_gr;C++)for(O=0;O<L.channels_out;O++)Q+=B[C][O];for(L.nsPsy.pefirbuf[18]=Q,Q=L.nsPsy.pefirbuf[9],i=0;i<9;i++)Q+=(L.nsPsy.pefirbuf[i]+L.nsPsy.pefirbuf[18-i])*U.fircoef[i];for(Q=3350*L.mode_gr*L.channels_out/Q,C=0;C<L.mode_gr;C++)for(O=0;O<L.channels_out;O++)B[C][O]*=Q}if(L.iteration_loop.iteration_loop(m,B,H,A),n.format_bitstream(m),P=n.copy_buffer(L,k,R,x,1),m.bWriteVbrTag&&c.addVbrFrame(m),m.analysis&&null!=L.pinfo){for(O=0;O<L.channels_out;O++){var J;for(J=0;J<e;J++)L.pinfo.pcmdata[O][J]=L.pinfo.pcmdata[O][J+m.framesize];for(J=e;J<1600;J++)L.pinfo.pcmdata[O][J]=j[O][J-e]}_.set_frame_pinfo(m,A)}return function(e){var t,n;for(e.bitrate_stereoMode_Hist[e.bitrate_index][4]++,e.bitrate_stereoMode_Hist[15][4]++,2==e.channels_out&&(e.bitrate_stereoMode_Hist[e.bitrate_index][e.mode_ext]++,e.bitrate_stereoMode_Hist[15][e.mode_ext]++),t=0;t<e.mode_gr;++t)for(n=0;n<e.channels_out;++n){var r=0|e.l3_side.tt[t][n].block_type;0!=e.l3_side.tt[t][n].mixed_block_flag&&(r=4),e.bitrate_blockType_Hist[e.bitrate_index][r]++,e.bitrate_blockType_Hist[e.bitrate_index][5]++,e.bitrate_blockType_Hist[15][r]++,e.bitrate_blockType_Hist[15][5]++}}(L),P}}function Q(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}function J(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[o(4),o(4)];for(var e=0;e<2;e++)for(var t=0;t<2;t++)this.tt[e][t]=new W}function $(){this.l=l(U.SBMAX_l),this.s=f([U.SBMAX_s,3]);var e=this;this.assign=function(t){v.arraycopy(t.l,0,e.l,0,U.SBMAX_l);for(var i=0;i<U.SBMAX_s;i++)for(var n=0;n<3;n++)e.s[i][n]=t.s[i][n]}}function ee(){this.last_en_subshort=f([4,9]),this.lastAttacks=o(4),this.pefirbuf=l(19),this.longfact=l(U.SBMAX_l),this.shortfact=l(U.SBMAX_s),this.attackthre=0,this.attackthre_s=0}function te(){var e=40;function t(){this.write_timing=0,this.ptr=0,this.buf=n(e)}this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=f([2,te.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new J,this.ms_ratio=l(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=o(2),this.CurrentStep=o(2),this.masking_lower=0,this.bv_scf=o(576),this.pseudohalf=o(z.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*te.BPC+1),this.itime=c(2),this.sideinfo_len=0,this.sb_sample=f([2,2,18,U.SBLIMIT]),this.amp_filter=l(32),this.header=new Array(te.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new Y,this.minval_l=l(U.CBANDS),this.minval_s=l(U.CBANDS),this.nb_1=f([4,U.CBANDS]),this.nb_2=f([4,U.CBANDS]),this.nb_s1=f([4,U.CBANDS]),this.nb_s2=f([4,U.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=l(4),this.loudness_sq=f([2,2]),this.loudness_sq_save=l(2),this.mld_l=l(U.SBMAX_l),this.mld_s=l(U.SBMAX_s),this.bm_l=o(U.SBMAX_l),this.bo_l=o(U.SBMAX_l),this.bm_s=o(U.SBMAX_s),this.bo_s=o(U.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=_([U.CBANDS,2]),this.s3ind_s=_([U.CBANDS,2]),this.numlines_s=o(U.CBANDS),this.numlines_l=o(U.CBANDS),this.rnumlines_l=l(U.CBANDS),this.mld_cb_l=l(U.CBANDS),this.mld_cb_s=l(U.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=l(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=o(2),this.nsPsy=new ee,this.VBR_seek_table=new Q,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=_([16,5]),this.bitrate_blockType_Hist=_([16,6]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var i=0;i<this.en.length;i++)this.en[i]=new $;for(i=0;i<this.thm.length;i++)this.thm[i]=new $;for(i=0;i<this.header.length;i++)this.header[i]=new t}function ae(){var e=l(U.BLKSIZE),t=l(U.BLKSIZE_s/2),n=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475];function r(e,t,r){var o,l,c,f=0,_=t+(r<<=1);o=4;do{var h,d,i,m,v,w,k;k=o>>1,w=(v=o<<1)+(m=o),o=v<<1,c=(l=t)+k;do{P=e[l+0]-e[l+m],x=e[l+0]+e[l+m],B=e[l+v]-e[l+w],A=e[l+v]+e[l+w],e[l+v]=x-A,e[l+0]=x+A,e[l+w]=P-B,e[l+m]=P+B,P=e[c+0]-e[c+m],x=e[c+0]+e[c+m],B=y.SQRT2*e[c+w],A=y.SQRT2*e[c+v],e[c+v]=x-A,e[c+0]=x+A,e[c+w]=P-B,e[c+m]=P+B,c+=o,l+=o}while(l<_);for(d=n[f+0],h=n[f+1],i=1;i<k;i++){var S,M;S=1-2*h*h,M=2*h*d,l=t+i,c=t+m-i;do{var a,b,R,x,P,E,A,T,B,O;b=M*e[l+m]-S*e[c+m],a=S*e[l+m]+M*e[c+m],P=e[l+0]-a,x=e[l+0]+a,E=e[c+0]-b,R=e[c+0]+b,b=M*e[l+w]-S*e[c+w],a=S*e[l+w]+M*e[c+w],B=e[l+v]-a,A=e[l+v]+a,O=e[c+v]-b,T=e[c+v]+b,b=h*A-d*O,a=d*A+h*O,e[l+v]=x-a,e[l+0]=x+a,e[c+w]=E-b,e[c+m]=E+b,b=d*T-h*B,a=h*T+d*B,e[c+v]=R-a,e[c+0]=R+a,e[l+w]=P-b,e[l+m]=P+b,c+=o,l+=o}while(l<_);d=(S=d)*n[f+0]-h*n[f+1],h=S*n[f+1]+h*n[f+0]}f+=2}while(o<r)}var o=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(e,n,l,c,f){for(var b=0;b<3;b++){var _=U.BLKSIZE_s/2,h=65535&192*(b+1),d=U.BLKSIZE_s/8-1;do{var m,v,y,w,k,i=255&o[d<<2];v=(m=t[i]*c[l][f+i+h])-(k=t[127-i]*c[l][f+i+h+128]),m+=k,w=(y=t[i+64]*c[l][f+i+h+64])-(k=t[63-i]*c[l][f+i+h+192]),y+=k,_-=4,n[b][_+0]=m+y,n[b][_+2]=m-y,n[b][_+1]=v+w,n[b][_+3]=v-w,v=(m=t[i+1]*c[l][f+i+h+1])-(k=t[126-i]*c[l][f+i+h+129]),m+=k,w=(y=t[i+65]*c[l][f+i+h+65])-(k=t[62-i]*c[l][f+i+h+193]),y+=k,n[b][_+U.BLKSIZE_s/2+0]=m+y,n[b][_+U.BLKSIZE_s/2+2]=m-y,n[b][_+U.BLKSIZE_s/2+1]=v+w,n[b][_+U.BLKSIZE_s/2+3]=v-w}while(--d>=0);r(n[b],_,U.BLKSIZE_s/2)}},this.fft_long=function(t,n,l,c,f){var _=U.BLKSIZE/8-1,h=U.BLKSIZE/2;do{var d,m,v,y,w,i=255&o[_];m=(d=e[i]*c[l][f+i])-(w=e[i+512]*c[l][f+i+512]),d+=w,y=(v=e[i+256]*c[l][f+i+256])-(w=e[i+768]*c[l][f+i+768]),v+=w,n[(h-=4)+0]=d+v,n[h+2]=d-v,n[h+1]=m+y,n[h+3]=m-y,m=(d=e[i+1]*c[l][f+i+1])-(w=e[i+513]*c[l][f+i+513]),d+=w,y=(v=e[i+257]*c[l][f+i+257])-(w=e[i+769]*c[l][f+i+769]),v+=w,n[h+U.BLKSIZE/2+0]=d+v,n[h+U.BLKSIZE/2+2]=d-v,n[h+U.BLKSIZE/2+1]=m+y,n[h+U.BLKSIZE/2+3]=m-y}while(--_>=0);r(n,h,U.BLKSIZE/2)},this.init_fft=function(n){for(var i=0;i<U.BLKSIZE;i++)e[i]=.42-.5*Math.cos(2*Math.PI*(i+.5)/U.BLKSIZE)+.08*Math.cos(4*Math.PI*(i+.5)/U.BLKSIZE);for(i=0;i<U.BLKSIZE_s/2;i++)t[i]=.5*(1-Math.cos(2*Math.PI*(i+.5)/U.BLKSIZE_s))}}function ne(){var e=new ae,t=2.302585092994046,n=2,r=16,c=2,_=16,h=.34,d=1/217621504/(U.BLKSIZE/2),v=.3,R=21,x=.2302585093;function P(e){return e}function E(e,t){for(var n=0,i=0;i<U.BLKSIZE/2;++i)n+=e[i]*t.ATH.eql_w[i];return n*=d}function A(t,n,r,o,l,c,f,_,h,d,m){var v=t.internal_flags;if(h<2)e.fft_long(v,o[l],h,d,m),e.fft_short(v,c[f],h,d,m);else if(2==h){for(var w=U.BLKSIZE-1;w>=0;--w){var k=o[l+0][w],S=o[l+1][w];o[l+0][w]=(k+S)*y.SQRT2*.5,o[l+1][w]=(k-S)*y.SQRT2*.5}for(var b=2;b>=0;--b)for(w=U.BLKSIZE_s-1;w>=0;--w){k=c[f+0][b][w],S=c[f+1][b][w];c[f+0][b][w]=(k+S)*y.SQRT2*.5,c[f+1][b][w]=(k-S)*y.SQRT2*.5}}n[0]=P(o[l+0][0]),n[0]*=n[0];for(w=U.BLKSIZE/2-1;w>=0;--w){var M=o[l+0][U.BLKSIZE/2-w],R=o[l+0][U.BLKSIZE/2+w];n[U.BLKSIZE/2-w]=P(.5*(M*M+R*R))}for(b=2;b>=0;--b){r[b][0]=c[f+0][b][0],r[b][0]*=r[b][0];for(w=U.BLKSIZE_s/2-1;w>=0;--w){M=c[f+0][b][U.BLKSIZE_s/2-w],R=c[f+0][b][U.BLKSIZE_s/2+w];r[b][U.BLKSIZE_s/2-w]=P(.5*(M*M+R*R))}}var x=0;for(w=11;w<U.HBLKSIZE;w++)x+=n[w];if(v.tot_ener[h]=x,t.analysis){for(w=0;w<U.HBLKSIZE;w++)v.pinfo.energy[_][h][w]=v.pinfo.energy_save[h][w],v.pinfo.energy_save[h][w]=n[w];v.pinfo.pe[_][h]=v.pe[h]}2==t.athaa_loudapprox&&h<2&&(v.loudness_sq[_][h]=v.loudness_sq_save[h],v.loudness_sq_save[h]=E(n,v))}var T,B,O,C=8,j=23,L=15,I=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749];var H=[3.3246*3.3246,3.23837*3.23837,9.9500500969,9.0247369744,8.1854926609,7.0440875649,2.46209*2.46209,2.284*2.284,4.4892710641,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,2.4621061921,2.1508568964,1.37074*1.37074,1.31036*1.31036,1.5691069696,1.4555939904,1.16203*1.16203,1.2715945225,1.09428*1.09428,1.0659*1.0659,1.0779838276,1.0382591025,1],D=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1],V=[5.5396212496,2.29259*2.29259,4.9868695969,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,2.2499700001,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.2339655056,1.0779838276];function N(e,t,n,b,r,o){var l;if(t>e){if(!(t<e*B))return e+t;l=t/e}else{if(e>=t*B)return e+t;l=e/t}if(e+=t,b+3<=6){if(l>=T)return e;var i=0|y.FAST_LOG10_X(l,16);return e*D[i]}var c,f;i=0|y.FAST_LOG10_X(l,16);return t=0!=o?r.ATH.cb_s[n]*r.ATH.adjust:r.ATH.cb_l[n]*r.ATH.adjust,e<O*t?e>t?(c=1,i<=13&&(c=V[i]),f=y.FAST_LOG10_X(e/t,10/15),e*((H[i]-c)*f+c)):i>13?e:e*V[i]:e*H[i]}var Y=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1];function X(e,t,b){var n;if(e<0&&(e=0),t<0&&(t=0),e<=0)return t;if(t<=0)return e;if(n=t>e?t/e:e/t,-2<=b&&b<=2){if(n>=T)return e+t;var i=0|y.FAST_LOG10_X(n,16);return(e+t)*Y[i]}return n<B?e+t:(e<t&&(e=t),e)}function F(e,t,n,r,o){var l,b,c=0,f=0;for(l=b=0;l<U.SBMAX_s;++b,++l){for(var _=e.bo_s[l],h=e.npart_s,d=_<h?_:h;b<d;)c+=t[b],f+=n[b],b++;if(e.en[r].s[l][o]=c,e.thm[r].s[l][o]=f,b>=h){++l;break}var m=e.PSY.bo_s_weight[l],v=1-m;c=m*t[b],f=m*n[b],e.en[r].s[l][o]+=c,e.thm[r].s[l][o]+=f,c=v*t[b],f=v*n[b]}for(;l<U.SBMAX_s;++l)e.en[r].s[l][o]=0,e.thm[r].s[l][o]=0}function W(e,t,n,r){var o,b,l=0,c=0;for(o=b=0;o<U.SBMAX_l;++b,++o){for(var f=e.bo_l[o],_=e.npart_l,h=f<_?f:_;b<h;)l+=t[b],c+=n[b],b++;if(e.en[r].l[o]=l,e.thm[r].l[o]=c,b>=_){++o;break}var d=e.PSY.bo_l_weight[o],m=1-d;l=d*t[b],c=d*n[b],e.en[r].l[o]+=l,e.thm[r].l[o]+=c,l=m*t[b],c=m*n[b]}for(;o<U.SBMAX_l;++o)e.en[r].l[o]=0,e.thm[r].l[o]=0}function z(e,t,n,r,o,l){var f,b,h=e.internal_flags;for(b=f=0;b<h.npart_s;++b){for(var d=0,m=0,v=h.numlines_s[b],i=0;i<v;++i,++f){var y=t[l][f];d+=y,m<y&&(m=y)}n[b]=d}for(f=b=0;b<h.npart_s;b++){var w=h.s3ind_s[b][0],k=h.s3_ss[f++]*n[w];for(++w;w<=h.s3ind_s[b][1];)k+=h.s3_ss[f]*n[w],++f,++w;var S=c*h.nb_s1[o][b];if(r[b]=Math.min(k,S),h.blocktype_old[1&o]==U.SHORT_TYPE){S=_*h.nb_s2[o][b];var M=r[b];r[b]=Math.min(S,M)}h.nb_s2[o][b]=h.nb_s1[o][b],h.nb_s1[o][b]=k}for(;b<=U.CBANDS;++b)n[b]=0,r[b]=0}function G(e,t,n){return n>=1?e:n<=0?t:t>0?Math.pow(e/t,n)*t:0}var Z=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130];function K(e,n){for(var r=309.07,o=0;o<U.SBMAX_s-1;o++)for(var l=0;l<3;l++){var c=e.thm.s[o][l];if(c>0){var f=c*n,_=e.en.s[o][l];_>f&&(r+=_>1e10*f?Z[o]*(10*t):Z[o]*y.FAST_LOG10(_/f))}}return r}var Q=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1];function J(e,n){for(var r=281.0575,o=0;o<U.SBMAX_l-1;o++){var l=e.thm.l[o];if(l>0){var c=l*n,f=e.en.l[o];f>c&&(r+=f>1e10*c?Q[o]*(10*t):Q[o]*y.FAST_LOG10(f/c))}}return r}function $(e,t,n,r,o){var b,l;for(b=l=0;b<e.npart_l;++b){var i,c=0,f=0;for(i=0;i<e.numlines_l[b];++i,++l){var _=t[l];c+=_,f<_&&(f=_)}n[b]=c,r[b]=f,o[b]=c*e.rnumlines_l[b]}}function ee(e,t,n,r){var o=I.length-1,b=0,a=n[b]+n[b+1];a>0?((l=t[b])<t[b+1]&&(l=t[b+1]),(c=0|(a=20*(2*l-a)/(a*(e.numlines_l[b]+e.numlines_l[b+1]-1))))>o&&(c=o),r[b]=c):r[b]=0;for(b=1;b<e.npart_l-1;b++){var l,c;if((a=n[b-1]+n[b]+n[b+1])>0)(l=t[b-1])<t[b]&&(l=t[b]),l<t[b+1]&&(l=t[b+1]),(c=0|(a=20*(3*l-a)/(a*(e.numlines_l[b-1]+e.numlines_l[b]+e.numlines_l[b+1]-1))))>o&&(c=o),r[b]=c;else r[b]=0}(a=n[b-1]+n[b])>0?((l=t[b-1])<t[b]&&(l=t[b]),(c=0|(a=20*(2*l-a)/(a*(e.numlines_l[b-1]+e.numlines_l[b]-1))))>o&&(c=o),r[b]=c):r[b]=0}var te=[-1730326e-23,-.01703172,-1349528e-23,.0418072,-673278e-22,-.0876324,-30835e-21,.1863476,-1104424e-22,-.627638];function ne(t,n,r,o,l,c,f,_){var h=t.internal_flags;if(o<2)e.fft_long(h,f[_],o,n,r);else if(2==o)for(var d=U.BLKSIZE-1;d>=0;--d){var m=f[_+0][d],v=f[_+1][d];f[_+0][d]=(m+v)*y.SQRT2*.5,f[_+1][d]=(m-v)*y.SQRT2*.5}c[0]=P(f[_+0][0]),c[0]*=c[0];for(d=U.BLKSIZE/2-1;d>=0;--d){var w=f[_+0][U.BLKSIZE/2-d],k=f[_+0][U.BLKSIZE/2+d];c[U.BLKSIZE/2-d]=P(.5*(w*w+k*k))}var S=0;for(d=11;d<U.HBLKSIZE;d++)S+=c[d];if(h.tot_ener[o]=S,t.analysis){for(d=0;d<U.HBLKSIZE;d++)h.pinfo.energy[l][o][d]=h.pinfo.energy_save[o][d],h.pinfo.energy_save[o][d]=c[d];h.pinfo.pe[l][o]=h.pe[o]}}function re(t,n,r,o,l,c,f,_){var h=t.internal_flags;if(0==l&&o<2&&e.fft_short(h,f[_],o,n,r),2==o)for(var d=U.BLKSIZE_s-1;d>=0;--d){var m=f[_+0][l][d],v=f[_+1][l][d];f[_+0][l][d]=(m+v)*y.SQRT2*.5,f[_+1][l][d]=(m-v)*y.SQRT2*.5}c[l][0]=f[_+0][l][0],c[l][0]*=c[l][0];for(d=U.BLKSIZE_s/2-1;d>=0;--d){var w=f[_+0][l][U.BLKSIZE_s/2-d],k=f[_+0][l][U.BLKSIZE_s/2+d];c[l][U.BLKSIZE_s/2-d]=P(.5*(w*w+k*k))}}function se(e,t,n,r){var o=e.internal_flags;2==e.athaa_loudapprox&&n<2&&(o.loudness_sq[t][n]=o.loudness_sq_save[n],o.loudness_sq_save[n]=E(r,o))}this.L3psycho_anal_ns=function(e,t,c,_,h,d,y,k,x,P){var E,T,b,i,B,O,C,j,L,H,D=e.internal_flags,V=f([2,U.BLKSIZE]),Y=f([2,3,U.BLKSIZE_s]),X=l(U.CBANDS+1),Z=l(U.CBANDS+1),Q=l(U.CBANDS+2),ae=o(2),ne=o(2),re=f([2,576]),se=o(U.CBANDS+2),ie=o(U.CBANDS+2);for(m.fill(ie,0),E=D.channels_out,e.mode==M.JOINT_STEREO&&(E=4),L=e.VBR==S.vbr_off?0==D.ResvMax?0:D.ResvSize/D.ResvMax*.5:e.VBR==S.vbr_rh||e.VBR==S.vbr_mtrh||e.VBR==S.vbr_mt?.6:1,T=0;T<D.channels_out;T++){var oe=t[T],le=c+576-350-R+192;for(i=0;i<576;i++){var ue,ce;for(ue=oe[le+i+10],ce=0,B=0;B<(R-1)/2-1;B+=2)ue+=te[B]*(oe[le+i+B]+oe[le+i+R-B]),ce+=te[B+1]*(oe[le+i+B+1]+oe[le+i+R-B-1]);re[T][i]=ue+ce}h[_][T].en.assign(D.en[T]),h[_][T].thm.assign(D.thm[T]),E>2&&(d[_][T].en.assign(D.en[T+2]),d[_][T].thm.assign(D.thm[T+2]))}for(T=0;T<E;T++){var fe,_e=l(12),he=[0,0,0,0],pe=l(12),de=1,me=l(U.CBANDS),be=l(U.CBANDS),ve=[0,0,0,0],ge=l(U.HBLKSIZE),ye=f([3,U.HBLKSIZE_s]);for(i=0;i<3;i++)_e[i]=D.nsPsy.last_en_subshort[T][i+6],pe[i]=_e[i]/D.nsPsy.last_en_subshort[T][i+4],he[0]+=_e[i];if(2==T)for(i=0;i<576;i++){var we,ke;we=re[0][i],ke=re[1][i],re[0][i]=we+ke,re[1][i]=we-ke}var Se=re[1&T],Me=0;for(i=0;i<9;i++){for(var Re=Me+64,p=1;Me<Re;Me++)p<Math.abs(Se[Me])&&(p=Math.abs(Se[Me]));D.nsPsy.last_en_subshort[T][i]=_e[i+3]=p,he[1+i/3]+=p,p>_e[i+3-2]?p/=_e[i+3-2]:p=_e[i+3-2]>10*p?_e[i+3-2]/(10*p):0,pe[i+3]=p}if(e.analysis){var xe=pe[0];for(i=1;i<12;i++)xe<pe[i]&&(xe=pe[i]);D.pinfo.ers[_][T]=D.pinfo.ers_save[T],D.pinfo.ers_save[T]=xe}for(fe=3==T?D.nsPsy.attackthre_s:D.nsPsy.attackthre,i=0;i<12;i++)0==ve[i/3]&&pe[i]>fe&&(ve[i/3]=i%3+1);for(i=1;i<4;i++){(he[i-1]>he[i]?he[i-1]/he[i]:he[i]/he[i-1])<1.7&&(ve[i]=0,1==i&&(ve[0]=0))}for(0!=ve[0]&&0!=D.nsPsy.lastAttacks[T]&&(ve[0]=0),3!=D.nsPsy.lastAttacks[T]&&ve[0]+ve[1]+ve[2]+ve[3]==0||(de=0,0!=ve[1]&&0!=ve[0]&&(ve[1]=0),0!=ve[2]&&0!=ve[1]&&(ve[2]=0),0!=ve[3]&&0!=ve[2]&&(ve[3]=0)),T<2?ne[T]=de:0==de&&(ne[0]=ne[1]=0),x[T]=D.tot_ener[T],A(e,ge,ye,V,1&T,Y,1&T,_,T,t,c),$(D,ge,X,me,be),ee(D,me,be,se),j=0;j<3;j++){var Pe,Ee;for(z(e,ye,Z,Q,T,j),F(D,Z,Q,T,j),C=0;C<U.SBMAX_s;C++){if(Ee=D.thm[T].s[C][j],Ee*=.8,ve[j]>=2||1==ve[j+1]){var Ae=0!=j?j-1:2;p=G(D.thm[T].s[C][Ae],Ee,.6*L);Ee=Math.min(Ee,p)}if(1==ve[j]){Ae=0!=j?j-1:2,p=G(D.thm[T].s[C][Ae],Ee,v*L);Ee=Math.min(Ee,p)}else if(0!=j&&3==ve[j-1]||0==j&&3==D.nsPsy.lastAttacks[T]){Ae=2!=j?j+1:0,p=G(D.thm[T].s[C][Ae],Ee,v*L);Ee=Math.min(Ee,p)}Pe=_e[3*j+3]+_e[3*j+4]+_e[3*j+5],6*_e[3*j+5]<Pe&&(Ee*=.5,6*_e[3*j+4]<Pe&&(Ee*=.5)),D.thm[T].s[C][j]=Ee}}for(D.nsPsy.lastAttacks[T]=ve[2],O=0,b=0;b<D.npart_l;b++){for(var Te=D.s3ind[b][0],Be=X[Te]*I[se[Te]],Oe=D.s3_ll[O++]*Be;++Te<=D.s3ind[b][1];)Be=X[Te]*I[se[Te]],Oe=N(Oe,D.s3_ll[O++]*Be,Te,Te-b,D,0);Oe*=.158489319246111,D.blocktype_old[1&T]==U.SHORT_TYPE?Q[b]=Oe:Q[b]=G(Math.min(Oe,Math.min(n*D.nb_1[T][b],r*D.nb_2[T][b])),Oe,L),D.nb_2[T][b]=D.nb_1[T][b],D.nb_1[T][b]=Oe}for(;b<=U.CBANDS;++b)X[b]=0,Q[b]=0;W(D,X,Q,T)}(e.mode!=M.STEREO&&e.mode!=M.JOINT_STEREO||e.interChRatio>0&&function(e,t){var n=e.internal_flags;if(n.channels_out>1){for(var r=0;r<U.SBMAX_l;r++){var o=n.thm[0].l[r],l=n.thm[1].l[r];n.thm[0].l[r]+=l*t,n.thm[1].l[r]+=o*t}for(r=0;r<U.SBMAX_s;r++)for(var c=0;c<3;c++){o=n.thm[0].s[r][c],l=n.thm[1].s[r][c];n.thm[0].s[r][c]+=l*t,n.thm[1].s[r][c]+=o*t}}}(e,e.interChRatio),e.mode==M.JOINT_STEREO)&&(!function(e){for(var t=0;t<U.SBMAX_l;t++)if(!(e.thm[0].l[t]>1.58*e.thm[1].l[t]||e.thm[1].l[t]>1.58*e.thm[0].l[t])){var n=e.mld_l[t]*e.en[3].l[t],r=Math.max(e.thm[2].l[t],Math.min(e.thm[3].l[t],n));n=e.mld_l[t]*e.en[2].l[t];var o=Math.max(e.thm[3].l[t],Math.min(e.thm[2].l[t],n));e.thm[2].l[t]=r,e.thm[3].l[t]=o}for(t=0;t<U.SBMAX_s;t++)for(var l=0;l<3;l++)if(!(e.thm[0].s[t][l]>1.58*e.thm[1].s[t][l]||e.thm[1].s[t][l]>1.58*e.thm[0].s[t][l])){n=e.mld_s[t]*e.en[3].s[t][l],r=Math.max(e.thm[2].s[t][l],Math.min(e.thm[3].s[t][l],n));n=e.mld_s[t]*e.en[2].s[t][l];o=Math.max(e.thm[3].s[t][l],Math.min(e.thm[2].s[t][l],n));e.thm[2].s[t][l]=r,e.thm[3].s[t][l]=o}}(D),H=e.msfix,Math.abs(H)>0&&function(e,t,n){var r=t,o=Math.pow(10,n);t*=2,r*=2;for(var l=0;l<U.SBMAX_l;l++){if(d=e.ATH.cb_l[e.bm_l[l]]*o,(f=Math.min(Math.max(e.thm[0].l[l],d),Math.max(e.thm[1].l[l],d)))*t<(_=Math.max(e.thm[2].l[l],d))+(h=Math.max(e.thm[3].l[l],d)))_*=m=f*r/(_+h),h*=m;e.thm[2].l[l]=Math.min(_,e.thm[2].l[l]),e.thm[3].l[l]=Math.min(h,e.thm[3].l[l])}for(o*=U.BLKSIZE_s/U.BLKSIZE,l=0;l<U.SBMAX_s;l++)for(var c=0;c<3;c++){var f,_,h,d,m;if(d=e.ATH.cb_s[e.bm_s[l]]*o,(f=Math.min(Math.max(e.thm[0].s[l][c],d),Math.max(e.thm[1].s[l][c],d)))*t<(_=Math.max(e.thm[2].s[l][c],d))+(h=Math.max(e.thm[3].s[l][c],d)))_*=m=f*t/(_+h),h*=m;e.thm[2].s[l][c]=Math.min(e.thm[2].s[l][c],_),e.thm[3].s[l][c]=Math.min(e.thm[3].s[l][c],h)}}(D,H,e.ATHlower*D.ATH.adjust));for(function(e,t,n,r){var o=e.internal_flags;e.short_blocks!=w.short_block_coupled||0!=t[0]&&0!=t[1]||(t[0]=t[1]=0);for(var l=0;l<o.channels_out;l++)r[l]=U.NORM_TYPE,e.short_blocks==w.short_block_dispensed&&(t[l]=1),e.short_blocks==w.short_block_forced&&(t[l]=0),0!=t[l]?o.blocktype_old[l]==U.SHORT_TYPE&&(r[l]=U.STOP_TYPE):(r[l]=U.SHORT_TYPE,o.blocktype_old[l]==U.NORM_TYPE&&(o.blocktype_old[l]=U.START_TYPE),o.blocktype_old[l]==U.STOP_TYPE&&(o.blocktype_old[l]=U.SHORT_TYPE)),n[l]=o.blocktype_old[l],o.blocktype_old[l]=r[l]}(e,ne,P,ae),T=0;T<E;T++){var Ce,je,Le,Ie=0;T>1?(Ce=k,Ie=-2,je=U.NORM_TYPE,P[0]!=U.SHORT_TYPE&&P[1]!=U.SHORT_TYPE||(je=U.SHORT_TYPE),Le=d[_][T-2]):(Ce=y,Ie=0,je=P[T],Le=h[_][T]),je==U.SHORT_TYPE?Ce[Ie+T]=K(Le,D.masking_lower):Ce[Ie+T]=J(Le,D.masking_lower),e.analysis&&(D.pinfo.pe[_][T]=Ce[Ie+T])}return 0};var ie=[-1730326e-23,-.01703172,-1349528e-23,.0418072,-673278e-22,-.0876324,-30835e-21,.1863476,-1104424e-22,-.627638];function oe(e,t,n){if(0==n)for(var b=0;b<e.npart_s;b++)e.nb_s2[t][b]=e.nb_s1[t][b],e.nb_s1[t][b]=0}function le(e,t){for(var b=0;b<e.npart_l;b++)e.nb_2[t][b]=e.nb_1[t][b],e.nb_1[t][b]=0}function ue(e,t,n,r,o,c){var i,f,b,_=e.internal_flags,h=new float[U.CBANDS],d=l(U.CBANDS),m=new int[U.CBANDS];for(b=f=0;b<_.npart_s;++b){var v=0,y=0,w=_.numlines_s[b];for(i=0;i<w;++i,++f){var k=t[c][f];v+=k,y<k&&(y=k)}n[b]=v,h[b]=y,d[b]=v/w}for(;b<U.CBANDS;++b)h[b]=0,d[b]=0;for(function(e,t,n,r){var o=I.length-1,b=0,a=n[b]+n[b+1];for(a>0?((l=t[b])<t[b+1]&&(l=t[b+1]),(c=0|(a=20*(2*l-a)/(a*(e.numlines_s[b]+e.numlines_s[b+1]-1))))>o&&(c=o),r[b]=c):r[b]=0,b=1;b<e.npart_s-1;b++){var l,c;if((a=n[b-1]+n[b]+n[b+1])>0)(l=t[b-1])<t[b]&&(l=t[b]),l<t[b+1]&&(l=t[b+1]),(c=0|(a=20*(3*l-a)/(a*(e.numlines_s[b-1]+e.numlines_s[b]+e.numlines_s[b+1]-1))))>o&&(c=o),r[b]=c;else r[b]=0}(a=n[b-1]+n[b])>0?((l=t[b-1])<t[b]&&(l=t[b]),(c=0|(a=20*(2*l-a)/(a*(e.numlines_s[b-1]+e.numlines_s[b]-1))))>o&&(c=o),r[b]=c):r[b]=0}(_,h,d,m),f=b=0;b<_.npart_s;b++){var dd,S,M,R,x,P=_.s3ind_s[b][0],E=_.s3ind_s[b][1];for(dd=m[P],S=1,R=_.s3_ss[f]*n[P]*I[m[P]],++f,++P;P<=E;)dd+=m[P],S+=1,R=X(R,M=_.s3_ss[f]*n[P]*I[m[P]],P-b),++f,++P;R*=x=.5*I[dd=(1+2*dd)/(2*S)],r[b]=R,_.nb_s2[o][b]=_.nb_s1[o][b],_.nb_s1[o][b]=R,M=h[b],M*=_.minval_s[b],M*=x,r[b]>M&&(r[b]=M),_.masking_lower>1&&(r[b]*=_.masking_lower),r[b]>n[b]&&(r[b]=n[b]),_.masking_lower<1&&(r[b]*=_.masking_lower)}for(;b<U.CBANDS;++b)n[b]=0,r[b]=0}function ce(e,t,c,f,_){var b,h=l(U.CBANDS),d=l(U.CBANDS),m=o(U.CBANDS+2);$(e,t,c,h,d),ee(e,h,d,m);var y=0;for(b=0;b<e.npart_l;b++){var w,k,S,M=e.s3ind[b][0],R=e.s3ind[b][1],dd=0,x=0;for(dd=m[M],x+=1,k=e.s3_ll[y]*c[M]*I[m[M]],++y,++M;M<=R;)dd+=m[M],x+=1,k=X(k,w=e.s3_ll[y]*c[M]*I[m[M]],M-b),++y,++M;if(k*=S=.5*I[dd=(1+2*dd)/(2*x)],e.blocktype_old[1&_]==U.SHORT_TYPE){var P=n*e.nb_1[_][b];f[b]=P>0?Math.min(k,P):Math.min(k,c[b]*v)}else{var E=r*e.nb_2[_][b],A=n*e.nb_1[_][b];E<=0&&(E=k),A<=0&&(A=k),P=e.blocktype_old[1&_]==U.NORM_TYPE?Math.min(A,E):A,f[b]=Math.min(k,P)}e.nb_2[_][b]=e.nb_1[_][b],e.nb_1[_][b]=k,w=h[b],w*=e.minval_l[b],w*=S,f[b]>w&&(f[b]=w),e.masking_lower>1&&(f[b]*=e.masking_lower),f[b]>c[b]&&(f[b]=c[b]),e.masking_lower<1&&(f[b]*=e.masking_lower)}for(;b<U.CBANDS;++b)c[b]=0,f[b]=0}function fe(e,t,n,r,o,l,c){for(var f,_,h=2*l,d=l>0?Math.pow(10,o):1,b=0;b<c;++b){var m=e[2][b],v=e[3][b],y=t[0][b],w=t[1][b],k=t[2][b],S=t[3][b];if(y<=1.58*w&&w<=1.58*y){var M=n[b]*v,R=n[b]*m;_=Math.max(k,Math.min(S,M)),f=Math.max(S,Math.min(k,R))}else _=k,f=S;if(l>0){var x,P,E=r[b]*d;if(x=Math.min(Math.max(y,E),Math.max(w,E)),(P=(k=Math.max(_,E))+(S=Math.max(f,E)))>0&&x*h<P){var A=x*h/P;k*=A,S*=A}_=Math.min(k,_),f=Math.min(S,f)}_>m&&(_=m),f>v&&(f=v),t[2][b]=_,t[3][b]=f}}function _e(e,t){var n;return(n=e>=0?27*-e:e*t)<=-72?0:Math.exp(n*x)}function he(e){var t,n,r=0;for(r=0;_e(r,e)>1e-20;r-=1);for(o=r,l=0;Math.abs(l-o)>1e-12;)_e(r=(l+o)/2,e)>0?l=r:o=r;t=o;var o,l;r=0;for(r=0;_e(r,e)>1e-20;r+=1);for(o=0,l=r;Math.abs(l-o)>1e-12;)_e(r=(l+o)/2,e)>0?o=r:l=r;n=l;var i,c=0;for(i=0;i<=1e3;++i){c+=_e(r=t+i*(n-t)/1e3,e)}return 1001/(c*(n-t))}function pe(e){return e<0&&(e=0),e*=.001,13*Math.atan(.76*e)+3.5*Math.atan(e*e/56.25)}function de(e,t,n,r,c,f,_,d,m,v,y,w){var i,k=l(U.CBANDS+1),S=d/(w>15?1152:384),M=o(U.HBLKSIZE);d/=m;var R=0,x=0;for(i=0;i<U.CBANDS;i++){var P;for(I=pe(d*R),k[i]=d*R,P=R;pe(d*P)-I<h&&P<=m/2;P++);for(e[i]=P-R,x=i+1;R<P;)M[R++]=i;if(R>m/2){R=m/2,++i;break}}k[i]=d*R;for(var E=0;E<w;E++){var A,T,B,O,C;B=v[E],O=v[E+1],(A=0|Math.floor(.5+y*(B-.5)))<0&&(A=0),(T=0|Math.floor(.5+y*(O-.5)))>m/2&&(T=m/2),n[E]=(M[A]+M[T])/2,t[E]=M[T];var j=S*O;_[E]=(j-k[t[E]])/(k[t[E]+1]-k[t[E]]),_[E]<0?_[E]=0:_[E]>1&&(_[E]=1),C=pe(d*v[E]*y),C=Math.min(C,15.5)/15.5,f[E]=Math.pow(10,1.25*(1-Math.cos(Math.PI*C))-2.5)}R=0;for(var L=0;L<x;L++){var I,H,D=e[L];I=pe(d*R),H=pe(d*(R+D-1)),r[L]=.5*(I+H),I=pe(d*(R-.5)),H=pe(d*(R+D-.5)),c[L]=H-I,R+=D}return x}function me(e,t,n,r,o,c){var _,h,d,m,v,y,w=f([U.CBANDS,U.CBANDS]),k=0;if(c)for(var i=0;i<t;i++)for(_=0;_<t;_++){var S=(h=n[i]-n[_],d=void 0,m=void 0,v=void 0,y=void 0,d=h,m=(d*=d>=0?3:1.5)>=.5&&d<=2.5?8*((y=d-.5)*y-2*y):0,((v=15.811389+7.5*(d+=.474)-17.5*Math.sqrt(1+d*d))<=-60?0:(d=Math.exp((m+v)*x),d/=.6609193))*r[_]);w[i][_]=S*o[i]}else for(_=0;_<t;_++){var M=15+Math.min(21/n[_],12),R=he(M);for(i=0;i<t;i++){S=R*_e(n[i]-n[_],M)*r[_];w[i][_]=S*o[i]}}for(i=0;i<t;i++){for(_=0;_<t&&!(w[i][_]>0);_++);for(e[i][0]=_,_=t-1;_>0&&!(w[i][_]>0);_--);e[i][1]=_,k+=e[i][1]-e[i][0]+1}var p=l(k),P=0;for(i=0;i<t;i++)for(_=e[i][0];_<=e[i][1];_++)p[P++]=w[i][_];return p}function be(e){var t=pe(e);return t=Math.min(t,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*t))-2.5)}function ve(e,t){return e<-.3&&(e=3410),e/=1e3,e=Math.max(.1,e),3.64*Math.pow(e,-.8)-6.8*Math.exp(-.6*Math.pow(e-3.4,2))+6*Math.exp(-.15*Math.pow(e-8.7,2))+.001*(.6+.04*t)*Math.pow(e,4)}this.L3psycho_anal_vbr=function(e,t,n,r,c,_,h,d,m,y){var k=e.internal_flags,S=l(U.HBLKSIZE),x=f([3,U.HBLKSIZE_s]),P=f([2,U.BLKSIZE]),E=f([2,3,U.BLKSIZE_s]),A=f([4,U.CBANDS]),T=f([4,U.CBANDS]),B=f([4,3]),O=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],C=o(2),j=e.mode==M.JOINT_STEREO?4:k.channels_out;!function(e,t,n,r,o,c,_,h,d,m){for(var v=f([2,576]),y=e.internal_flags,w=y.channels_out,k=e.mode==M.JOINT_STEREO?4:w,S=0;S<w;S++){firbuf=t[S];for(var x=n+576-350-R+192,i=0;i<576;i++){var P,E;P=firbuf[x+i+10],E=0;for(var A=0;A<(R-1)/2-1;A+=2)P+=ie[A]*(firbuf[x+i+A]+firbuf[x+i+R-A]),E+=ie[A+1]*(firbuf[x+i+A+1]+firbuf[x+i+R-A-1]);v[S][i]=P+E}o[r][S].en.assign(y.en[S]),o[r][S].thm.assign(y.thm[S]),k>2&&(c[r][S].en.assign(y.en[S+2]),c[r][S].thm.assign(y.thm[S+2]))}for(S=0;S<k;S++){var T=l(12),B=l(12),O=[0,0,0,0],C=v[1&S],j=0,L=3==S?y.nsPsy.attackthre_s:y.nsPsy.attackthre,I=1;if(2==S)for(i=0,A=576;A>0;++i,--A){var H=v[0][i],D=v[1][i];v[0][i]=H+D,v[1][i]=H-D}for(i=0;i<3;i++)B[i]=y.nsPsy.last_en_subshort[S][i+6],T[i]=B[i]/y.nsPsy.last_en_subshort[S][i+4],O[0]+=B[i];for(i=0;i<9;i++){for(var V=j+64,p=1;j<V;j++)p<Math.abs(C[j])&&(p=Math.abs(C[j]));y.nsPsy.last_en_subshort[S][i]=B[i+3]=p,O[1+i/3]+=p,p>B[i+3-2]?p/=B[i+3-2]:p=B[i+3-2]>10*p?B[i+3-2]/(10*p):0,T[i+3]=p}for(i=0;i<3;++i){var N=B[3*i+3]+B[3*i+4]+B[3*i+5],Y=1;6*B[3*i+5]<N&&(Y*=.5,6*B[3*i+4]<N&&(Y*=.5)),h[S][i]=Y}if(e.analysis){var X=T[0];for(i=1;i<12;i++)X<T[i]&&(X=T[i]);y.pinfo.ers[r][S]=y.pinfo.ers_save[S],y.pinfo.ers_save[S]=X}for(i=0;i<12;i++)0==d[S][i/3]&&T[i]>L&&(d[S][i/3]=i%3+1);for(i=1;i<4;i++){var u=O[i-1],F=O[i];Math.max(u,F)<4e4&&u<1.7*F&&F<1.7*u&&(1==i&&d[S][0]<=d[S][i]&&(d[S][0]=0),d[S][i]=0)}d[S][0]<=y.nsPsy.lastAttacks[S]&&(d[S][0]=0),3!=y.nsPsy.lastAttacks[S]&&d[S][0]+d[S][1]+d[S][2]+d[S][3]==0||(I=0,0!=d[S][1]&&0!=d[S][0]&&(d[S][1]=0),0!=d[S][2]&&0!=d[S][1]&&(d[S][2]=0),0!=d[S][3]&&0!=d[S][2]&&(d[S][3]=0)),S<2?m[S]=I:0==I&&(m[0]=m[1]=0),_[S]=y.tot_ener[S]}}(e,t,n,r,c,_,m,B,O,C),function(e,t){var n=e.internal_flags;e.short_blocks!=w.short_block_coupled||0!=t[0]&&0!=t[1]||(t[0]=t[1]=0);for(var r=0;r<n.channels_out;r++)e.short_blocks==w.short_block_dispensed&&(t[r]=1),e.short_blocks==w.short_block_forced&&(t[r]=0)}(e,C);for(var L=0;L<j;L++){ne(e,t,n,L,r,S,P,H=1&L),se(e,r,L,S),0!=C[H]?ce(k,S,A[L],T[L],L):le(k,L)}C[0]+C[1]==2&&e.mode==M.JOINT_STEREO&&fe(A,T,k.mld_cb_l,k.ATH.cb_l,e.ATHlower*k.ATH.adjust,e.msfix,k.npart_l);for(L=0;L<j;L++){0!=C[H=1&L]&&W(k,A[L],T[L],L)}for(var I=0;I<3;I++){for(L=0;L<j;++L){0!=C[H=1&L]?oe(k,L,I):(re(e,t,n,L,I,x,E,H),ue(e,x,A[L],T[L],L,I))}C[0]+C[1]==0&&e.mode==M.JOINT_STEREO&&fe(A,T,k.mld_cb_s,k.ATH.cb_s,e.ATHlower*k.ATH.adjust,e.msfix,k.npart_s);for(L=0;L<j;++L){0==C[H=1&L]&&F(k,A[L],T[L],L,I)}}for(L=0;L<j;L++){var H;if(0==C[H=1&L])for(var D=0;D<U.SBMAX_s;D++){var V=l(3);for(I=0;I<3;I++){var N=k.thm[L].s[D][I];if(N*=.8,O[L][I]>=2||1==O[L][I+1]){var Y=0!=I?I-1:2,p=G(k.thm[L].s[D][Y],N,.36);N=Math.min(N,p)}else if(1==O[L][I]){Y=0!=I?I-1:2,p=G(k.thm[L].s[D][Y],N,.6*v);N=Math.min(N,p)}else if(0!=I&&3==O[L][I-1]||0==I&&3==k.nsPsy.lastAttacks[L]){Y=2!=I?I+1:0,p=G(k.thm[L].s[D][Y],N,.6*v);N=Math.min(N,p)}N*=B[L][I],V[I]=N}for(I=0;I<3;I++)k.thm[L].s[D][I]=V[I]}}for(L=0;L<j;L++)k.nsPsy.lastAttacks[L]=O[L][2];!function(e,t,n){for(var r=e.internal_flags,o=0;o<r.channels_out;o++){var l=U.NORM_TYPE;0!=t[o]?r.blocktype_old[o]==U.SHORT_TYPE&&(l=U.STOP_TYPE):(l=U.SHORT_TYPE,r.blocktype_old[o]==U.NORM_TYPE&&(r.blocktype_old[o]=U.START_TYPE),r.blocktype_old[o]==U.STOP_TYPE&&(r.blocktype_old[o]=U.SHORT_TYPE)),n[o]=r.blocktype_old[o],r.blocktype_old[o]=l}}(e,C,y);for(L=0;L<j;L++){var X,z,Z,Q;L>1?(X=d,z=-2,Z=U.NORM_TYPE,y[0]!=U.SHORT_TYPE&&y[1]!=U.SHORT_TYPE||(Z=U.SHORT_TYPE),Q=_[r][L-2]):(X=h,z=0,Z=y[L],Q=c[r][L]),Z==U.SHORT_TYPE?X[z+L]=K(Q,k.masking_lower):X[z+L]=J(Q,k.masking_lower),e.analysis&&(k.pinfo.pe[r][L]=X[z+L])}return 0},this.psymodel_init=function(n){var i,r=n.internal_flags,o=!0,c=13,f=0,_=0,h=-8.25,d=-4.5,m=l(U.CBANDS),v=l(U.CBANDS),y=l(U.CBANDS),w=n.out_samplerate;switch(n.experimentalZ){default:case 0:o=!0;break;case 1:o=n.VBR!=S.vbr_mtrh&&n.VBR!=S.vbr_mt;break;case 2:o=!1;break;case 3:c=8,f=-1.75,_=-.0125,h=-8.25,d=-2.25}for(r.ms_ener_ratio_old=.25,r.blocktype_old[0]=r.blocktype_old[1]=U.NORM_TYPE,i=0;i<4;++i){for(var M=0;M<U.CBANDS;++M)r.nb_1[i][M]=1e20,r.nb_2[i][M]=1e20,r.nb_s1[i][M]=r.nb_s2[i][M]=1;for(var R=0;R<U.SBMAX_l;R++)r.en[i].l[R]=1e20,r.thm[i].l[R]=1e20;for(M=0;M<3;++M){for(R=0;R<U.SBMAX_s;R++)r.en[i].s[R][M]=1e20,r.thm[i].s[R][M]=1e20;r.nsPsy.lastAttacks[i]=0}for(M=0;M<9;M++)r.nsPsy.last_en_subshort[i][M]=10}for(r.loudness_sq_save[0]=r.loudness_sq_save[1]=0,r.npart_l=de(r.numlines_l,r.bo_l,r.bm_l,m,v,r.mld_l,r.PSY.bo_l_weight,w,U.BLKSIZE,r.scalefac_band.l,U.BLKSIZE/1152,U.SBMAX_l),i=0;i<r.npart_l;i++){var x=f;m[i]>=c&&(x=_*(m[i]-c)/(24-c)+f*(24-m[i])/(24-c)),y[i]=Math.pow(10,x/10),r.numlines_l[i]>0?r.rnumlines_l[i]=1/r.numlines_l[i]:r.rnumlines_l[i]=0}r.s3_ll=me(r.s3ind,r.npart_l,m,v,y,o);var P;M=0;for(i=0;i<r.npart_l;i++){I=k.MAX_VALUE;for(var E=0;E<r.numlines_l[i];E++,M++){var A=w*M/(1e3*U.BLKSIZE);H=this.ATHformula(1e3*A,n)-20,H=Math.pow(10,.1*H),I>(H*=r.numlines_l[i])&&(I=H)}r.ATH.cb_l[i]=I,(I=20*m[i]/10-20)>6&&(I=100),I<-15&&(I=-15),I-=8,r.minval_l[i]=Math.pow(10,I/10)*r.numlines_l[i]}for(r.npart_s=de(r.numlines_s,r.bo_s,r.bm_s,m,v,r.mld_s,r.PSY.bo_s_weight,w,U.BLKSIZE_s,r.scalefac_band.s,U.BLKSIZE_s/384,U.SBMAX_s),M=0,i=0;i<r.npart_s;i++){var I;x=h;m[i]>=c&&(x=d*(m[i]-c)/(24-c)+h*(24-m[i])/(24-c)),y[i]=Math.pow(10,x/10),I=k.MAX_VALUE;for(E=0;E<r.numlines_s[i];E++,M++){var H;A=w*M/(1e3*U.BLKSIZE_s);H=this.ATHformula(1e3*A,n)-20,H=Math.pow(10,.1*H),I>(H*=r.numlines_s[i])&&(I=H)}r.ATH.cb_s[i]=I,I=7*m[i]/12-7,m[i]>12&&(I*=1+3.1*Math.log(1+I)),m[i]<12&&(I*=1+2.3*Math.log(1-I)),I<-15&&(I=-15),I-=8,r.minval_s[i]=Math.pow(10,I/10)*r.numlines_s[i]}r.s3_ss=me(r.s3ind_s,r.npart_s,m,v,y,o),T=Math.pow(10,(C+1)/16),B=Math.pow(10,(j+1)/16),O=Math.pow(10,L/10),e.init_fft(r),r.decay=Math.exp(-1*t/(.01*w/192)),P=3.5,0!=(2&n.exp_nspsytune)&&(P=1),Math.abs(n.msfix)>0&&(P=n.msfix),n.msfix=P;for(var b=0;b<r.npart_l;b++)r.s3ind[b][1]>r.npart_l-1&&(r.s3ind[b][1]=r.npart_l-1);var D=576*r.mode_gr/w;if(r.ATH.decay=Math.pow(10,-1.2*D),r.ATH.adjust=.01,r.ATH.adjustLimit=1,-1!=n.ATHtype){var V=n.out_samplerate/U.BLKSIZE,N=0;for(A=0,i=0;i<U.BLKSIZE/2;++i)A+=V,r.ATH.eql_w[i]=1/Math.pow(10,this.ATHformula(A,n)/10),N+=r.ATH.eql_w[i];for(N=1/N,i=U.BLKSIZE/2;--i>=0;)r.ATH.eql_w[i]*=N}for(b=M=0;b<r.npart_s;++b)for(i=0;i<r.numlines_s[b];++i)++M;for(b=M=0;b<r.npart_l;++b)for(i=0;i<r.numlines_l[b];++i)++M;for(M=0,i=0;i<r.npart_l;i++){A=w*(M+r.numlines_l[i]/2)/(1*U.BLKSIZE);r.mld_cb_l[i]=be(A),M+=r.numlines_l[i]}for(;i<U.CBANDS;++i)r.mld_cb_l[i]=1;for(M=0,i=0;i<r.npart_s;i++){A=w*(M+r.numlines_s[i]/2)/(1*U.BLKSIZE_s);r.mld_cb_s[i]=be(A),M+=r.numlines_s[i]}for(;i<U.CBANDS;++i)r.mld_cb_s[i]=1;return 0},this.ATHformula=function(e,t){var n;switch(t.ATHtype){case 0:n=ve(e,9);break;case 1:n=ve(e,-1);break;case 2:n=ve(e,0);break;case 3:n=ve(e,1)+6;break;case 4:n=ve(e,t.ATHcurve);break;default:n=ve(e,0)}return n}}function re(){var e=this;re.V9=410,re.V8=420,re.V7=430,re.V6=440,re.V5=450,re.V4=460,re.V3=470,re.V2=480,re.V1=490,re.V0=500,re.R3MIX=1e3,re.STANDARD=1001,re.EXTREME=1002,re.INSANE=1003,re.STANDARD_FAST=1004,re.EXTREME_FAST=1005,re.MEDIUM=1006,re.MEDIUM_FAST=1007;var t,n,p,r,o;re.LAME_MAXMP3BUFFER=147456;var c,f,d,m=new ne;function y(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=l(U.SBMAX_l),this.bo_s_weight=l(U.SBMAX_s)}function k(){this.lowerlimit=0}function R(e,t){this.lowpass=t}this.enc=new U,this.setModules=function(e,l,_,h,v,y,w,k,S){t=e,n=l,p=_,r=h,o=v,c=y,w,f=k,d=S,this.enc.setModules(n,m,r,c)};var x=4294479419;function E(e){return e>1?0:e<=0?1:Math.cos(Math.PI/2*e)}function A(e,t){switch(e){case 44100:return t.version=1,0;case 48e3:return t.version=1,1;case 32e3:return t.version=1,2;case 22050:return t.version=0,0;case 24e3:return t.version=0,1;case 16e3:return t.version=0,2;case 11025:return t.version=0,0;case 12e3:return t.version=0,1;case 8e3:return t.version=0,2;default:return t.version=0,-1}}function T(e,t,n){n<16e3&&(t=2);for(var r=C.bitrate_table[t][1],i=2;i<=14;i++)C.bitrate_table[t][i]>0&&Math.abs(C.bitrate_table[t][i]-e)<Math.abs(r-e)&&(r=C.bitrate_table[t][i]);return r}function O(e,t,n){n<16e3&&(t=2);for(var i=0;i<=14;i++)if(C.bitrate_table[t][i]>0&&C.bitrate_table[t][i]==e)return i;return-1}function j(t,n){var r=[new R(8,2e3),new R(16,3700),new R(24,3900),new R(32,5500),new R(40,7e3),new R(48,7500),new R(56,1e4),new R(64,11e3),new R(80,13500),new R(96,15100),new R(112,15600),new R(128,17e3),new R(160,17500),new R(192,18600),new R(224,19400),new R(256,19700),new R(320,20500)],o=e.nearestBitrateFullIndex(n);t.lowerlimit=r[o].lowpass}function L(e){var t=U.BLKSIZE+e.framesize-U.FFTOFFSET;return t=Math.max(t,512+e.framesize-32)}function I(t,n,r,o,l,c){var f=e.enc.lame_encode_mp3_frame(t,n,r,o,l,c);return t.frameNum++,f}function Y(){this.n_in=0,this.n_out=0}function X(){this.num_used=0}function F(e,t,n){var r=Math.PI*t;(e/=n)<0&&(e=0),e>1&&(e=1);var o=e-.5,l=.42-.5*Math.cos(2*e*Math.PI)+.08*Math.cos(4*e*Math.PI);return Math.abs(o)<1e-9?r/Math.PI:l*Math.sin(n*r*o)/(Math.PI*n*o)}function W(e,t,n,r,o,c,f,_,h){var i,d,m=e.internal_flags,v=0,y=e.out_samplerate/function e(i,t){return 0!=t?e(t,i%t):i}(e.out_samplerate,e.in_samplerate);y>te.BPC&&(y=te.BPC);var w=Math.abs(m.resample_ratio-Math.floor(.5+m.resample_ratio))<1e-4?1:0,k=1/m.resample_ratio;k>1&&(k=1);var S=31;0==S%2&&--S;var M=(S+=w)+1;if(0==m.fill_buffer_resample_init){for(m.inbuf_old[0]=l(M),m.inbuf_old[1]=l(M),i=0;i<=2*y;++i)m.blackfilt[i]=l(M);for(m.itime[0]=0,m.itime[1]=0,v=0;v<=2*y;v++){var R=0,x=(v-y)/(2*y);for(i=0;i<=S;i++)R+=m.blackfilt[v][i]=F(i-x,k,S);for(i=0;i<=S;i++)m.blackfilt[v][i]/=R}m.fill_buffer_resample_init=1}var P=m.inbuf_old[h];for(d=0;d<r;d++){var E,A;if(E=d*m.resample_ratio,S+(v=0|Math.floor(E-m.itime[h]))-S/2>=f)break;x=E-m.itime[h]-(v+S%2*.5);A=0|Math.floor(2*x*y+y+.5);var T=0;for(i=0;i<=S;++i){var B=i+v-S/2;T+=(B<0?P[M+B]:o[c+B])*m.blackfilt[A][i]}t[n+d]=T}if(_.num_used=Math.min(f,S+v-S/2),m.itime[h]+=_.num_used-d*m.resample_ratio,_.num_used>=M)for(i=0;i<M;i++)P[i]=o[c+_.num_used+i-M];else{var O=M-_.num_used;for(i=0;i<O;++i)P[i]=P[i+_.num_used];for(v=0;i<M;++i,++v)P[i]=o[c+v]}return d}function z(e,t,n,r,o,l){var c=e.internal_flags;if(c.resample_ratio<.9999||c.resample_ratio>1.0001)for(var f=0;f<c.channels_out;f++){var _=new X;l.n_out=W(e,t[f],c.mf_size,e.framesize,n[f],r,o,_,f),l.n_in=_.num_used}else{l.n_out=Math.min(e.framesize,o),l.n_in=l.n_out;for(var i=0;i<l.n_out;++i)t[0][c.mf_size+i]=n[0][r+i],2==c.channels_out&&(t[1][c.mf_size+i]=n[1][r+i])}}this.lame_init=function(){var e=new D;return 0!=function(e){var t;return e.class_id=x,t=e.internal_flags=new te,e.mode=M.NOT_SET,e.original=1,e.in_samplerate=44100,e.num_channels=2,e.num_samples=-1,e.bWriteVbrTag=!0,e.quality=-1,e.short_blocks=null,t.subblock_gain=-1,e.lowpassfreq=0,e.highpassfreq=0,e.lowpasswidth=-1,e.highpasswidth=-1,e.VBR=S.vbr_off,e.VBR_q=4,e.ATHcurve=-1,e.VBR_mean_bitrate_kbps=128,e.VBR_min_bitrate_kbps=0,e.VBR_max_bitrate_kbps=0,e.VBR_hard_min=0,t.VBR_min_bitrate=1,t.VBR_max_bitrate=13,e.quant_comp=-1,e.quant_comp_short=-1,e.msfix=-1,t.resample_ratio=1,t.OldValue[0]=180,t.OldValue[1]=180,t.CurrentStep[0]=4,t.CurrentStep[1]=4,t.masking_lower=1,t.nsPsy.attackthre=-1,t.nsPsy.attackthre_s=-1,e.scale=-1,e.athaa_type=-1,e.ATHtype=-1,e.athaa_loudapprox=-1,e.athaa_sensitivity=0,e.useTemporal=null,e.interChRatio=-1,t.mf_samples_to_encode=U.ENCDELAY+U.POSTDELAY,e.encoder_padding=0,t.mf_size=U.ENCDELAY-U.MDCTDELAY,e.findReplayGain=!1,e.decode_on_the_fly=!1,t.decode_on_the_fly=!1,t.findReplayGain=!1,t.findPeakSample=!1,t.RadioGain=0,t.AudiophileGain=0,t.noclipGainChange=0,t.noclipScale=-1,e.preset=0,e.write_id3tag_automatic=!0,0}(e)?null:(e.lame_allocated_gfp=1,e)},this.nearestBitrateFullIndex=function(e){var t=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],n=0,r=0,o=0,l=0;l=t[16],o=16,r=t[16],n=16;for(var b=0;b<16;b++)if(Math.max(e,t[b+1])!=e){l=t[b+1],o=b+1,r=t[b],n=b;break}return l-e>e-r?n:o},this.lame_init_params=function(e){var l,h,R,L=e.internal_flags;if(L.Class_ID=0,null==L.ATH&&(L.ATH=new H),null==L.PSY&&(L.PSY=new y),null==L.rgdata&&(L.rgdata=new N),L.channels_in=e.num_channels,1==L.channels_in&&(e.mode=M.MONO),L.channels_out=e.mode==M.MONO?1:2,L.mode_ext=U.MPG_MD_MS_LR,e.mode==M.MONO&&(e.force_ms=!1),e.VBR==S.vbr_off&&128!=e.VBR_mean_bitrate_kbps&&0==e.brate&&(e.brate=e.VBR_mean_bitrate_kbps),e.VBR==S.vbr_off||e.VBR==S.vbr_mtrh||e.VBR==S.vbr_mt||(e.free_format=!1),e.VBR==S.vbr_off&&0==e.brate&&B.EQ(e.compression_ratio,0)&&(e.compression_ratio=11.025),e.VBR==S.vbr_off&&e.compression_ratio>0&&(0==e.out_samplerate&&(e.out_samplerate=map2MP3Frequency(int(.97*e.in_samplerate))),e.brate=0|16*e.out_samplerate*L.channels_out/(1e3*e.compression_ratio),L.samplerate_index=A(e.out_samplerate,e),e.free_format||(e.brate=T(e.brate,e.version,e.out_samplerate))),0!=e.out_samplerate&&(e.out_samplerate<16e3?(e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,8),e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,64)):e.out_samplerate<32e3?(e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,8),e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,160)):(e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,32),e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,320))),0==e.lowpassfreq){var I=16e3;switch(e.VBR){case S.vbr_off:j(D=new k,e.brate),I=D.lowerlimit;break;case S.vbr_abr:var D;j(D=new k,e.VBR_mean_bitrate_kbps),I=D.lowerlimit;break;case S.vbr_rh:var Y=[19500,19e3,18600,18e3,17500,16e3,15600,14900,12500,1e4,3950];if(0<=e.VBR_q&&e.VBR_q<=9){var a=Y[e.VBR_q],b=Y[e.VBR_q+1],X=e.VBR_q_frac;I=linear_int(a,b,X)}else I=19500;break;default:Y=[19500,19e3,18500,18e3,17500,16500,15500,14500,12500,9500,3950];if(0<=e.VBR_q&&e.VBR_q<=9){a=Y[e.VBR_q],b=Y[e.VBR_q+1],X=e.VBR_q_frac;I=linear_int(a,b,X)}else I=19500}e.mode!=M.MONO||e.VBR!=S.vbr_off&&e.VBR!=S.vbr_abr||(I*=1.5),e.lowpassfreq=0|I}if(0==e.out_samplerate&&(2*e.lowpassfreq>e.in_samplerate&&(e.lowpassfreq=e.in_samplerate/2),e.out_samplerate=(l=0|e.lowpassfreq,h=e.in_samplerate,R=44100,h>=48e3?R=48e3:h>=44100?R=44100:h>=32e3?R=32e3:h>=24e3?R=24e3:h>=22050?R=22050:h>=16e3?R=16e3:h>=12e3?R=12e3:h>=11025?R=11025:h>=8e3&&(R=8e3),-1==l?R:(l<=15960&&(R=44100),l<=15250&&(R=32e3),l<=11220&&(R=24e3),l<=9970&&(R=22050),l<=7230&&(R=16e3),l<=5420&&(R=12e3),l<=4510&&(R=11025),l<=3970&&(R=8e3),h<R?h>44100?48e3:h>32e3?44100:h>24e3?32e3:h>22050?24e3:h>16e3?22050:h>12e3?16e3:h>11025?12e3:h>8e3?11025:8e3:R))),e.lowpassfreq=Math.min(20500,e.lowpassfreq),e.lowpassfreq=Math.min(e.out_samplerate/2,e.lowpassfreq),e.VBR==S.vbr_off&&(e.compression_ratio=16*e.out_samplerate*L.channels_out/(1e3*e.brate)),e.VBR==S.vbr_abr&&(e.compression_ratio=16*e.out_samplerate*L.channels_out/(1e3*e.VBR_mean_bitrate_kbps)),e.bWriteVbrTag||(e.findReplayGain=!1,e.decode_on_the_fly=!1,L.findPeakSample=!1),L.findReplayGain=e.findReplayGain,L.decode_on_the_fly=e.decode_on_the_fly,L.decode_on_the_fly&&(L.findPeakSample=!0),L.findReplayGain&&t.InitGainAnalysis(L.rgdata,e.out_samplerate)==P.INIT_GAIN_ANALYSIS_ERROR)return e.internal_flags=null,-6;switch(L.decode_on_the_fly&&!e.decode_only&&(null!=L.hip&&d.hip_decode_exit(L.hip),L.hip=d.hip_decode_init()),L.mode_gr=e.out_samplerate<=24e3?1:2,e.framesize=576*L.mode_gr,e.encoder_delay=U.ENCDELAY,L.resample_ratio=e.in_samplerate/e.out_samplerate,e.VBR){case S.vbr_mt:case S.vbr_rh:case S.vbr_mtrh:e.compression_ratio=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5][e.VBR_q];break;case S.vbr_abr:e.compression_ratio=16*e.out_samplerate*L.channels_out/(1e3*e.VBR_mean_bitrate_kbps);break;default:e.compression_ratio=16*e.out_samplerate*L.channels_out/(1e3*e.brate)}if(e.mode==M.NOT_SET&&(e.mode=M.JOINT_STEREO),e.highpassfreq>0?(L.highpass1=2*e.highpassfreq,e.highpasswidth>=0?L.highpass2=2*(e.highpassfreq+e.highpasswidth):L.highpass2=2*e.highpassfreq,L.highpass1/=e.out_samplerate,L.highpass2/=e.out_samplerate):(L.highpass1=0,L.highpass2=0),e.lowpassfreq>0?(L.lowpass2=2*e.lowpassfreq,e.lowpasswidth>=0?(L.lowpass1=2*(e.lowpassfreq-e.lowpasswidth),L.lowpass1<0&&(L.lowpass1=0)):L.lowpass1=2*e.lowpassfreq,L.lowpass1/=e.out_samplerate,L.lowpass2/=e.out_samplerate):(L.lowpass1=0,L.lowpass2=0),function(e){var t=e.internal_flags,n=32,r=-1;if(t.lowpass1>0){for(var o=999,l=0;l<=31;l++){(h=l/31)>=t.lowpass2&&(n=Math.min(n,l)),t.lowpass1<h&&h<t.lowpass2&&(o=Math.min(o,l))}t.lowpass1=999==o?(n-.75)/31:(o-.75)/31,t.lowpass2=n/31}if(t.highpass2>0&&t.highpass2<.75/31*.9&&(t.highpass1=0,t.highpass2=0,v.err.println("Warning: highpass filter disabled.  highpass frequency too small\n")),t.highpass2>0){var c=-1;for(l=0;l<=31;l++){(h=l/31)<=t.highpass1&&(r=Math.max(r,l)),t.highpass1<h&&h<t.highpass2&&(c=Math.max(c,l))}t.highpass1=r/31,t.highpass2=-1==c?(r+.75)/31:(c+.75)/31}for(l=0;l<32;l++){var f,_,h=l/31;f=t.highpass2>t.highpass1?E((t.highpass2-h)/(t.highpass2-t.highpass1+1e-20)):1,_=t.lowpass2>t.lowpass1?E((h-t.lowpass1)/(t.lowpass2-t.lowpass1+1e-20)):1,t.amp_filter[l]=f*_}}(e),L.samplerate_index=A(e.out_samplerate,e),L.samplerate_index<0)return e.internal_flags=null,-1;if(e.VBR==S.vbr_off){if(e.free_format)L.bitrate_index=0;else if(e.brate=T(e.brate,e.version,e.out_samplerate),L.bitrate_index=O(e.brate,e.version,e.out_samplerate),L.bitrate_index<=0)return e.internal_flags=null,-1}else L.bitrate_index=1;e.analysis&&(e.bWriteVbrTag=!1),null!=L.pinfo&&(e.bWriteVbrTag=!1),n.init_bit_stream_w(L);for(var F,W=L.samplerate_index+3*e.version+6*(e.out_samplerate<16e3?1:0),i=0;i<U.SBMAX_l+1;i++)L.scalefac_band.l[i]=r.sfBandIndex[W].l[i];for(i=0;i<U.PSFB21+1;i++){var z=(L.scalefac_band.l[22]-L.scalefac_band.l[21])/U.PSFB21,G=L.scalefac_band.l[21]+i*z;L.scalefac_band.psfb21[i]=G}L.scalefac_band.psfb21[U.PSFB21]=576;for(i=0;i<U.SBMAX_s+1;i++)L.scalefac_band.s[i]=r.sfBandIndex[W].s[i];for(i=0;i<U.PSFB12+1;i++){z=(L.scalefac_band.s[13]-L.scalefac_band.s[12])/U.PSFB12,G=L.scalefac_band.s[12]+i*z;L.scalefac_band.psfb12[i]=G}for(L.scalefac_band.psfb12[U.PSFB12]=192,1==e.version?L.sideinfo_len=1==L.channels_out?21:36:L.sideinfo_len=1==L.channels_out?13:21,e.error_protection&&(L.sideinfo_len+=2),function(e){var t=e.internal_flags;e.frameNum=0,e.write_id3tag_automatic&&f.id3tag_write_v2(e),t.bitrate_stereoMode_Hist=_([16,5]),t.bitrate_blockType_Hist=_([16,6]),t.PeakSample=0,e.bWriteVbrTag&&c.InitVbrTag(e)}(e),L.Class_ID=x,F=0;F<19;F++)L.nsPsy.pefirbuf[F]=700*L.mode_gr*L.channels_out;switch(-1==e.ATHtype&&(e.ATHtype=4),e.VBR){case S.vbr_mt:e.VBR=S.vbr_mtrh;case S.vbr_mtrh:null==e.useTemporal&&(e.useTemporal=!1),p.apply_preset(e,500-10*e.VBR_q,0),e.quality<0&&(e.quality=LAME_DEFAULT_QUALITY),e.quality<5&&(e.quality=0),e.quality>5&&(e.quality=5),L.PSY.mask_adjust=e.maskingadjust,L.PSY.mask_adjust_short=e.maskingadjust_short,e.experimentalY?L.sfb21_extra=!1:L.sfb21_extra=e.out_samplerate>44e3,L.iteration_loop=new VBRNewIterationLoop(o);break;case S.vbr_rh:p.apply_preset(e,500-10*e.VBR_q,0),L.PSY.mask_adjust=e.maskingadjust,L.PSY.mask_adjust_short=e.maskingadjust_short,e.experimentalY?L.sfb21_extra=!1:L.sfb21_extra=e.out_samplerate>44e3,e.quality>6&&(e.quality=6),e.quality<0&&(e.quality=LAME_DEFAULT_QUALITY),L.iteration_loop=new VBROldIterationLoop(o);break;default:var Z;L.sfb21_extra=!1,e.quality<0&&(e.quality=LAME_DEFAULT_QUALITY),(Z=e.VBR)==S.vbr_off&&(e.VBR_mean_bitrate_kbps=e.brate),p.apply_preset(e,e.VBR_mean_bitrate_kbps,0),e.VBR=Z,L.PSY.mask_adjust=e.maskingadjust,L.PSY.mask_adjust_short=e.maskingadjust_short,Z==S.vbr_off?L.iteration_loop=new V(o):L.iteration_loop=new ABRIterationLoop(o)}if(e.VBR!=S.vbr_off){if(L.VBR_min_bitrate=1,L.VBR_max_bitrate=14,e.out_samplerate<16e3&&(L.VBR_max_bitrate=8),0!=e.VBR_min_bitrate_kbps&&(e.VBR_min_bitrate_kbps=T(e.VBR_min_bitrate_kbps,e.version,e.out_samplerate),L.VBR_min_bitrate=O(e.VBR_min_bitrate_kbps,e.version,e.out_samplerate),L.VBR_min_bitrate<0))return-1;if(0!=e.VBR_max_bitrate_kbps&&(e.VBR_max_bitrate_kbps=T(e.VBR_max_bitrate_kbps,e.version,e.out_samplerate),L.VBR_max_bitrate=O(e.VBR_max_bitrate_kbps,e.version,e.out_samplerate),L.VBR_max_bitrate<0))return-1;e.VBR_min_bitrate_kbps=C.bitrate_table[e.version][L.VBR_min_bitrate],e.VBR_max_bitrate_kbps=C.bitrate_table[e.version][L.VBR_max_bitrate],e.VBR_mean_bitrate_kbps=Math.min(C.bitrate_table[e.version][L.VBR_max_bitrate],e.VBR_mean_bitrate_kbps),e.VBR_mean_bitrate_kbps=Math.max(C.bitrate_table[e.version][L.VBR_min_bitrate],e.VBR_mean_bitrate_kbps)}return e.tune&&(L.PSY.mask_adjust+=e.tune_value_a,L.PSY.mask_adjust_short+=e.tune_value_a),function(e){var t=e.internal_flags;switch(e.quality){default:case 9:t.psymodel=0,t.noise_shaping=0,t.noise_shaping_amp=0,t.noise_shaping_stop=0,t.use_best_huffman=0,t.full_outer_loop=0;break;case 8:e.quality=7;case 7:t.psymodel=1,t.noise_shaping=0,t.noise_shaping_amp=0,t.noise_shaping_stop=0,t.use_best_huffman=0,t.full_outer_loop=0;break;case 6:case 5:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=0,t.noise_shaping_stop=0,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=0,t.full_outer_loop=0;break;case 4:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=0,t.noise_shaping_stop=0,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 3:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=1,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 2:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),0==t.substep_shaping&&(t.substep_shaping=2),t.noise_shaping_amp=1,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 1:case 0:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),0==t.substep_shaping&&(t.substep_shaping=2),t.noise_shaping_amp=2,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0}}(e),e.athaa_type<0?L.ATH.useAdjust=3:L.ATH.useAdjust=e.athaa_type,L.ATH.aaSensitivityP=Math.pow(10,e.athaa_sensitivity/-10),null==e.short_blocks&&(e.short_blocks=w.short_block_allowed),e.short_blocks!=w.short_block_allowed||e.mode!=M.JOINT_STEREO&&e.mode!=M.STEREO||(e.short_blocks=w.short_block_coupled),e.quant_comp<0&&(e.quant_comp=1),e.quant_comp_short<0&&(e.quant_comp_short=0),e.msfix<0&&(e.msfix=0),e.exp_nspsytune=1|e.exp_nspsytune,e.internal_flags.nsPsy.attackthre<0&&(e.internal_flags.nsPsy.attackthre=ne.NSATTACKTHRE),e.internal_flags.nsPsy.attackthre_s<0&&(e.internal_flags.nsPsy.attackthre_s=ne.NSATTACKTHRE_S),e.scale<0&&(e.scale=1),e.ATHtype<0&&(e.ATHtype=4),e.ATHcurve<0&&(e.ATHcurve=4),e.athaa_loudapprox<0&&(e.athaa_loudapprox=2),e.interChRatio<0&&(e.interChRatio=0),null==e.useTemporal&&(e.useTemporal=!0),L.slot_lag=L.frac_SpF=0,e.VBR==S.vbr_off&&(L.slot_lag=L.frac_SpF=72e3*(e.version+1)*e.brate%e.out_samplerate|0),r.iteration_init(e),m.psymodel_init(e),0},this.lame_encode_flush=function(e,t,r,o){var l,c,_,d,m=e.internal_flags,v=h([2,1152]),y=0,w=m.mf_samples_to_encode-U.POSTDELAY,k=L(e);if(m.mf_samples_to_encode<1)return 0;for(l=0,e.in_samplerate!=e.out_samplerate&&(w+=16*e.out_samplerate/e.in_samplerate),(_=e.framesize-w%e.framesize)<576&&(_+=e.framesize),e.encoder_padding=_,d=(w+_)/e.framesize;d>0&&y>=0;){var S=k-m.mf_size,M=e.frameNum;S*=e.in_samplerate,(S/=e.out_samplerate)>1152&&(S=1152),S<1&&(S=1),c=o-l,0==o&&(c=0),r+=y=this.lame_encode_buffer(e,v[0],v[1],S,t,r,c),l+=y,d-=M!=e.frameNum?1:0}if(m.mf_samples_to_encode=0,y<0)return y;if(c=o-l,0==o&&(c=0),n.flush_bitstream(e),(y=n.copy_buffer(m,t,r,c,1))<0)return y;if(r+=y,c=o-(l+=y),0==o&&(c=0),e.write_id3tag_automatic){if(f.id3tag_write_v1(e),(y=n.copy_buffer(m,t,r,c,0))<0)return y;l+=y}return l},this.lame_encode_buffer=function(e,r,o,c,f,_,h){var d=e.internal_flags,m=[null,null];if(d.Class_ID!=x)return-3;if(0==c)return 0;!function(e,t){(null==e.in_buffer_0||e.in_buffer_nsamples<t)&&(e.in_buffer_0=l(t),e.in_buffer_1=l(t),e.in_buffer_nsamples=t)}(d,c),m[0]=d.in_buffer_0,m[1]=d.in_buffer_1;for(var i=0;i<c;i++)m[0][i]=r[i],d.channels_in>1&&(m[1][i]=o[i]);return function(e,r,o,l,c,f,_){var h,i,d,m,v,y=e.internal_flags,w=0,k=[null,null],S=[null,null];if(y.Class_ID!=x)return-3;if(0==l)return 0;if((v=n.copy_buffer(y,c,f,_,0))<0)return v;if(f+=v,w+=v,S[0]=r,S[1]=o,B.NEQ(e.scale,0)&&B.NEQ(e.scale,1))for(i=0;i<l;++i)S[0][i]*=e.scale,2==y.channels_out&&(S[1][i]*=e.scale);if(B.NEQ(e.scale_left,0)&&B.NEQ(e.scale_left,1))for(i=0;i<l;++i)S[0][i]*=e.scale_left;if(B.NEQ(e.scale_right,0)&&B.NEQ(e.scale_right,1))for(i=0;i<l;++i)S[1][i]*=e.scale_right;if(2==e.num_channels&&1==y.channels_out)for(i=0;i<l;++i)S[0][i]=.5*(S[0][i]+S[1][i]),S[1][i]=0;m=L(e),k[0]=y.mfbuf[0],k[1]=y.mfbuf[1];var M=0;for(;l>0;){var R,E,A=[null,null];A[0]=S[0],A[1]=S[1];var T=new Y;if(z(e,k,A,M,l,T),R=T.n_in,E=T.n_out,y.findReplayGain&&!y.decode_on_the_fly&&t.AnalyzeSamples(y.rgdata,k[0],y.mf_size,k[1],y.mf_size,E,y.channels_out)==P.GAIN_ANALYSIS_ERROR)return-6;if(l-=R,M+=R,y.channels_out,y.mf_size+=E,y.mf_samples_to_encode<1&&(y.mf_samples_to_encode=U.ENCDELAY+U.POSTDELAY),y.mf_samples_to_encode+=E,y.mf_size>=m){var O=_-w;if(0==_&&(O=0),(h=I(e,k[0],k[1],c,f,O))<0)return h;for(f+=h,w+=h,y.mf_size-=e.framesize,y.mf_samples_to_encode-=e.framesize,d=0;d<y.channels_out;d++)for(i=0;i<y.mf_size;i++)k[d][i]=k[d][i+e.framesize]}}return w}(e,m[0],m[1],c,f,_,h)}}function se(){this.setModules=function(e,t){e,t}}function ie(){this.setModules=function(e,t,n){e,t,n}}function oe(){}function le(){this.setModules=function(e,t){e,t}}z.SFBMAX=3*U.SBMAX_s,U.ENCDELAY=576,U.POSTDELAY=1152,U.MDCTDELAY=48,U.FFTOFFSET=224+U.MDCTDELAY,U.DECDELAY=528,U.SBLIMIT=32,U.CBANDS=64,U.SBPSY_l=21,U.SBPSY_s=12,U.SBMAX_l=22,U.SBMAX_s=13,U.PSFB21=6,U.PSFB12=6,U.BLKSIZE=1024,U.HBLKSIZE=U.BLKSIZE/2+1,U.BLKSIZE_s=256,U.HBLKSIZE_s=U.BLKSIZE_s/2+1,U.NORM_TYPE=0,U.START_TYPE=1,U.SHORT_TYPE=2,U.STOP_TYPE=3,U.MPG_MD_LR_LR=0,U.MPG_MD_LR_I=1,U.MPG_MD_MS_LR=2,U.MPG_MD_MS_I=3,U.fircoef=[-.1039435,-.1892065,5*-.0432472,-.155915,3898045e-23,.0467745*5,.50455,.756825,.187098*5],te.MFSIZE=3456+U.ENCDELAY-U.MDCTDELAY,te.MAX_HEADER_BUF=256,te.MAX_BITS_PER_CHANNEL=4095,te.MAX_BITS_PER_GRANULE=7680,te.BPC=320,z.SFBMAX=3*U.SBMAX_s,e.Mp3Encoder=function(e,t,r){3!=arguments.length&&(console.error("WARN: Mp3Encoder(channels, samplerate, kbps) not specified"),e=1,t=44100,r=128);var o=new re,l=new se,c=new P,f=new B,p=new E,_=new X,h=new G,d=new T,m=new R,v=new le,y=new A,w=new x,k=new ie,S=new oe;o.setModules(c,f,p,_,h,d,m,v,S),f.setModules(c,S,m,d),v.setModules(f,m),p.setModules(o),h.setModules(f,y,_,w),_.setModules(w,y,o.enc.psy),y.setModules(f),w.setModules(_),d.setModules(o,f,m),l.setModules(k,S),k.setModules(m,v,p);var O=o.lame_init();O.num_channels=e,O.in_samplerate=t,O.out_samplerate=t,O.brate=r,O.mode=M.STEREO,O.quality=3,O.bWriteVbrTag=!1,O.disable_reservoir=!0,O.write_id3tag_automatic=!1,o.lame_init_params(O);var C=1152,j=0|1.25*C+7200,L=n(j);this.encodeBuffer=function(t,r){1==e&&(r=t),t.length>C&&(C=t.length,L=n(j=0|1.25*C+7200));var l=o.lame_encode_buffer(O,t,r,t.length,L,0,j);return new Int8Array(L.subarray(0,l))},this.flush=function(){var e=o.lame_encode_flush(O,L,0,j);return new Int8Array(L.subarray(0,e))}}}e(),Recorder.lamejs=e}()},657:function(e,t){var n,r;n=function(e){return new r(e)},(r=function(e){var t={scale:2,speed:8,lineWidth:3,linear1:[0,"rgba(150,96,238,1)",.2,"rgba(170,79,249,1)",1,"rgba(53,199,253,1)"],linear2:[0,"rgba(209,130,255,0.6)",1,"rgba(53,199,255,0.6)"],linearBg:[0,"rgba(255,255,255,0.2)",1,"rgba(54,197,252,0.2)"]};for(var n in e)t[n]=e[n];this.set=e=t;var r=e.elem;r&&("string"==typeof r?r=document.querySelector(r):r.length&&(r=r[0])),r&&(e.width=r.offsetWidth,e.height=r.offsetHeight);var o=e.scale,l=e.width*o,c=e.height*o,f=this.elem=document.createElement("div"),_=["","transform-origin:0 0;","transform:scale("+1/o+");"];f.innerHTML='<div style="width:'+e.width+"px;height:"+e.height+'px;overflow:hidden"><div style="width:'+l+"px;height:"+c+"px;"+_.join("-webkit-")+_.join("-ms-")+_.join("-moz-")+_.join("")+'"><canvas/></div></div>';var canvas=this.canvas=f.querySelector("canvas"),h=this.ctx=canvas.getContext("2d");canvas.width=l,canvas.height=c,this.linear1=this.genLinear(h,l,e.linear1),this.linear2=this.genLinear(h,l,e.linear2),this.linearBg=this.genLinear(h,c,e.linearBg,!0),r&&(r.innerHTML="",r.appendChild(f)),this._phase=0}).prototype=n.prototype={genLinear:function(e,t,n,r){for(var o=e.createLinearGradient(0,0,r?0:t,r?t:0),i=0;i<n.length;)o.addColorStop(n[i++],n[i++]);return o},genPath:function(e,t,n){for(var r=[],o=this.set,l=o.scale,c=o.width*l,f=o.height*l/2,_=0;_<c;_+=l){var h=(1+Math.cos(Math.PI+_/c*2*Math.PI))/2*f*t*Math.sin(2*Math.PI*(_/c)*e+n)+f;r.push(h)}return r},input:function(e,t,n){var r=this.set,o=this.ctx,l=r.scale,c=r.width*l,f=r.height*l,_=r.speed*e.length/n,h=this._phase-=_,d=t/100,m=this.genPath(2,d,h),v=this.genPath(1.8,d,h+5*_);o.clearRect(0,0,c,f),o.beginPath();for(var i=0,y=0;y<c;i++,y+=l)0==y?o.moveTo(y,m[i]):o.lineTo(y,m[i]);for(i--,y=c-1;y>=0;i--,y-=l)o.lineTo(y,v[i]);o.closePath(),o.fillStyle=this.linearBg,o.fill(),this.drawPath(v,this.linear2),this.drawPath(m,this.linear1)},drawPath:function(path,e){var t=this.set,n=this.ctx,r=t.scale,o=t.width*r;n.beginPath();for(var i=0,l=0;l<o;i++,l+=r)0==l?n.moveTo(l,path[i]):n.lineTo(l,path[i]);n.lineWidth=t.lineWidth*r,n.strokeStyle=e,n.stroke()}},Recorder.WaveView=n}}]);