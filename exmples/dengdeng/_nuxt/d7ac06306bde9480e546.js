(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{348:function(e,t,r){var content=r(411);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(17).default)("e4a4ec72",content,!0,{sourceMap:!1})},362:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));r(10),r(32);var n=r(409),o=r.n(n),c=null;function d(e){var t,r,data,n;return regeneratorRuntime.async((function(d){for(;;)switch(d.prev=d.next){case 0:return t=e.$axios,d.next=3,regeneratorRuntime.awrap(t.post("public/oss/token",{}));case 3:r=d.sent,data=r.data.data,n=Object.assign({endpoint:data.endpoint,accessKeyId:data.accessKeyId,accessKeySecret:data.accessKeySecret,stsToken:data.securityToken,bucket:data.bucketName,cname:!0}),c=new o.a(n);case 7:case"end":return d.stop()}}))}function l(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){var n=new FileReader;n.readAsArrayBuffer(e),n.onload=function(e){t(e.target.result)},n.onerror=function(e){r(e)}})));case 1:case"end":return t.stop()}}))}function f(e){return new o.a.Buffer(e)}function v(e,t,r){var n,o,v;return regeneratorRuntime.async((function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,regeneratorRuntime.awrap(l(r));case 2:if(n=h.sent,o=f(n),c){h.next=7;break}return h.next=7,regeneratorRuntime.awrap(d(e));case 7:return h.next=9,regeneratorRuntime.awrap(c.put(t,o));case 9:return v=h.sent,h.abrupt("return",v);case 11:case"end":return h.stop()}}))}},410:function(e,t,r){"use strict";var n=r(348);r.n(n).a},411:function(e,t,r){(e.exports=r(16)(!1)).push([e.i,".ruleForm[data-v-d15c67ec]{max-width:500px;padding:20px 0}.avatar-uploader[data-v-d15c67ec] .el-upload{border:1px dashed #d9d9d9;border-radius:50%;cursor:pointer;position:relative;overflow:hidden}.avatar-uploader[data-v-d15c67ec] .el-upload:hover{border-color:#409eff}.avatar-uploader[data-v-d15c67ec] .avatar-uploader-icon{font-size:28px;color:#8c939d;width:128px;height:128px;line-height:128px;text-align:center}.avatar-uploader[data-v-d15c67ec] .avatar{width:128px;height:128px;display:block}",""])},478:function(e,t,r){"use strict";r.r(t);r(127),r(32);var n=r(362),o={data:function(){var e=this.$axios.defaults;return{formData:{avatar:""},uploadUrl:"".concat(e.baseURL,"/customers/images"),uploadHeaders:{Authorization:this.$store.state.authorization,AuthorizationType:e.headers.AuthorizationType},uploadData:{questionId:1}}},created:function(){this.formData=Object.assign({},this.$store.state.userinfo)},methods:{handleAvatarError:function(e){this.$message.error(e.message||e)},beforeAvatarUpload:function(e){var t=/^image/.test(e.type);if(!t)return this.$message.error("请上传图片!");var r=e.size/1024/1024<2;return r?(this.upload(e),!1):this.$message.error("上传头像图片大小不能超过 2MB!")},upload:function(e){var t,r;return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:return t="avatar/".concat(this.$store.state.userinfo.id,".").concat(e.type.split("/")[1]),o.next=3,regeneratorRuntime.awrap(Object(n.a)(this,t,e));case 3:r=o.sent,this.formData.avatar="".concat(r.url,"?").concat((new Date).getTime()),this.$store.commit("set",{userinfo:this.formData}),this.saveAvatar(r.url);case 7:case"end":return o.stop()}}),null,this)},saveAvatar:function(e){var t;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,regeneratorRuntime.awrap(this.$axios.post("customers/userinfo/change",{avatar:e}));case 2:t=r.sent,t.data;case 4:case"end":return r.stop()}}),null,this)}}},c=(r(410),r(18)),component=Object(c.a)(o,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-form",{staticClass:"ruleForm",attrs:{"label-width":"120px","label-position":"right"}},[r("el-form-item",{attrs:{label:"",prop:"avatar"}},[r("el-upload",{staticClass:"avatar-uploader",attrs:{"show-file-list":!1,headers:e.uploadHeaders,action:e.uploadUrl,data:e.uploadData,"on-error":e.handleAvatarError,"before-upload":e.beforeAvatarUpload}},[e.formData.avatar?r("img",{staticClass:"avatar",attrs:{src:e.formData.avatar}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),e._v(" "),r("p",{staticStyle:{"padding-left":"20px"}},[e._v("点击上传头像")])],1)],1)}),[],!1,null,"d15c67ec",null);t.default=component.exports}}]);