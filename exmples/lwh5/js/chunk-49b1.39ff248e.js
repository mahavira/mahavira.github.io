(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-49b1"],{"5e66":function(e,t,a){},d3f2:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"resume"},[a("van-cell-group",[a("van-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{clearable:"",label:"公司名称",placeholder:"请输入公司名称","input-align":"right",name:"公司名称","error-message":e.errors.first("公司名称")},model:{value:e.formData.companyName,callback:function(t){e.$set(e.formData,"companyName",t)},expression:"formData.companyName"}}),a("van-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{clearable:"",label:"工作职位",placeholder:"请输入工作职位","input-align":"right",name:"工作职位","error-message":e.errors.first("工作职位")},model:{value:e.formData.post,callback:function(t){e.$set(e.formData,"post",t)},expression:"formData.post"}}),a("van-cell",{attrs:{title:"入职时间","is-link":"",value:e._f("moment")(e.formData.startTime,"YYYY/MM/DD")},on:{click:function(t){e.onShowActionsheet("startTime")}}}),a("van-cell",{attrs:{title:"离职时间","is-link":"",value:e.endTime},on:{click:function(t){e.onShowActionsheet("endTime")}}}),a("van-cell",{attrs:{title:"计薪方式","is-link":"",value:e.showValue("LW_SALARY_TYPE",e.formData.salaryType)},on:{click:function(t){e.onShowActionsheet("salaryType")}}}),a("van-field",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{clearable:"",label:"月综合薪资",type:"number",placeholder:"请输入月综合薪资","input-align":"right",name:"月综合薪资","error-message":e.errors.first("月综合薪资")},model:{value:e.formData.salary,callback:function(t){e.$set(e.formData,"salary",t)},expression:"formData.salary"}})],1),a("van-popup",{attrs:{position:"bottom"},model:{value:e.visible.startTime,callback:function(t){e.$set(e.visible,"startTime",t)},expression:"visible.startTime"}},[a("van-datetime-picker",{attrs:{type:"date",title:"入职时间","min-date":e.minDate,"max-date":e.currentDate},on:{confirm:function(t){e.onConfirmDatetime(t,"startTime")},cancel:function(t){e.onConfirmDatetime(t,"startTime")}},model:{value:e.formData.startTime,callback:function(t){e.$set(e.formData,"startTime",t)},expression:"formData.startTime"}})],1),a("van-popup",{attrs:{position:"bottom"},model:{value:e.visible.endTime,callback:function(t){e.$set(e.visible,"endTime",t)},expression:"visible.endTime"}},[a("date-picker",{attrs:{type:"date",title:"离职时间","min-date":e.minDate,"max-date":e.maxDate},on:{confirm:function(t){e.onConfirmDatetime(t,"endTime")},change:function(t){e.onChangeDatetime(t,"endTime")},cancel:function(t){e.onConfirmDatetime(t,"endTime")}},model:{value:e.formData.endTime,callback:function(t){e.$set(e.formData,"endTime",t)},expression:"formData.endTime"}})],1),a("van-actionsheet",{attrs:{actions:e.options.LW_SALARY_TYPE},on:{select:function(t){e.onSelect(t,"salaryType")}},model:{value:e.visible.salaryType,callback:function(t){e.$set(e.visible,"salaryType",t)},expression:"visible.salaryType"}}),e.workId?a("div",{staticClass:"footer"},[a("van-button",{staticClass:"btn-red",attrs:{block:""},on:{click:e.onDelete}},[e._v("删除")])],1):e._e(),e.$store.state.production?e._e():a("van-button",{staticClass:"btn",attrs:{block:""},on:{click:e.onSave}},[e._v("保存")])],1)},i=[],r=(a("f751"),a("cadf"),a("551c"),a("097d"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("picker",{ref:"picker",attrs:{title:e.title,columns:e.columns,"item-height":e.itemHeight,"show-toolbar":e.showToolbar,"visible-item-count":e.visibleItemCount,"confirm-button-text":e.confirmButtonText,"cancel-button-text":e.cancelButtonText},on:{change:e.onChange,confirm:e.onConfirm,cancel:function(t){e.$emit("cancel")}}})}),o=[],s=a("88d8");a("28a5");function u(e){if(Array.isArray(e))return e}function c(e,t){var a=[],n=!0,i=!1,r=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done);n=!0)if(a.push(o.value),t&&a.length===t)break}catch(e){i=!0,r=e}finally{try{n||null==s["return"]||s["return"]()}finally{if(i)throw r}}return a}function l(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function m(e,t){return u(e)||c(e,t)||l()}a("c5f6"),a("6b54");var h=a("f253"),f=a("fe7e"),d=a("a142"),p=(new Date).getTime(),v=(new Date).getFullYear(),g=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())},D=Object(f["a"])({name:"datetime-picker",components:{Picker:h["a"]},props:{value:{},title:String,itemHeight:Number,visibleItemCount:Number,confirmButtonText:String,cancelButtonText:String,type:{type:String,default:"datetime"},showToolbar:{type:Boolean,default:!0},format:{type:String,default:"YYYY.MM.DD HH时 mm分"},formatter:{type:Function,default:function(e,t){return t}},minDate:{type:Date,default:function(){return new Date(v-10,0,1)},validator:g},maxDate:{type:Date,default:function(){return new Date(v+10,11,31)},validator:g},minHour:{type:Number,default:0},maxHour:{type:Number,default:23},minMinute:{type:Number,default:0},maxMinute:{type:Number,default:59}},data:function(){return{innerValue:this.correctValue(this.value)}},watch:{value:function(e){e=this.correctValue(e);var t="time"===this.type?e===this.innerValue:e.valueOf()===this.innerValue.valueOf();t||(this.innerValue=e)},innerValue:function(e){this.updateColumnValue(e),this.$emit("input",e)}},computed:{ranges:function(){if("time"===this.type)return[{type:"hour",range:[this.minHour,this.maxHour]},{type:"minute",range:[this.minMinute,this.maxMinute]}];var e=this.getBoundary("max",this.innerValue),t=e.maxYear,a=e.maxDate,n=e.maxMonth,i=e.maxHour,r=e.maxMinute,o=this.getBoundary("min",this.innerValue),s=o.minYear,u=o.minDate,c=o.minMonth,l=o.minHour,m=o.minMinute,h=[{type:"year",range:[s,t]},{type:"month",range:[c,n]},{type:"day",range:[u,a]},{type:"hour",range:[l,i]},{type:"minute",range:[m,r]}];return"date"===this.type&&h.splice(3,2),"year-month"===this.type&&h.splice(2,3),h},columns:function(){var e=this,t=this.ranges.map(function(t){var a=t.type,n=t.range,i=e.times(n[1]-n[0]+1,function(t){var i=n[0]+t;return i=i<10?"0".concat(i):"".concat(i),e.formatter(a,i)});return{className:a,values:i}});return new Date(this.value).getTime()>=p&&(t[1].values=[],t[2].values=[]),this.$nextTick(function(){var t=e.$refs.picker.$el.querySelectorAll(".year .van-picker-column__item");t[t.length-1].innerText="至今在职"}),t}},methods:{pad:function(e){return"00".concat(e).slice(-2)},correctValue:function(e){var t="time"!==this.type;if(t&&!g(e))e=this.minDate;else if(!e){var a=this.minHour;e="".concat(a>10?a:"0"+a,":00")}if(!t){var n=e.split(":"),i=m(n,2),r=i[0],o=i[1];return r=this.pad(Object(d["g"])(r,this.minHour,this.maxHour)),o=this.pad(Object(d["g"])(o,this.minMinute,this.maxMinute)),"".concat(r,":").concat(o)}var s=this.getBoundary("max",e),u=s.maxYear,c=s.maxDate,l=s.maxMonth,h=s.maxHour,f=s.maxMinute,p=this.getBoundary("min",e),v=p.minYear,D=p.minDate,y=p.minMonth,b=p.minHour,T=p.minMinute,k=new Date(v,y-1,D,b,T),x=new Date(u,l-1,c,h,f);return e=Math.max(e,k),e=Math.min(e,x),new Date(e)},times:function(e,t){var a=-1,n=Array(e);while(++a<e)n[a]=t(a);return n},getBoundary:function(e,t){var a,n=this["".concat(e,"Date")],i=n.getFullYear(),r=1,o=1,u=0,c=0;return"max"===e&&(r=12,o=this.getMonthEndDay(t.getFullYear(),t.getMonth()+1),u=23,c=59),t.getFullYear()===i&&(r=n.getMonth()+1,t.getMonth()+1===r&&(o=n.getDate(),t.getDate()===o&&(u=n.getHours(),t.getHours()===u&&(c=n.getMinutes())))),a={},Object(s["a"])(a,"".concat(e,"Year"),i),Object(s["a"])(a,"".concat(e,"Month"),r),Object(s["a"])(a,"".concat(e,"Date"),o),Object(s["a"])(a,"".concat(e,"Hour"),u),Object(s["a"])(a,"".concat(e,"Minute"),c),a},getTrueValue:function(e){if(e){while(isNaN(parseInt(e,10)))e=e.slice(1);return parseInt(e,10)}},getMonthEndDay:function(e,t){return this.isShortMonth(t)?30:2===t?this.isLeapYear(e)?29:28:31},isLeapYear:function(e){return e%4===0&&e%100!==0||e%400===0},isShortMonth:function(e){return[4,6,9,11].indexOf(e)>-1},onConfirm:function(){this.$emit("confirm",this.innerValue)},onChange:function(e){var t,a=this,n=e.getValues();if("time"===this.type)t=n.join(":");else{n[1]||(n[1]="01"),n[2]||(n[2]="01");var i=this.getTrueValue(n[0]),r=this.getTrueValue(n[1]),o=this.getMonthEndDay(i,r),s=this.getTrueValue(n[2]);"year-month"===this.type&&(s=1),s=s>o?o:s;var u=0,c=0;"datetime"===this.type&&(u=this.getTrueValue(n[3]),c=this.getTrueValue(n[4])),t=new Date(i,r-1,s,u,c)}t=this.correctValue(t),this.innerValue=t,this.$nextTick(function(){a.$nextTick(function(){a.$emit("change",e)})})},updateColumnValue:function(e){var t=this,a=[],n=this.formatter,i=this.pad;if("time"===this.type){var r=e.split(":");a=[n("hour",r[0]),n("minute",r[1])]}else a=[n("year","".concat(e.getFullYear())),n("month",i(e.getMonth()+1)),n("day",i(e.getDate()))],"datetime"===this.type&&a.push(n("hour",i(e.getHours())),n("minute",i(e.getMinutes()))),"year-month"===this.type&&(a=a.slice(0,2));this.$nextTick(function(){t.$refs.picker.setValues(a)})}},mounted:function(){this.updateColumnValue(this.innerValue)}}),y=D,b=a("2877"),T=Object(b["a"])(y,r,o,!1,null,null,null);T.options.__file="DatePicker.vue";var k=T.exports,x=a("5dea"),w={name:"ResumeWorkEdit",components:{DatePicker:k},data:function(){var e=new Date,t=this.$moment().add(-40,"year").toDate(),a=this.$moment().add(1,"year").toDate();return{loading:!1,workId:0,currentDate:e,minDate:t,maxDate:a,formData:{companyName:"",jobRemark:"",post:"",startTime:this.$moment().subtract(1,"year").toDate(),endTime:a,salary:0,salaryType:"1"},visible:{endTime:!1,startTime:!1,salaryType:!1}}},computed:{options:function(){return this.$store.state.dict.options},values:function(){return this.$store.state.dict.kvs},endTime:function(){return this.formData.endTime.getTime()>=Date.now()?"至今":this.$moment(this.formData.endTime).format("YYYY/MM/DD")}},created:function(){console.log(this.$moment().add(-1,"year")),this.workId=this.$route.params.workId,"0"!==this.workId?this.onFetch():this.workId=0,this.listenSave()},methods:{onFetch:function(){var e=this;this.loading=!0,this.$api.getResumeWork({id:this.workId}).then(function(t){var a=t.data;e.formData=Object.assign(a.obj,{endTime:a.obj.endTime?new Date(a.obj.endTime):e.maxDate,startTime:new Date(a.obj.startTime)}),e.loading=!1}).catch(function(){e.loading=!1})},onSave:function(){var e=this;this.$validator.validate().then(function(t){t&&(e.loading||(e.loading=!0,e.save().then(function(){e.loading=!1,e.$toast.success("成功!"),setTimeout(function(){return e.$bridge.callhandler("backPage",{isRefresh:!0},function(){})},1e3)}).catch(function(){e.$toast.fail("数据保存错误!")})))})},listenSave:function(){this.$bridge.registerhandler("listenAction",this.onSave)},save:function(){var e=this,t=this.workId?"updateResumeWork":"createResumeWork";return new Promise(function(a,n){e.$api[t](Object.assign({},e.formData,{endTime:e.formData.endTime.getTime()>=Date.now()?null:e.$moment(e.formData.endTime).format("YYYY-MM-DD"),startTime:e.$moment(e.formData.startTime).format("YYYY-MM-DD")})).then(function(){a()}).catch(function(){n()})})},onShowActionsheet:function(e){this.visible[e]=!0},onSelect:function(e,t){this.formData[t]=e.code,this.visible[t]=!1},onConfirmDatetime:function(e,t){this.visible[t]=!1},onChangeDatetime:function(e,t){Object(x["a"])(e)&&(this.formData.endTime=e),console.log(e,t)},onDelete:function(){var e=this;this.$api.deleteResumeWork({id:this.workId}).then(function(){e.$toast.success("删除成功!"),setTimeout(function(){return e.$bridge.callhandler("backPage",{isRefresh:!0},function(){})},1e3)}).catch(function(){e.$toast.fail("删除失败!")})}}},$=w,M=(a("e542"),Object(b["a"])($,n,i,!1,null,"7954fd1b",null));M.options.__file="ResumeWorkEdit.vue";t["default"]=M.exports},e542:function(e,t,a){"use strict";var n=a("5e66"),i=a.n(n);i.a}}]);