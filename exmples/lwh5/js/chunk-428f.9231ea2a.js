(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-428f"],{"55c3":function(t,e,n){"use strict";var i=n("f210"),a=(n("f751"),n("ac6a"),function(t){return t&&parseFloat(t)?parseFloat(t):0});e["a"]={data:function(){return{items:[],finished:!1,loading:!1,pageNo:1,pageSize:10}},methods:{parseFloatEach:function(t,e){var n=t.objs;return n&&n.length?e?n.map(function(t){return e.forEach(function(e){t[e]=a(t[e])}),t}):n:[]},fetchHistory:function(t,e,n){var a=this;return this.$api[t](Object.assign({pageNo:this.pageNo,pageSize:this.pageSize},e)).then(function(t){var e=t.data,s=a.parseFloatEach(e,n);a.items=Object(i["a"])(a.items).concat(Object(i["a"])(s)),!e.totalSize||e.totalSize===a.items.length||s.length<a.pageSize?a.finished=!0:a.pageNo=a.pageNo+1,a.loading=!1}).catch(function(){a.loading=!1,a.finished=!0})}}}},"646e":function(t,e,n){"use strict";var i=n("72a8"),a=n.n(i);a.a},"72a8":function(t,e,n){},"7f2e":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",[n("transition",{attrs:{name:"van-fade"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"van-modal",on:{click:t.onCancel,touchmove:function(t){t.stopPropagation(),t.preventDefault()}}})]),n("div",{staticClass:"van-dialog",class:{closed:!t.visible},style:{top:t.top}},[t.showTitle?n("div",{class:["van-dialog__header","van-dialog__header--"+t.inputAlign]},[t._v(t._s(t.title))]):t._e(),n("div",{staticClass:"van-dialog__content"},[n("van-field",{ref:"input",attrs:{placeholder:t.placeholder,"input-align":t.inputAlign},on:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.onConfirm(e):null}},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1),n("div",{staticClass:"van-hairline--top van-dialog__footer van-dialog__footer--buttons"},[n("button",{staticClass:"van-button van-button--default van-button--large van-dialog__cancel",on:{click:t.onCancel}},[n("span",{staticClass:"van-button__text"},[t._v(t._s(t.cancelButtonText))])]),n("button",{staticClass:"van-button van-button--default van-button--large van-dialog__confirm",attrs:{type:"submit"},on:{click:t.onConfirm}},[n("span",{staticClass:"van-button__text"},[t._v(t._s(t.confirmButtonText))])])])])],1)},a=[],s=(n("cadf"),n("551c"),n("097d"),"-100px"),o={props:{visible:{type:Boolean,default:!1},text:{type:String,default:""},placeholder:{type:String,default:"请输入评论内容"},confirmButtonText:{type:String,default:"确认"},cancelButtonText:{type:String,default:"取消"},showTitle:{type:Boolean,default:!1},title:{type:String,default:"提示"},inputAlign:{type:String,default:"center"}},data:function(){return{content:this.text,top:s}},watch:{text:function(){this.content!==this.text&&(this.content=this.text)}},methods:{focus:function(){var t=this;window.document.querySelector("body").style.overflow="hidden",this.$refs.input.$el.querySelector("input").focus(),this.$nextTick(function(){t.top="35%"})},onConfirm:function(){this.content&&(this.$emit("onConfirm",this.content),this.onCancel())},onCancel:function(){this.$emit("update:visible",!1),window.document.querySelector("body").style.overflow="auto",this.top=s,this.$refs.input.$el.querySelector("input").blur()}}},c=o,l=(n("646e"),n("2877")),r=Object(l["a"])(c,i,a,!1,null,"21688f88",null);r.options.__file="PopupInput.vue";e["a"]=r.exports},"8f43":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"agentApply"},[n("van-search",{attrs:{placeholder:"请输入搜索关键词"},on:{search:t.onSearch},model:{value:t.searchVal,callback:function(e){t.searchVal=e},expression:"searchVal"}}),t.items.length||t.loading?t._e():n("div",{staticClass:"noData"},[t._v("\n    暂无数据\n  ")]),n("van-list",{staticClass:"list",attrs:{finished:t.finished,offset:100},on:{load:t.fetchUsers},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.items,function(e,i){return n("van-cell",{key:i,staticClass:"item",attrs:{type:"flex",justify:"space-between"}},[n("van-row",{staticClass:"item",attrs:{type:"flex",justify:"space-between"},nativeOn:{click:function(n){t.handleChecked(i,e)}}},[n("div",{staticClass:"item-col handle"},[n("div",{staticClass:"checkbox",class:{checked:t.checkeds.indexOf(i)>=0}})]),n("div",{staticClass:"item-col headimg"},[n("img",{attrs:{src:e.headUrl,alt:""}})]),n("div",{staticClass:"item-col content"},[n("div",[n("span",{staticClass:"username"},[t._v(t._s(e.bookingName))]),n("span",{staticClass:"phone"},[t._v(t._s(e.bookingPhone))])]),n("div",[e.bookingIdNum?n("span",{staticClass:"number"},[t._v(t._s(t._f("substr")(e.bookingIdNum)))]):n("span",{staticClass:"number"},[t._v("请维护身份证号码")])])])])],1)})),n("van-tabbar",[n("div",{staticClass:"tabbar-item allcheckbox space-between"},[n("span",{staticClass:"checkbox",class:{checked:t.checkeds.length==t.items.length&&t.items.length>0},staticStyle:{width:"20px"},on:{click:t.onCheckAll}}),n("span",{staticStyle:{width:"60px"}},[t._v("全选")]),n("span",{staticClass:"hint"},[t._v("已选择 "+t._s(t.checkeds.length)+" 人")])]),n("div",{staticClass:"tabbar-item btn btn1",on:{click:t.handleApply}},[n("span",[t._v("立即报名")])]),n("div",{staticClass:"tabbar-item btn btn2",on:{click:function(e){t.$router.push("/job/"+t.jonId+"/agent/make")}}},[n("span",[t._v("新登记")])])]),n("popup-input",{ref:"popupInput",attrs:{visible:t.visibleIdcardModal,text:t.idcard,placeholder:"请输入身份证号码"},on:{"update:visible":function(e){t.visibleIdcardModal=e},onConfirm:t.onUpdateIdcard}}),n("van-actionsheet",{attrs:{actions:t.actionsheets,"cancel-text":"取消"},on:{select:t.onSelectActionsheets},model:{value:t.showActionsheet,callback:function(e){t.showActionsheet=e},expression:"showActionsheet"}})],1)},a=[],s=(n("ac6a"),n("cadf"),n("551c"),n("097d"),n("7f2e")),o=n("55c3"),c=10,l={name:"AgentApply",mixins:[o["a"]],components:{PopupInput:s["a"]},data:function(){return{jonId:0,checkeds:[],searchVal:"",pageSize:20,visibleIdcardModal:!1,idcard:"",showActionsheet:!1,actionsheets:[{name:"扫描乐友二维码",code:"qrcode"},{name:"扫描身份证",code:"idcard"}]}},created:function(){this.jonId=this.$route.params.jobId,this.jonId||this.$toast.fail("没有获取到工作编号!"),this.listenAction()},methods:{fetchUsers:function(){this.fetchHistory("getAgentUsers",{recruitId:this.jonId,queryString:this.searchVal})},handleApply:function(){this.checkeds.length?this.$dialog.confirm({title:"确认报名？",beforeClose:this.applyConfirm}):this.$toast("未选择用户!")},applyConfirm:function(t,e){var n=this;if("cancel"!==t){var i=[];this.checkeds.forEach(function(t){i.push(n.items[t].userId)}),this.$api.friendsAgentBooking({friendsIdLis:i,recruitId:this.jonId}).then(function(){n.$toast.success("报名成功!"),n.checkeds=[],n.items=[],n.pageNo=1,n.finished=!1,n.loading=!1,e()}).catch(function(){n.$toast.fail("报名错误!"),e()})}else e()},handleChecked:function(t,e){if(e.bookingIdNum){var n=this.checkeds.indexOf(t);n<0?this.checkeds.length>c?this.$toast("最多可选择".concat(c,"人!")):this.checkeds.push(t):this.checkeds.splice(n,1)}},onSearch:function(){this.checkeds=[],this.items=[],this.pageNo=1,this.finished=!1,this.loading=!1},onCheckAll:function(){var t=[];this.items.length>this.checkeds.length&&this.items.forEach(function(e,n){t.indexOf(n)<0&&t.length<=c&&e.bookingIdNum&&t.push(n)}),this.checkeds=t},onEditIdcard:function(){this.visibleIdcardModal=!0,this.$refs.popupInput.focus()},onUpdateIdcard:function(t){console.log(t)},listenAction:function(){var t=this;this.$bridge.callhandler("setNavigationAction",{code:900,text:"扫一扫"},function(){}),this.$bridge.registerhandler("listenAction",function(){t.showActionsheet=!0})},onSelectActionsheets:function(t){var e=this;this.showActionsheet=!1,this.$bridge.callhandler("openScan",{type:t.code},function(t){try{var n=JSON.parse(t);e.$router.push({path:"/job/".concat(e.jonId,"/agent/make"),query:n.data})}catch(t){e.$toast.fail(t)}})}}},r=l,h=(n("9145"),n("2877")),d=Object(h["a"])(r,i,a,!1,null,"66f754d6",null);d.options.__file="AgentApply.vue";e["default"]=d.exports},9145:function(t,e,n){"use strict";var i=n("f869"),a=n.n(i);a.a},f210:function(t,e,n){"use strict";function i(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}function a(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function s(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function o(t){return i(t)||a(t)||s()}n.d(e,"a",function(){return o})},f869:function(t,e,n){}}]);